{"id":"https://schema.management.azure.com/schemas/2018-05-01/Microsoft.BatchAI.json#","$schema":"http://json-schema.org/draft-04/schema#","title":"Microsoft.BatchAI","description":"Microsoft BatchAI Resource Types","resourceDefinitions":{"workspaces":{"type":"object","properties":{"name":{"oneOf":[{"type":"string","pattern":"^[-\\w_]+$"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The name of the workspace. Workspace names can only contain a combination of alphanumeric characters along with dash (-) and underscore (_). The name must be from 1 through 64 characters long."},"type":{"type":"string","enum":["Microsoft.BatchAI/workspaces"]},"apiVersion":{"type":"string","enum":["2018-05-01"]},"location":{"type":"string","description":"The region in which to create the Workspace."},"tags":{"oneOf":[{"type":"object","additionalProperties":{"type":"string"}},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The user specified tags associated with the Workspace."},"resources":{"type":"array","items":{"oneOf":[{"$ref":"#/definitions/workspaces_clusters_childResource"},{"$ref":"#/definitions/workspaces_fileServers_childResource"},{"$ref":"#/definitions/workspaces_experiments_childResource"}]}}},"required":["name","type","apiVersion","location"],"description":"Microsoft.BatchAI/workspaces"},"workspaces_clusters":{"type":"object","properties":{"name":{"oneOf":[{"type":"string","pattern":"^[-\\w_]+$"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The name of the cluster within the specified resource group. Cluster names can only contain a combination of alphanumeric characters along with dash (-) and underscore (_). The name must be from 1 through 64 characters long."},"type":{"type":"string","enum":["Microsoft.BatchAI/workspaces/clusters"]},"apiVersion":{"type":"string","enum":["2018-05-01"]},"properties":{"oneOf":[{"$ref":"#/definitions/ClusterBaseProperties"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The properties of the Cluster."}},"required":["name","type","apiVersion","properties"],"description":"Microsoft.BatchAI/workspaces/clusters"},"workspaces_experiments":{"type":"object","properties":{"name":{"oneOf":[{"type":"string","pattern":"^[-\\w_]+$"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The name of the experiment. Experiment names can only contain a combination of alphanumeric characters along with dash (-) and underscore (_). The name must be from 1 through 64 characters long."},"type":{"type":"string","enum":["Microsoft.BatchAI/workspaces/experiments"]},"apiVersion":{"type":"string","enum":["2018-05-01"]},"resources":{"type":"array","items":{"oneOf":[{"$ref":"#/definitions/workspaces_experiments_jobs_childResource"}]}}},"required":["name","type","apiVersion"],"description":"Microsoft.BatchAI/workspaces/experiments"},"workspaces_experiments_jobs":{"type":"object","properties":{"name":{"oneOf":[{"type":"string","pattern":"^[-\\w_]+$"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The name of the job within the specified resource group. Job names can only contain a combination of alphanumeric characters along with dash (-) and underscore (_). The name must be from 1 through 64 characters long."},"type":{"type":"string","enum":["Microsoft.BatchAI/workspaces/experiments/jobs"]},"apiVersion":{"type":"string","enum":["2018-05-01"]},"properties":{"oneOf":[{"$ref":"#/definitions/JobBaseProperties"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The properties of the Job."}},"required":["name","type","apiVersion","properties"],"description":"Microsoft.BatchAI/workspaces/experiments/jobs"},"workspaces_fileServers":{"type":"object","properties":{"name":{"oneOf":[{"type":"string","pattern":"^[-\\w_]+$"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The name of the file server within the specified resource group. File server names can only contain a combination of alphanumeric characters along with dash (-) and underscore (_). The name must be from 1 through 64 characters long."},"type":{"type":"string","enum":["Microsoft.BatchAI/workspaces/fileServers"]},"apiVersion":{"type":"string","enum":["2018-05-01"]},"properties":{"oneOf":[{"$ref":"#/definitions/FileServerBaseProperties"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The properties of the File Server."}},"required":["name","type","apiVersion","properties"],"description":"Microsoft.BatchAI/workspaces/fileServers"}},"definitions":{"AppInsightsReference":{"type":"object","properties":{"component":{"oneOf":[{"$ref":"#/definitions/ResourceId"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Azure Application Insights component resource ID."},"instrumentationKey":{"type":"string","description":"Value of the Azure Application Insights instrumentation key."},"instrumentationKeySecretReference":{"oneOf":[{"$ref":"#/definitions/KeyVaultSecretReference"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"KeyVault Store and Secret which contains Azure Application Insights instrumentation key. One of instrumentationKey or instrumentationKeySecretReference must be specified."}},"required":["component"],"description":"Azure Application Insights information for performance counters reporting."},"AutoScaleSettings":{"type":"object","properties":{"minimumNodeCount":{"oneOf":[{"type":"integer"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The minimum number of compute nodes the Batch AI service will try to allocate for the cluster. Note, the actual number of nodes can be less than the specified value if the subscription has not enough quota to fulfill the request."},"maximumNodeCount":{"oneOf":[{"type":"integer"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The maximum number of compute nodes the cluster can have."},"initialNodeCount":{"oneOf":[{"type":"integer","default":"0"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The number of compute nodes to allocate on cluster creation. Note that this value is used only during cluster creation. Default: 0."}},"required":["minimumNodeCount","maximumNodeCount"],"description":"Auto-scale settings for the cluster. The system automatically scales the cluster up and down (within minimumNodeCount and maximumNodeCount) based on the number of queued and running jobs assigned to the cluster."},"AzureBlobFileSystemReference":{"type":"object","properties":{"accountName":{"type":"string","description":"Name of the Azure storage account."},"containerName":{"type":"string","description":"Name of the Azure Blob Storage container to mount on the cluster."},"credentials":{"oneOf":[{"$ref":"#/definitions/AzureStorageCredentialsInfo"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Information about the Azure storage credentials."},"relativeMountPath":{"type":"string","description":"The relative path on the compute node where the Azure File container will be mounted. Note that all cluster level containers will be mounted under $AZ_BATCHAI_MOUNT_ROOT location and all job level containers will be mounted under $AZ_BATCHAI_JOB_MOUNT_ROOT."},"mountOptions":{"type":"string","description":"Mount options for mounting blobfuse file system."}},"required":["accountName","containerName","credentials","relativeMountPath"],"description":"Azure Blob Storage Container mounting configuration."},"AzureFileShareReference":{"type":"object","properties":{"accountName":{"type":"string","description":"Name of the Azure storage account."},"azureFileUrl":{"type":"string","description":"URL to access the Azure File."},"credentials":{"oneOf":[{"$ref":"#/definitions/AzureStorageCredentialsInfo"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Information about the Azure storage credentials."},"relativeMountPath":{"type":"string","description":"The relative path on the compute node where the Azure File share will be mounted. Note that all cluster level file shares will be mounted under $AZ_BATCHAI_MOUNT_ROOT location and all job level file shares will be mounted under $AZ_BATCHAI_JOB_MOUNT_ROOT."},"fileMode":{"type":"string","default":"0777","description":"File mode for files on the mounted file share. Default value: 0777."},"directoryMode":{"type":"string","default":"0777","description":"File mode for directories on the mounted file share. Default value: 0777."}},"required":["accountName","azureFileUrl","credentials","relativeMountPath"],"description":"Azure File Share mounting configuration."},"AzureStorageCredentialsInfo":{"type":"object","properties":{"accountKey":{"type":"string","description":"Storage account key. One of accountKey or accountKeySecretReference must be specified."},"accountKeySecretReference":{"oneOf":[{"$ref":"#/definitions/KeyVaultSecretReference"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Information about KeyVault secret storing the storage account key. One of accountKey or accountKeySecretReference must be specified."}},"description":"Azure storage account credentials."},"Caffe2Settings":{"type":"object","properties":{"pythonScriptFilePath":{"type":"string","description":"The python script to execute."},"pythonInterpreterPath":{"type":"string","description":"The path to the Python interpreter."},"commandLineArgs":{"type":"string","description":"Command line arguments that need to be passed to the python script."}},"required":["pythonScriptFilePath"],"description":"Caffe2 job settings."},"CaffeSettings":{"type":"object","properties":{"configFilePath":{"type":"string","description":"Path of the config file for the job. This property cannot be specified if pythonScriptFilePath is specified."},"pythonScriptFilePath":{"type":"string","description":"Python script to execute. This property cannot be specified if configFilePath is specified."},"pythonInterpreterPath":{"type":"string","description":"The path to the Python interpreter. The property can be specified only if the pythonScriptFilePath is specified."},"commandLineArgs":{"type":"string","description":"Command line arguments that need to be passed to the Caffe job."},"processCount":{"oneOf":[{"type":"integer"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Number of processes to launch for the job execution. The default value for this property is equal to nodeCount property"}},"description":"Caffe job settings."},"ChainerSettings":{"type":"object","properties":{"pythonScriptFilePath":{"type":"string","description":"The python script to execute."},"pythonInterpreterPath":{"type":"string","description":"The path to the Python interpreter."},"commandLineArgs":{"type":"string","description":"Command line arguments that need to be passed to the python script."},"processCount":{"oneOf":[{"type":"integer"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Number of processes to launch for the job execution. The default value for this property is equal to nodeCount property"}},"required":["pythonScriptFilePath"],"description":"Chainer job settings."},"ClusterBaseProperties":{"type":"object","properties":{"vmSize":{"type":"string","description":"The size of the virtual machines in the cluster. All nodes in a cluster have the same VM size. For information about available VM sizes for clusters using images from the Virtual Machines Marketplace see Sizes for Virtual Machines (Linux). Batch AI service supports all Azure VM sizes except STANDARD_A0 and those with premium storage (STANDARD_GS, STANDARD_DS, and STANDARD_DSV2 series)."},"vmPriority":{"oneOf":[{"type":"string","enum":["dedicated","lowpriority"]},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"VM priority. Allowed values are: dedicated (default) and lowpriority."},"scaleSettings":{"oneOf":[{"$ref":"#/definitions/ScaleSettings"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Scale settings for the cluster. Batch AI service supports manual and auto scale clusters."},"virtualMachineConfiguration":{"oneOf":[{"$ref":"#/definitions/VirtualMachineConfiguration"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"OS image configuration for cluster nodes. All nodes in a cluster have the same OS image."},"nodeSetup":{"oneOf":[{"$ref":"#/definitions/NodeSetup"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Setup to be performed on each compute node in the cluster."},"userAccountSettings":{"oneOf":[{"$ref":"#/definitions/UserAccountSettings"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Settings for an administrator user account that will be created on each compute node in the cluster."},"subnet":{"oneOf":[{"$ref":"#/definitions/ResourceId"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Existing virtual network subnet to put the cluster nodes in. Note, if a File Server mount configured in node setup, the File Server's subnet will be used automatically."}},"required":["vmSize","userAccountSettings"],"description":"The properties of a Cluster."},"CNTKsettings":{"type":"object","properties":{"languageType":{"type":"string","description":"The language to use for launching CNTK (aka Microsoft Cognitive Toolkit) job. Valid values are 'BrainScript' or 'Python'."},"configFilePath":{"type":"string","description":"Specifies the path of the BrainScript config file. This property can be specified only if the languageType is 'BrainScript'."},"pythonScriptFilePath":{"type":"string","description":"Python script to execute. This property can be specified only if the languageType is 'Python'."},"pythonInterpreterPath":{"type":"string","description":"The path to the Python interpreter. This property can be specified only if the languageType is 'Python'."},"commandLineArgs":{"type":"string","description":"Command line arguments that need to be passed to the python script or cntk executable."},"processCount":{"oneOf":[{"type":"integer"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Number of processes to launch for the job execution. The default value for this property is equal to nodeCount property"}},"description":"CNTK (aka Microsoft Cognitive Toolkit) job settings."},"ContainerSettings":{"type":"object","properties":{"imageSourceRegistry":{"oneOf":[{"$ref":"#/definitions/ImageSourceRegistry"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Information about docker image and docker registry to download the container from."},"shmSize":{"type":"string","description":"Size of /dev/shm. Please refer to docker documentation for supported argument formats."}},"required":["imageSourceRegistry"],"description":"Docker container settings."},"CustomMpiSettings":{"type":"object","properties":{"commandLine":{"type":"string","description":"The command line to be executed by mpi runtime on each compute node."},"processCount":{"oneOf":[{"type":"integer"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Number of processes to launch for the job execution. The default value for this property is equal to nodeCount property"}},"required":["commandLine"],"description":"Custom MPI job settings."},"CustomToolkitSettings":{"type":"object","properties":{"commandLine":{"type":"string","description":"The command line to execute on the master node."}},"description":"Custom tool kit job settings."},"DataDisks":{"type":"object","properties":{"diskSizeInGB":{"oneOf":[{"type":"integer"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Disk size in GB for the blank data disks."},"cachingType":{"oneOf":[{"type":"string","enum":["none","readonly","readwrite"]},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Caching type for the disks. Available values are none (default), readonly, readwrite. Caching type can be set only for VM sizes supporting premium storage."},"diskCount":{"oneOf":[{"type":"integer"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Number of data disks attached to the File Server. If multiple disks attached, they will be configured in RAID level 0."},"storageAccountType":{"oneOf":[{"type":"string","enum":["Standard_LRS","Premium_LRS"]},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Type of storage account to be used on the disk. Possible values are: Standard_LRS or Premium_LRS. Premium storage account type can only be used with VM sizes supporting premium storage."}},"required":["diskSizeInGB","diskCount","storageAccountType"],"description":"Data disks settings."},"EnvironmentVariable":{"type":"object","properties":{"name":{"type":"string","description":"The name of the environment variable."},"value":{"type":"string","description":"The value of the environment variable."}},"required":["name","value"],"description":"An environment variable definition."},"EnvironmentVariableWithSecretValue":{"type":"object","properties":{"name":{"type":"string","description":"The name of the environment variable to store the secret value."},"value":{"type":"string","description":"The value of the environment variable. This value will never be reported back by Batch AI."},"valueSecretReference":{"oneOf":[{"$ref":"#/definitions/KeyVaultSecretReference"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"KeyVault store and secret which contains the value for the environment variable. One of value or valueSecretReference must be provided."}},"required":["name"],"description":"An environment variable with secret value definition."},"FileServerBaseProperties":{"type":"object","properties":{"vmSize":{"type":"string","description":"The size of the virtual machine for the File Server. For information about available VM sizes from the Virtual Machines Marketplace, see Sizes for Virtual Machines (Linux)."},"sshConfiguration":{"oneOf":[{"$ref":"#/definitions/SshConfiguration"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"SSH configuration for the File Server node."},"dataDisks":{"oneOf":[{"$ref":"#/definitions/DataDisks"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Settings for the data disks which will be created for the File Server."},"subnet":{"oneOf":[{"$ref":"#/definitions/ResourceId"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Identifier of an existing virtual network subnet to put the File Server in. If not provided, a new virtual network and subnet will be created."}},"required":["vmSize","sshConfiguration","dataDisks"],"description":"The properties of a file server."},"FileServerReference":{"type":"object","properties":{"fileServer":{"oneOf":[{"$ref":"#/definitions/ResourceId"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Resource ID of the existing File Server to be mounted."},"sourceDirectory":{"type":"string","description":"File Server directory that needs to be mounted. If this property is not specified, the entire File Server will be mounted."},"relativeMountPath":{"type":"string","description":"The relative path on the compute node where the File Server will be mounted. Note that all cluster level file servers will be mounted under $AZ_BATCHAI_MOUNT_ROOT location and all job level file servers will be mounted under $AZ_BATCHAI_JOB_MOUNT_ROOT."},"mountOptions":{"type":"string","description":"Mount options to be passed to mount command."}},"required":["fileServer","relativeMountPath"],"description":"File Server mounting configuration."},"HorovodSettings":{"type":"object","properties":{"pythonScriptFilePath":{"type":"string","description":"The python script to execute."},"pythonInterpreterPath":{"type":"string","description":"The path to the Python interpreter."},"commandLineArgs":{"type":"string","description":"Command line arguments that need to be passed to the python script."},"processCount":{"oneOf":[{"type":"integer"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Number of processes to launch for the job execution. The default value for this property is equal to nodeCount property"}},"required":["pythonScriptFilePath"],"description":"Specifies the settings for Horovod job."},"ImageReference":{"type":"object","properties":{"publisher":{"type":"string","description":"Publisher of the image."},"offer":{"type":"string","description":"Offer of the image."},"sku":{"type":"string","description":"SKU of the image."},"version":{"type":"string","description":"Version of the image."},"virtualMachineImageId":{"type":"string","description":"The ARM resource identifier of the virtual machine image for the compute nodes. This is of the form /subscriptions/{subscriptionId}/resourceGroups/{resourceGroup}/providers/Microsoft.Compute/images/{imageName}. The virtual machine image must be in the same region and subscription as the cluster. For information about the firewall settings for the Batch node agent to communicate with the Batch service see https://docs.microsoft.com/en-us/azure/batch/batch-api-basics#virtual-network-vnet-and-firewall-configuration. Note, you need to provide publisher, offer and sku of the base OS image of which the custom image has been derived from."}},"required":["publisher","offer","sku"],"description":"The OS image reference."},"ImageSourceRegistry":{"type":"object","properties":{"serverUrl":{"type":"string","description":"URL for image repository."},"image":{"type":"string","description":"The name of the image in the image repository."},"credentials":{"oneOf":[{"$ref":"#/definitions/PrivateRegistryCredentials"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Credentials to access the private docker repository."}},"required":["image"],"description":"Information about docker image for the job."},"InputDirectory":{"type":"object","properties":{"id":{"type":"string","description":"The ID for the input directory. The job can use AZ_BATCHAI_INPUT_<id> environment variable to find the directory path, where <id> is the value of id attribute."},"path":{"type":"string","description":"The path to the input directory."}},"required":["id","path"],"description":"Input directory for the job."},"JobBaseProperties":{"type":"object","properties":{"schedulingPriority":{"oneOf":[{"type":"string","enum":["low","normal","high"]},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Scheduling priority associated with the job. Possible values: low, normal, high."},"cluster":{"oneOf":[{"$ref":"#/definitions/ResourceId"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Resource ID of the cluster on which this job will run."},"mountVolumes":{"oneOf":[{"$ref":"#/definitions/MountVolumes"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Information on mount volumes to be used by the job. These volumes will be mounted before the job execution and will be unmouted after the job completion. The volumes will be mounted at location specified by $AZ_BATCHAI_JOB_MOUNT_ROOT environment variable."},"nodeCount":{"oneOf":[{"type":"integer"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Number of compute nodes to run the job on. The job will be gang scheduled on that many compute nodes."},"containerSettings":{"oneOf":[{"$ref":"#/definitions/ContainerSettings"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Docker container settings for the job. If not provided, the job will run directly on the node."},"cntkSettings":{"oneOf":[{"$ref":"#/definitions/CNTKsettings"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Settings for CNTK (aka Microsoft Cognitive Toolkit) job."},"pyTorchSettings":{"oneOf":[{"$ref":"#/definitions/PyTorchSettings"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Settings for pyTorch job."},"tensorFlowSettings":{"oneOf":[{"$ref":"#/definitions/TensorFlowSettings"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Settings for Tensor Flow job."},"caffeSettings":{"oneOf":[{"$ref":"#/definitions/CaffeSettings"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Settings for Caffe job."},"caffe2Settings":{"oneOf":[{"$ref":"#/definitions/Caffe2Settings"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Settings for Caffe2 job."},"chainerSettings":{"oneOf":[{"$ref":"#/definitions/ChainerSettings"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Settings for Chainer job."},"customToolkitSettings":{"oneOf":[{"$ref":"#/definitions/CustomToolkitSettings"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Settings for custom tool kit job."},"customMpiSettings":{"oneOf":[{"$ref":"#/definitions/CustomMpiSettings"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Settings for custom MPI job."},"horovodSettings":{"oneOf":[{"$ref":"#/definitions/HorovodSettings"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Settings for Horovod job."},"jobPreparation":{"oneOf":[{"$ref":"#/definitions/JobPreparation"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"A command line to be executed on each node allocated for the job before tool kit is launched."},"stdOutErrPathPrefix":{"type":"string","description":"The path where the Batch AI service will store stdout, stderror and execution log of the job."},"inputDirectories":{"oneOf":[{"type":"array","items":{"$ref":"#/definitions/InputDirectory"}},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"A list of input directories for the job."},"outputDirectories":{"oneOf":[{"type":"array","items":{"$ref":"#/definitions/OutputDirectory"}},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"A list of output directories for the job."},"environmentVariables":{"oneOf":[{"type":"array","items":{"$ref":"#/definitions/EnvironmentVariable"}},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"A list of user defined environment variables which will be setup for the job."},"secrets":{"oneOf":[{"type":"array","items":{"$ref":"#/definitions/EnvironmentVariableWithSecretValue"}},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"A list of user defined environment variables with secret values which will be setup for the job. Server will never report values of these variables back."},"constraints":{"oneOf":[{"$ref":"#/definitions/JobBasePropertiesConstraints"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Constraints associated with the Job."}},"required":["cluster","nodeCount","stdOutErrPathPrefix"],"description":"The properties of a Batch AI Job."},"JobBasePropertiesConstraints":{"type":"object","properties":{"maxWallClockTime":{"type":"string","default":"7.00:00:00","description":"Max time the job can run. Default value: 1 week."}},"description":"Constraints associated with the Job."},"JobPreparation":{"type":"object","properties":{"commandLine":{"type":"string","description":"The command line to execute. If containerSettings is specified on the job, this commandLine will be executed in the same container as job. Otherwise it will be executed on the node."}},"required":["commandLine"],"description":"Job preparation settings."},"KeyVaultSecretReference":{"type":"object","properties":{"sourceVault":{"oneOf":[{"$ref":"#/definitions/ResourceId"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Fully qualified resource indentifier of the Key Vault."},"secretUrl":{"type":"string","description":"The URL referencing a secret in the Key Vault."}},"required":["sourceVault","secretUrl"],"description":"Key Vault Secret reference."},"ManualScaleSettings":{"type":"object","properties":{"targetNodeCount":{"oneOf":[{"type":"integer","default":"0"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The desired number of compute nodes in the Cluster. Default is 0."},"nodeDeallocationOption":{"oneOf":[{"type":"string","enum":["requeue","terminate","waitforjobcompletion"]},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"An action to be performed when the cluster size is decreasing. The default value is requeue."}},"required":["targetNodeCount"],"description":"Manual scale settings for the cluster."},"MountVolumes":{"type":"object","properties":{"azureFileShares":{"oneOf":[{"type":"array","items":{"$ref":"#/definitions/AzureFileShareReference"}},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"A collection of Azure File Shares that are to be mounted to the cluster nodes."},"azureBlobFileSystems":{"oneOf":[{"type":"array","items":{"$ref":"#/definitions/AzureBlobFileSystemReference"}},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"A collection of Azure Blob Containers that are to be mounted to the cluster nodes."},"fileServers":{"oneOf":[{"type":"array","items":{"$ref":"#/definitions/FileServerReference"}},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"A collection of Batch AI File Servers that are to be mounted to the cluster nodes."},"unmanagedFileSystems":{"oneOf":[{"type":"array","items":{"$ref":"#/definitions/UnmanagedFileSystemReference"}},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"A collection of unmanaged file systems that are to be mounted to the cluster nodes."}},"description":"Details of volumes to mount on the cluster."},"NodeSetup":{"type":"object","properties":{"setupTask":{"oneOf":[{"$ref":"#/definitions/SetupTask"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Setup task to run on cluster nodes when nodes got created or rebooted. The setup task code needs to be idempotent. Generally the setup task is used to download static data that is required for all jobs that run on the cluster VMs and/or to download/install software."},"mountVolumes":{"oneOf":[{"$ref":"#/definitions/MountVolumes"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Mount volumes to be available to setup task and all jobs executing on the cluster. The volumes will be mounted at location specified by $AZ_BATCHAI_MOUNT_ROOT environment variable."},"performanceCountersSettings":{"oneOf":[{"$ref":"#/definitions/PerformanceCountersSettings"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Settings for performance counters collecting and uploading."}},"description":"Node setup settings."},"OutputDirectory":{"type":"object","properties":{"id":{"type":"string","description":"The ID of the output directory. The job can use AZ_BATCHAI_OUTPUT_<id> environment variale to find the directory path, where <id> is the value of id attribute."},"pathPrefix":{"type":"string","description":"The prefix path where the output directory will be created. Note, this is an absolute path to prefix. E.g. $AZ_BATCHAI_MOUNT_ROOT/MyNFS/MyLogs. The full path to the output directory by combining pathPrefix, jobOutputDirectoryPathSegment (reported by get job) and pathSuffix."},"pathSuffix":{"type":"string","description":"The suffix path where the output directory will be created. E.g. models. You can find the full path to the output directory by combining pathPrefix, jobOutputDirectoryPathSegment (reported by get job) and pathSuffix."}},"required":["id","pathPrefix"],"description":"Output directory for the job."},"PerformanceCountersSettings":{"type":"object","properties":{"appInsightsReference":{"oneOf":[{"$ref":"#/definitions/AppInsightsReference"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Azure Application Insights information for performance counters reporting. If provided, Batch AI will upload node performance counters to the corresponding Azure Application Insights account."}},"required":["appInsightsReference"],"description":"Performance counters reporting settings."},"PrivateRegistryCredentials":{"type":"object","properties":{"username":{"type":"string","description":"User name to login to the repository."},"password":{"type":"string","description":"User password to login to the docker repository. One of password or passwordSecretReference must be specified."},"passwordSecretReference":{"oneOf":[{"$ref":"#/definitions/KeyVaultSecretReference"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"KeyVault Secret storing the password. Users can store their secrets in Azure KeyVault and pass it to the Batch AI service to integrate with KeyVault. One of password or passwordSecretReference must be specified."}},"required":["username"],"description":"Credentials to access a container image in a private repository."},"PyTorchSettings":{"type":"object","properties":{"pythonScriptFilePath":{"type":"string","description":"The python script to execute."},"pythonInterpreterPath":{"type":"string","description":"The path to the Python interpreter."},"commandLineArgs":{"type":"string","description":"Command line arguments that need to be passed to the python script."},"processCount":{"oneOf":[{"type":"integer"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Number of processes to launch for the job execution. The default value for this property is equal to nodeCount property"},"communicationBackend":{"type":"string","description":"Type of the communication backend for distributed jobs. Valid values are 'TCP', 'Gloo' or 'MPI'. Not required for non-distributed jobs."}},"required":["pythonScriptFilePath"],"description":"pyTorch job settings."},"ResourceId":{"type":"object","properties":{"id":{"type":"string","description":"The ID of the resource"}},"required":["id"],"description":"Represents a resource ID. For example, for a subnet, it is the resource URL for the subnet."},"ScaleSettings":{"type":"object","properties":{"manual":{"oneOf":[{"$ref":"#/definitions/ManualScaleSettings"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Manual scale settings for the cluster."},"autoScale":{"oneOf":[{"$ref":"#/definitions/AutoScaleSettings"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Auto-scale settings for the cluster."}},"description":"At least one of manual or autoScale settings must be specified. Only one of manual or autoScale settings can be specified. If autoScale settings are specified, the system automatically scales the cluster up and down (within the supplied limits) based on the pending jobs on the cluster."},"SetupTask":{"type":"object","properties":{"commandLine":{"type":"string","description":"The command line to be executed on each cluster's node after it being allocated or rebooted. The command is executed in a bash subshell as a root."},"environmentVariables":{"oneOf":[{"type":"array","items":{"$ref":"#/definitions/EnvironmentVariable"}},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"A collection of user defined environment variables to be set for setup task."},"secrets":{"oneOf":[{"type":"array","items":{"$ref":"#/definitions/EnvironmentVariableWithSecretValue"}},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"A collection of user defined environment variables with secret values to be set for the setup task. Server will never report values of these variables back."},"stdOutErrPathPrefix":{"type":"string","description":"The prefix of a path where the Batch AI service will upload the stdout, stderr and execution log of the setup task."}},"required":["commandLine","stdOutErrPathPrefix"],"description":"Specifies a setup task which can be used to customize the compute nodes of the cluster."},"SshConfiguration":{"type":"object","properties":{"publicIPsToAllow":{"oneOf":[{"type":"array","items":{"type":"string"}},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"List of source IP ranges to allow SSH connection from. The default value is '*' (all source IPs are allowed). Maximum number of IP ranges that can be specified is 400."},"userAccountSettings":{"oneOf":[{"$ref":"#/definitions/UserAccountSettings"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"Settings for administrator user account to be created on a node. The account can be used to establish SSH connection to the node."}},"required":["userAccountSettings"],"description":"SSH configuration."},"TensorFlowSettings":{"type":"object","properties":{"pythonScriptFilePath":{"type":"string","description":"The python script to execute."},"pythonInterpreterPath":{"type":"string","description":"The path to the Python interpreter."},"masterCommandLineArgs":{"type":"string","description":"Command line arguments that need to be passed to the python script for the master task."},"workerCommandLineArgs":{"type":"string","description":"Command line arguments that need to be passed to the python script for the worker task. Optional for single process jobs."},"parameterServerCommandLineArgs":{"type":"string","description":"Command line arguments that need to be passed to the python script for the parameter server. Optional for single process jobs."},"workerCount":{"oneOf":[{"type":"integer"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The number of worker tasks. If specified, the value must be less than or equal to (nodeCount * numberOfGPUs per VM). If not specified, the default value is equal to nodeCount. This property can be specified only for distributed TensorFlow training."},"parameterServerCount":{"oneOf":[{"type":"integer"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The number of parameter server tasks. If specified, the value must be less than or equal to nodeCount. If not specified, the default value is equal to 1 for distributed TensorFlow training. This property can be specified only for distributed TensorFlow training."}},"required":["pythonScriptFilePath"],"description":"TensorFlow job settings."},"UnmanagedFileSystemReference":{"type":"object","properties":{"mountCommand":{"type":"string","description":"Mount command line. Note, Batch AI will append mount path to the command on its own."},"relativeMountPath":{"type":"string","description":"The relative path on the compute node where the unmanaged file system will be mounted. Note that all cluster level unmanaged file systems will be mounted under $AZ_BATCHAI_MOUNT_ROOT location and all job level unmanaged file systems will be mounted under $AZ_BATCHAI_JOB_MOUNT_ROOT."}},"required":["mountCommand","relativeMountPath"],"description":"Unmananged file system mounting configuration."},"UserAccountSettings":{"type":"object","properties":{"adminUserName":{"type":"string","description":"Name of the administrator user account which can be used to SSH to nodes."},"adminUserSshPublicKey":{"type":"string","description":"SSH public key of the administrator user account."},"adminUserPassword":{"type":"string","description":"Password of the administrator user account."}},"required":["adminUserName"],"description":"Settings for user account that gets created on each on the nodes of a cluster."},"VirtualMachineConfiguration":{"type":"object","properties":{"imageReference":{"oneOf":[{"$ref":"#/definitions/ImageReference"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"OS image reference for cluster nodes."}},"description":"VM configuration."},"workspaces_clusters_childResource":{"type":"object","properties":{"name":{"oneOf":[{"type":"string","pattern":"^[-\\w_]+$"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The name of the cluster within the specified resource group. Cluster names can only contain a combination of alphanumeric characters along with dash (-) and underscore (_). The name must be from 1 through 64 characters long."},"type":{"type":"string","enum":["clusters"]},"apiVersion":{"type":"string","enum":["2018-05-01"]},"properties":{"oneOf":[{"$ref":"#/definitions/ClusterBaseProperties"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The properties of the Cluster."}},"required":["name","type","apiVersion","properties"],"description":"Microsoft.BatchAI/workspaces/clusters"},"workspaces_experiments_childResource":{"type":"object","properties":{"name":{"oneOf":[{"type":"string","pattern":"^[-\\w_]+$"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The name of the experiment. Experiment names can only contain a combination of alphanumeric characters along with dash (-) and underscore (_). The name must be from 1 through 64 characters long."},"type":{"type":"string","enum":["experiments"]},"apiVersion":{"type":"string","enum":["2018-05-01"]},"resources":{"type":"array","items":{"oneOf":[{"$ref":"#/definitions/workspaces_experiments_jobs_childResource"}]}}},"required":["name","type","apiVersion"],"description":"Microsoft.BatchAI/workspaces/experiments"},"workspaces_experiments_jobs_childResource":{"type":"object","properties":{"name":{"oneOf":[{"type":"string","pattern":"^[-\\w_]+$"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The name of the job within the specified resource group. Job names can only contain a combination of alphanumeric characters along with dash (-) and underscore (_). The name must be from 1 through 64 characters long."},"type":{"type":"string","enum":["jobs"]},"apiVersion":{"type":"string","enum":["2018-05-01"]},"properties":{"oneOf":[{"$ref":"#/definitions/JobBaseProperties"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The properties of the Job."}},"required":["name","type","apiVersion","properties"],"description":"Microsoft.BatchAI/workspaces/experiments/jobs"},"workspaces_fileServers_childResource":{"type":"object","properties":{"name":{"oneOf":[{"type":"string","pattern":"^[-\\w_]+$"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The name of the file server within the specified resource group. File server names can only contain a combination of alphanumeric characters along with dash (-) and underscore (_). The name must be from 1 through 64 characters long."},"type":{"type":"string","enum":["fileServers"]},"apiVersion":{"type":"string","enum":["2018-05-01"]},"properties":{"oneOf":[{"$ref":"#/definitions/FileServerBaseProperties"},{"$ref":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#/definitions/expression"}],"description":"The properties of the File Server."}},"required":["name","type","apiVersion","properties"],"description":"Microsoft.BatchAI/workspaces/fileServers"}}}