---
- name: install sas on metadata
  hosts: [metadata_servers]
  become: yes
  gather_facts: false
  tasks:
     - name: Run metadata install response file
       become: yes
       shell: >-
         /sasshare/scripts/run_install_as_user.sh sasinst /sasshare/responsefiles/metadata.txt

- name: install sas on visual analytics controller
  hosts: [va_controllers]
  become: yes
  gather_facts: false
  tasks:
     - name: Run va install response file
       become: yes
       shell: >-
         /sasshare/scripts/run_install_as_user.sh sasinst /sasshare/responsefiles/va.txt

- name: install sas on midtier
  hosts: [midtier_servers]
  become: yes
  gather_facts: false
  tasks:
     - name: create vfabric folders
       file:
         path: /etc/opt/vmware/vfabric
         state: directory

     - name: Change ownership of vmware folder
       file:
         path: /etc/opt/vmware
         owner: sasinst
         group: sas
         mode: '0755'

     - name: Change ownership of vfabric folder
       file:
         path: /etc/opt/vmware/vfabric
         owner: sasinst
         group: sas
         mode: '0755'

     - name: Run midtier install response file
       become: yes
       shell: >-
         /sasshare/scripts/run_install_as_user.sh sasinst /sasshare/responsefiles/midtier.txt
