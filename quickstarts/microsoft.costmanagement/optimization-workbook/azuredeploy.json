{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "_generator": {
      "name": "bicep",
      "version": "0.17.1.54307",
      "templateHash": "4452473716544053800"
    }
  },
  "parameters": {
    "displayName": {
      "type": "string",
      "defaultValue": "Cost optimization",
      "metadata": {
        "description": "Optional. Display name for the workbook used in the Gallery. Must be unique in the resource group."
      }
    },
    "location": {
      "type": "string",
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Optional. Location of the resources. Default: Same as deployment. See https://aka.ms/azureregions."
      }
    },
    "description": {
      "type": "string",
      "defaultValue": "Reports to help you optimize your cost.",
      "metadata": {
        "description": "Optional. Workbook description."
      }
    },
    "tags": {
      "type": "object",
      "defaultValue": {},
      "metadata": {
        "description": "Optional. Tags for all resources."
      }
    }
  },
  "variables": {
    "$fxv#0": {
      "version": "Notebook/1.0",
      "items": [
        {
          "type": 12,
          "content": {
            "version": "NotebookGroup/1.0",
            "groupType": "editable",
            "items": [
              {
                "type": 9,
                "content": {
                  "version": "KqlParameterItem/1.0",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "parameters": [
                    {
                      "id": "51aa3a9b-14e0-4c22-a60d-abdbf8813f00",
                      "version": "KqlParameterItem/1.0",
                      "name": "Subscription",
                      "type": 6,
                      "isRequired": true,
                      "multiSelect": true,
                      "quote": "'",
                      "delimiter": ",",
                      "typeSettings": {
                        "additionalResourceOptions": [
                          "value::all"
                        ],
                        "includeAll": true,
                        "showDefault": false
                      },
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "defaultValue": "value::all"
                    },
                    {
                      "id": "27d877de-fd66-4a67-87b4-081894bffe41",
                      "version": "KqlParameterItem/1.0",
                      "name": "RG_Filter",
                      "label": "Filter By",
                      "type": 2,
                      "isRequired": true,
                      "typeSettings": {
                        "additionalResourceOptions": [],
                        "showDefault": false
                      },
                      "jsonData": "[[\r\n    { \"value\":\"Resource Group\",\"selected\":\"true\"},\r\n    { \"value\":\"Tags\" }\r\n]"
                    },
                    {
                      "id": "3b7465ee-0eb3-419a-abcc-d4569c436df2",
                      "version": "KqlParameterItem/1.0",
                      "name": "Location",
                      "label": "Resource Location",
                      "type": 2,
                      "description": "Select the region where the VMs are located. Different Regions might have different SKUs",
                      "isRequired": true,
                      "query": "Resources\r\n| where type =~ 'Microsoft.Compute/virtualMachines'\r\n| project name, location\r\n| summarize count () by location\r\n| project location\r\n",
                      "crossComponentResources": [
                        "{Subscription}"
                      ],
                      "typeSettings": {
                        "additionalResourceOptions": [
                          "value::1"
                        ],
                        "showDefault": false
                      },
                      "defaultValue": "value::1",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources"
                    },
                    {
                      "id": "2336f06b-ddaa-4a9e-b72f-a2bec1ea84a9",
                      "version": "KqlParameterItem/1.0",
                      "name": "SingleSubHidden",
                      "type": 1,
                      "isRequired": true,
                      "query": "resourcecontainers\r\n| where type==\"microsoft.resources/subscriptions\"\r\n| take 1\r\n| project subscriptionId",
                      "crossComponentResources": [
                        "{Subscription}"
                      ],
                      "isHiddenWhenLocked": true,
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources"
                    }
                  ],
                  "style": "pills",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                },
                "conditionalVisibility": {
                  "parameterName": "SelectedTab",
                  "comparison": "isNotEqualTo",
                  "value": "CostInformation"
                },
                "name": "parameters - 0"
              },
              {
                "type": 9,
                "content": {
                  "version": "KqlParameterItem/1.0",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "parameters": [
                    {
                      "id": "6cb303fd-4812-4097-a468-a177d8782913",
                      "version": "KqlParameterItem/1.0",
                      "name": "ResourceGroup",
                      "label": "Resource Group",
                      "type": 2,
                      "multiSelect": true,
                      "quote": "'",
                      "delimiter": ",",
                      "query": "resourceContainers | where type == 'microsoft.resources/subscriptions/resourcegroups'\r\n| project resourceGroup\r\n| sort by resourceGroup asc",
                      "crossComponentResources": [
                        "{Subscription}"
                      ],
                      "typeSettings": {
                        "additionalResourceOptions": [
                          "value::all"
                        ],
                        "showDefault": false
                      },
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "defaultValue": "value::all",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "value": [
                        "value::all"
                      ]
                    }
                  ],
                  "style": "pills",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                },
                "conditionalVisibilities": [
                  {
                    "parameterName": "RG_Filter",
                    "comparison": "isEqualTo",
                    "value": "Resource Group"
                  },
                  {
                    "parameterName": "SelectedTab",
                    "comparison": "isNotEqualTo",
                    "value": "General"
                  },
                  {
                    "parameterName": "SelectedTab",
                    "comparison": "isNotEqualTo",
                    "value": "CostInformation"
                  }
                ],
                "name": "parameters - 2"
              },
              {
                "type": 9,
                "content": {
                  "version": "KqlParameterItem/1.0",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "parameters": [
                    {
                      "id": "df2a5339-2dd6-478a-a2b1-2dce7651ed0a",
                      "version": "KqlParameterItem/1.0",
                      "name": "TagName",
                      "label": "Tag Name",
                      "type": 2,
                      "isRequired": true,
                      "query": "Resources\r\n| where tags != '' and tags != '[]'\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| distinct tagName\r\n| sort by tagName asc",
                      "crossComponentResources": [
                        "{Subscription}"
                      ],
                      "value": "ssv2excludevm",
                      "typeSettings": {
                        "additionalResourceOptions": [],
                        "showDefault": false
                      },
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources"
                    }
                  ],
                  "style": "pills",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                },
                "customWidth": "20",
                "conditionalVisibilities": [
                  {
                    "parameterName": "RG_Filter",
                    "comparison": "isEqualTo",
                    "value": "Tags"
                  },
                  {
                    "parameterName": "SelectedTab",
                    "comparison": "isNotEqualTo",
                    "value": "General"
                  }
                ],
                "name": "parameters - 3"
              },
              {
                "type": 9,
                "content": {
                  "version": "KqlParameterItem/1.0",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "parameters": [
                    {
                      "id": "d28a3428-b806-4716-a4c5-9f9816224aef",
                      "version": "KqlParameterItem/1.0",
                      "name": "TagValue",
                      "type": 2,
                      "isRequired": true,
                      "query": "Resources\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tags != '' and tags != '[]' and tostring(bag_keys(tags)[0]) == '{TagName}'\r\n| distinct tagValue\r\n| sort by tagValue asc",
                      "crossComponentResources": [
                        "{Subscription}"
                      ],
                      "value": "true",
                      "typeSettings": {
                        "additionalResourceOptions": []
                      },
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources"
                    }
                  ],
                  "style": "pills",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                },
                "customWidth": "20",
                "conditionalVisibilities": [
                  {
                    "parameterName": "SelectedTab",
                    "comparison": "isNotEqualTo",
                    "value": "General"
                  },
                  {
                    "parameterName": "RG_Filter",
                    "comparison": "isEqualTo",
                    "value": "Tags"
                  },
                  {
                    "parameterName": "TagName",
                    "comparison": "isNotEqualTo"
                  }
                ],
                "name": "parameters - 13"
              }
            ],
            "exportParameters": true
          },
          "name": "Parameters"
        },
        {
          "type": 11,
          "content": {
            "version": "LinkItem/1.0",
            "style": "tabs",
            "links": [
              {
                "id": "02e6ccd6-a138-477d-b507-f1ace41b28c6",
                "cellValue": "SelectedTab",
                "linkTarget": "parameter",
                "linkLabel": "Welcome",
                "subTarget": "Welcome",
                "style": "link"
              },
              {
                "id": "ca40468d-4518-43bf-ac6e-0a11d7331e12",
                "cellValue": "SelectedTab",
                "linkTarget": "parameter",
                "linkLabel": "Reservations Recommendations",
                "subTarget": "General",
                "style": "link"
              },
              {
                "id": "34014531-76a5-4eab-9772-9944fa241fea",
                "cellValue": "SelectedTab",
                "linkTarget": "parameter",
                "linkLabel": "Azure Hybrid Benefit",
                "subTarget": "AHUB",
                "style": "link"
              },
              {
                "id": "96d6402c-ff6c-4cf8-961d-8fbe5c98be60",
                "cellValue": "SelectedTab",
                "linkTarget": "parameter",
                "linkLabel": "Compute",
                "subTarget": "Compute",
                "preText": "VirtualMachines",
                "style": "link"
              },
              {
                "id": "4f4786a7-c2df-4788-b5b6-63057bc0c24a",
                "cellValue": "SelectedTab",
                "linkTarget": "parameter",
                "linkLabel": "Disks",
                "subTarget": "Storage",
                "style": "link"
              },
              {
                "id": "feefdffe-9b9b-4480-a0dd-3a2751cab365",
                "cellValue": "SelectedTab",
                "linkTarget": "parameter",
                "linkLabel": "Cost Information",
                "subTarget": "CostInformation",
                "style": "link"
              }
            ]
          },
          "name": "links - 4"
        },
        {
          "type": 12,
          "content": {
            "version": "NotebookGroup/1.0",
            "groupType": "editable",
            "title": "Compute Group",
            "items": [
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "advisorresources\r\n| where type == \"microsoft.advisor/recommendations\"\r\n| where tostring (properties.category) has \"Cost\"\r\n| where properties.impactedField has \"Compute\" or properties.impactedField has \"Container\" or properties.impactedField has \"Web\"\r\n| project AffectedResource=tostring(properties.resourceMetadata.resourceId),Impact=properties.impact,resourceGroup,AdditionaInfo=properties.extendedProperties,subscriptionId,Recommendation=tostring(properties.shortDescription.problem)\r\n| where resourceGroup in ({ResourceGroup})\r\n",
                        "size": 0,
                        "title": "Azure Advisor Cost recommendations",
                        "noDataMessage": "You are following all of our cost recommendations for Compute",
                        "noDataMessageStyle": 3,
                        "showExportToExcel": true,
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "subscriptionId",
                              "formatter": 15,
                              "formatOptions": {
                                "linkTarget": null,
                                "showIcon": true
                              }
                            }
                          ],
                          "rowLimit": 1000,
                          "filter": true,
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "Recommendation"
                            ],
                            "expandTopLevel": true
                          }
                        }
                      },
                      "name": "query - 0"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "resources \r\n| where type =~ 'microsoft.compute/virtualmachines' and tostring(properties.extended.instanceView.powerState.displayStatus) != 'VM deallocated' and tostring(properties.extended.instanceView.powerState.displayStatus) != 'VM running'\r\n| where resourceGroup in ({ResourceGroup})\r\n| extend  VMname=name, PowerState=tostring(properties.extended.instanceView.powerState.displayStatus), VMLocation=location, VirtualMachineId=id\r\n| order by VirtualMachineId asc\r\n| project VirtualMachineId,VMname, PowerState, VMLocation, resourceGroup, subscriptionId",
                        "size": 0,
                        "title": "Virtual Machines in a Stopped State",
                        "noDataMessage": "You have no VMs in a stopped state",
                        "noDataMessageStyle": 3,
                        "showExportToExcel": true,
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ]
                      },
                      "name": "query - 3"
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "RG_Filter",
                  "comparison": "isNotEqualTo",
                  "value": "Tags"
                },
                "name": "Compute - Subscription"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "loadType": "explicit",
                  "items": [
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "advisorresources\r\n| where type == \"microsoft.advisor/recommendations\"\r\n| where tostring (properties.category) has \"Cost\"\r\n| where properties.impactedField has \"Compute\" or properties.impactedField has \"Container\" or properties.impactedField has \"Web\"\r\n| project AffectedResource=tolower(tostring(properties.resourceMetadata.resourceId)),Impact=properties.impact,resourceGroup,AdditionaInfo=properties.extendedProperties,subscriptionId,Recommendation=tostring(properties.shortDescription.problem),AffectedResourceName=tostring(properties.impactedValue)\r\n| join ( resources\r\n    | where type has \"Compute\" or type has \"Web\" or type has \"Container\"\r\n    | extend  AffectedResource=tolower(id)\r\n    ) on AffectedResource\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| project  AffectedResource, Impact,resourceGroup,AdditionaInfo, tagName, tagValue, Recommendation, SubscriptionName=subscriptionId\r\n",
                        "size": 0,
                        "title": "Azure advisor Cost recommendations",
                        "noDataMessage": "You are following all Compute Advisor recommendations",
                        "noDataMessageStyle": 3,
                        "showExportToExcel": true,
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "tagName",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Tags",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            },
                            {
                              "columnMatch": "tagValue",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Tags",
                                    "text": "{0}{1}"
                                  }
                                ]
                              }
                            }
                          ],
                          "rowLimit": 1000,
                          "filter": true,
                          "hierarchySettings": {
                            "treeType": 1,
                            "groupBy": [
                              "Recommendation"
                            ],
                            "expandTopLevel": true
                          }
                        }
                      },
                      "name": "query - 0"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "resources\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where tostring(properties.extended.instanceView.powerState.displayStatus) != 'VM deallocated'\r\n| where tostring(properties.extended.instanceView.powerState.displayStatus) != 'VM running'\r\n| extend  VMname=name, PowerState=tostring(properties.extended.instanceView.powerState.displayStatus), VMLocation=location, VMRG=resourceGroup, VirtualMachineId=id, SubscriptionName=subscriptionId\r\n| project VirtualMachineId,VMname, PowerState, VMLocation, tagName,tagValue,VMRG, SubscriptionName\r\n| order by VirtualMachineId asc",
                        "size": 0,
                        "title": "Virtual Machines in a Stopped State",
                        "noDataMessage": "No Virtual Machines found in stopped state",
                        "noDataMessageStyle": 3,
                        "showExportToExcel": true,
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ]
                      },
                      "name": "query - 3"
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "RG_Filter",
                  "comparison": "isEqualTo",
                  "value": "Tags"
                },
                "name": "Compute - Tags"
              }
            ]
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "Compute"
          },
          "name": "ComputeGroup",
          "styleSettings": {
            "showBorder": true
          }
        },
        {
          "type": 12,
          "content": {
            "version": "NotebookGroup/1.0",
            "groupType": "editable",
            "title": "Storage Group",
            "items": [
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "title": "StorageGroup",
                  "items": [
                    {
                      "type": 12,
                      "content": {
                        "version": "NotebookGroup/1.0",
                        "groupType": "editable",
                        "items": [
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "resources \r\n| where type =~ 'microsoft.compute/disks' and managedBy == \"\"\r\n| where resourceGroup in ({ResourceGroup})\r\n| extend diskState = tostring(properties.diskState)\r\n| where managedBy == \"\" and diskState != 'ActiveSAS'\r\nor diskState == 'Unattached' and diskState != 'ActiveSAS'\r\n| extend DiskId=id, DiskName=name, SKUName=sku.name, SKUTier=sku.tier, DiskSizeGB=tostring(properties.diskSizeGB), Location=location, TimeCreated=tostring(properties.timeCreated), QuickFix=id\r\n| order by DiskId asc \r\n| project DiskId,DiskName, DiskSizeGB, SKUName, SKUTier, resourceGroup, QuickFix, Location, TimeCreated, subscriptionId\r\n",
                              "size": 0,
                              "title": "Unattached disks",
                              "noDataMessage": "There isn't any unnatached disks!",
                              "noDataMessageStyle": 3,
                              "showExportToExcel": true,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "visualization": "table",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "subscriptionId",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "QuickFix",
                                    "formatter": 7,
                                    "formatOptions": {
                                      "linkTarget": "ArmTemplate",
                                      "linkLabel": "Remove Idle Disk",
                                      "linkIsContextBlade": true,
                                      "templateRunContext": {
                                        "componentIdSource": "column",
                                        "componentId": "DiskId",
                                        "templateUriSource": "static",
                                        "templateUri": "https://raw.githubusercontent.com/sebassem/MS-learn-Workbooks/main/Deploy-Tag.json",
                                        "templateParameters": [
                                          {
                                            "name": "DiskID",
                                            "source": "static",
                                            "value": "DiskId",
                                            "kind": "stringValue"
                                          }
                                        ],
                                        "titleSource": "static",
                                        "title": "Remove Idle Disk",
                                        "descriptionSource": "static",
                                        "description": "# Description\r\nThis ARM Template will remove the selected disk.\r\n\r\n# Actions:\r\n- Click \"Remove Idle Disk\" to remove the selected item.\r\n- Click View Template to examine the template and parameters used during deployment\r\n\r\n\r\n\r\n",
                                        "runLabelSource": "static",
                                        "runLabel": "Remove Idle Disk"
                                      }
                                    }
                                  }
                                ],
                                "rowLimit": 1000
                              }
                            },
                            "name": "query - 1"
                          }
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "RG_Filter",
                        "comparison": "isNotEqualTo",
                        "value": "Tags"
                      },
                      "name": "Storage - subscription"
                    },
                    {
                      "type": 12,
                      "content": {
                        "version": "NotebookGroup/1.0",
                        "groupType": "editable",
                        "items": [
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "resources\r\n| where type =~ 'microsoft.compute/disks'\r\n| extend diskState = tostring(properties.diskState)\r\n| where managedBy == \"\" and diskState != 'ActiveSAS'\r\nor diskState == 'Unattached' and diskState != 'ActiveSAS'\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| extend DiskID=id, DiskName=name, SKUName=sku.name, SKUTier=sku.tier, DiskSizeGB=tostring(properties.diskSizeGB),DiskRG=resourceGroup, Location=location, TimeCreated=tostring(properties.timeCreated), SubscriptionName=subscriptionId \r\n| project DiskID,DiskName, DiskSizeGB, SKUName, SKUTier, DiskRG,tagName,tagValue, Location, TimeCreated, SubscriptionName\r\n| order by DiskID asc ",
                              "size": 0,
                              "title": "Unattached disks",
                              "noDataMessage": "You don't have any unattached disks!",
                              "noDataMessageStyle": 3,
                              "showExportToExcel": true,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "tagName",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "Tags",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "columnMatch": "tagValue",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "Tags",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  }
                                ],
                                "rowLimit": 1000
                              }
                            },
                            "name": "query - 5"
                          }
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "RG_Filter",
                        "comparison": "isEqualTo",
                        "value": "Tags"
                      },
                      "name": "Storage - Tags"
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "SelectedTab",
                  "comparison": "isEqualTo",
                  "value": "Storage"
                },
                "name": "StorageGroup"
              },
              {
                "type": 3,
                "content": {
                  "version": "KqlItem/1.0",
                  "query": "resources\r\n| where type == 'microsoft.compute/snapshots'\r\n| where resourceGroup in ({ResourceGroup})\r\n| extend TimeCreated = properties.timeCreated\r\n| where TimeCreated < ago(30d)\r\n| order by id asc \r\n| project Resource=id, resourceGroup, location, TimeCreated ,subscriptionId",
                  "size": 0,
                  "title": "Disk Snapshots with + 30 Days",
                  "noDataMessage": "No Snapshots with more than 30 days.",
                  "noDataMessageStyle": 3,
                  "showExportToExcel": true,
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources",
                  "crossComponentResources": [
                    "{Subscription}"
                  ]
                },
                "name": "OldSnapshots-RG"
              },
              {
                "type": 3,
                "content": {
                  "version": "KqlItem/1.0",
                  "query": "resources\r\n| where type == 'microsoft.compute/snapshots'\r\n| where resourceGroup in ({ResourceGroup})\r\n| extend SnapshotId=id, name, resourceGroup, SnapshotLocation=location, TimeCreated=tostring(properties.timeCreated), SourceDisk=tostring(properties.creationData.sourceResourceId),subscriptionId\r\n| project SnapshotId=id, name, resourceGroup, SnapshotLocation, TimeCreated=tostring(properties.timeCreated), SourceDisk=tostring(properties.creationData.sourceResourceId), subscriptionId \r\n| join kind=leftouter  (\r\nresources\r\n| where type =~ 'microsoft.compute/disks'\r\n| extend SourceDisk=id ) on SourceDisk\r\n| where isempty(managedBy)",
                  "size": 0,
                  "title": "Snapshots of disks that doesn't exist anymore",
                  "noDataMessage": "There aren't any idle disk snapshot",
                  "noDataMessageStyle": 3,
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources",
                  "crossComponentResources": [
                    "{Subscription}"
                  ]
                },
                "name": "Idle Snapshots - RG"
              }
            ]
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "Storage"
          },
          "name": "StorageGroup",
          "styleSettings": {
            "showBorder": true
          }
        },
        {
          "type": 12,
          "content": {
            "version": "NotebookGroup/1.0",
            "groupType": "editable",
            "title": "Storage Group",
            "items": [
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "title": "StorageGroup",
                  "items": [
                    {
                      "type": 12,
                      "content": {
                        "version": "NotebookGroup/1.0",
                        "groupType": "editable",
                        "items": [
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "resources \r\n| where type =~ 'microsoft.compute/disks' and managedBy == \"\"\r\n| where resourceGroup in ({ResourceGroup})\r\n| extend diskState = tostring(properties.diskState)\r\n| where managedBy == \"\" and diskState != 'ActiveSAS'\r\nor diskState == 'Unattached' and diskState != 'ActiveSAS'\r\n| extend DiskId=id, DiskName=name, SKUName=sku.name, SKUTier=sku.tier, DiskSizeGB=tostring(properties.diskSizeGB), Location=location, TimeCreated=tostring(properties.timeCreated), QuickFix=id\r\n| order by DiskId asc \r\n| project DiskId,DiskName, DiskSizeGB, SKUName, SKUTier, resourceGroup, QuickFix, Location, TimeCreated, subscriptionId\r\n",
                              "size": 0,
                              "title": "Unattached disks",
                              "noDataMessage": "There isn't any unnatached disks!",
                              "noDataMessageStyle": 3,
                              "showExportToExcel": true,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "visualization": "table",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "subscriptionId",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "QuickFix",
                                    "formatter": 7,
                                    "formatOptions": {
                                      "linkTarget": "ArmTemplate",
                                      "linkLabel": "Remove Idle Disk",
                                      "linkIsContextBlade": true,
                                      "templateRunContext": {
                                        "componentIdSource": "column",
                                        "componentId": "DiskId",
                                        "templateUriSource": "static",
                                        "templateUri": "https://raw.githubusercontent.com/sebassem/MS-learn-Workbooks/main/Deploy-Tag.json",
                                        "templateParameters": [
                                          {
                                            "name": "DiskID",
                                            "source": "static",
                                            "value": "DiskId",
                                            "kind": "stringValue"
                                          }
                                        ],
                                        "titleSource": "static",
                                        "title": "Remove Idle Disk",
                                        "descriptionSource": "static",
                                        "description": "# Description\r\nThis ARM Template will remove the selected disk.\r\n\r\n# Actions:\r\n- Click \"Remove Idle Disk\" to remove the selected item.\r\n- Click View Template to examine the template and parameters used during deployment\r\n\r\n\r\n\r\n",
                                        "runLabelSource": "static",
                                        "runLabel": "Remove Idle Disk"
                                      }
                                    }
                                  }
                                ],
                                "rowLimit": 1000
                              }
                            },
                            "name": "query - 1"
                          }
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "RG_Filter",
                        "comparison": "isNotEqualTo",
                        "value": "Tags"
                      },
                      "name": "Storage - subscription"
                    },
                    {
                      "type": 12,
                      "content": {
                        "version": "NotebookGroup/1.0",
                        "groupType": "editable",
                        "items": [
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "resources\r\n| where type =~ 'microsoft.compute/disks'\r\n| extend diskState = tostring(properties.diskState)\r\n| where managedBy == \"\" and diskState != 'ActiveSAS'\r\nor diskState == 'Unattached' and diskState != 'ActiveSAS'\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| extend DiskID=id, DiskName=name, SKUName=sku.name, SKUTier=sku.tier, DiskSizeGB=tostring(properties.diskSizeGB),DiskRG=resourceGroup, Location=location, TimeCreated=tostring(properties.timeCreated), SubscriptionName=subscriptionId \r\n| project DiskID,DiskName, DiskSizeGB, SKUName, SKUTier, DiskRG,tagName,tagValue, Location, TimeCreated, SubscriptionName\r\n| order by DiskID asc ",
                              "size": 0,
                              "title": "Unattached disks",
                              "noDataMessage": "You don't have any unattached disks!",
                              "noDataMessageStyle": 3,
                              "showExportToExcel": true,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "tagName",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "Tags",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "columnMatch": "tagValue",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "Tags",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  }
                                ],
                                "rowLimit": 1000
                              }
                            },
                            "name": "query - 5"
                          }
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "RG_Filter",
                        "comparison": "isEqualTo",
                        "value": "Tags"
                      },
                      "name": "Storage - Tags"
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "SelectedTab",
                  "comparison": "isEqualTo",
                  "value": "Storage"
                },
                "name": "StorageGroup"
              },
              {
                "type": 3,
                "content": {
                  "version": "KqlItem/1.0",
                  "query": "resources\r\n| where type == 'microsoft.compute/snapshots'\r\n| where resourceGroup in ({ResourceGroup})\r\n| extend TimeCreated = properties.timeCreated\r\n| where TimeCreated < ago(30d)\r\n| order by id asc \r\n| project Resource=id, resourceGroup, location, TimeCreated ,subscriptionId",
                  "size": 0,
                  "title": "Disk Snapshots with + 30 Days",
                  "noDataMessage": "No Snapshots with more than 30 days.",
                  "noDataMessageStyle": 3,
                  "showExportToExcel": true,
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources",
                  "crossComponentResources": [
                    "{Subscription}"
                  ]
                },
                "name": "OldSnapshots-RG"
              },
              {
                "type": 3,
                "content": {
                  "version": "KqlItem/1.0",
                  "query": "resources\r\n| where type == 'microsoft.compute/snapshots'\r\n| where resourceGroup in ({ResourceGroup})\r\n| extend SnapshotId=id, name, resourceGroup, SnapshotLocation=location, TimeCreated=tostring(properties.timeCreated), SourceDisk=tostring(properties.creationData.sourceResourceId),subscriptionId\r\n| project SnapshotId=id, name, resourceGroup, SnapshotLocation, TimeCreated=tostring(properties.timeCreated), SourceDisk=tostring(properties.creationData.sourceResourceId), subscriptionId \r\n| join kind=leftouter  (\r\nresources\r\n| where type =~ 'microsoft.compute/disks'\r\n| extend SourceDisk=id ) on SourceDisk\r\n| where isempty(managedBy)",
                  "size": 0,
                  "title": "Snapshots of disks that doesn't exist anymore",
                  "noDataMessage": "There aren't any idle disk snapshot",
                  "noDataMessageStyle": 3,
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources",
                  "crossComponentResources": [
                    "{Subscription}"
                  ]
                },
                "name": "Idle Snapshots - RG"
              }
            ]
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "Storage"
          },
          "name": "StorageGroup - Copy",
          "styleSettings": {
            "showBorder": true
          }
        },
        {
          "type": 12,
          "content": {
            "version": "NotebookGroup/1.0",
            "groupType": "editable",
            "title": "Group General",
            "items": [
              {
                "type": 1,
                "content": {
                  "json": "## Azure Advisor Recommendations"
                },
                "name": "text - 3"
              },
              {
                "type": 3,
                "content": {
                  "version": "KqlItem/1.0",
                  "query": "advisorresources\r\n| where type == \"microsoft.advisor/recommendations\"\r\n| where tostring (properties.category) has \"Cost\"\r\n| where properties.impactedField has \"Microsoft.Subscriptions/subscriptions\" or properties.impactedField has \"Microsoft.ReservedInstances/reservedInstances\"\r\n| project AffectedResource=tostring(properties.resourceMetadata.resourceId),Recommendation=tostring(properties.shortDescription.problem),Impact=tostring(properties.impact),resourceGroup,AdditionaInfo=properties.extendedProperties,subscriptionId\r\n",
                  "size": 0,
                  "title": "Azure Advisor subscriptions recommendations",
                  "noDataMessage": "You are following all of our cost recommendations for Subscriptions",
                  "noDataMessageStyle": 3,
                  "showExportToExcel": true,
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "gridSettings": {
                    "hierarchySettings": {
                      "treeType": 1,
                      "groupBy": [
                        "Recommendation"
                      ],
                      "expandTopLevel": true
                    }
                  }
                },
                "name": "query - 12"
              }
            ]
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "General"
          },
          "name": "Group General",
          "styleSettings": {
            "showBorder": true
          }
        },
        {
          "type": 12,
          "content": {
            "version": "NotebookGroup/1.0",
            "groupType": "editable",
            "title": "Welcome",
            "items": [
              {
                "type": 1,
                "content": {
                  "json": "# Welcome to the Cost Optimization Workbook"
                },
                "name": "text - 6"
              },
              {
                "type": 1,
                "content": {
                  "json": "### Reference: [Microsoft Azure Well-Architected Framework - Cost Optimization Pillar](https://learn.microsoft.com/en-us/azure/architecture/framework/cost/overview)",
                  "style": "upsell"
                },
                "name": "text - 5"
              },
              {
                "type": 1,
                "content": {
                  "json": "The objective of this workbook is to provide an overview of the Cost posture of your Azure environment. The workbook is to be used as guidance only, and does not represent a guarantee of any Cost Reduction.\r\n\r\n## Overview of the cost optimization pillar\r\n\r\n* The cost optimization pillar provides principles for balancing business goals with budget justification to create a cost-effective workload while avoiding capital-intensive solutions. Cost optimization is about looking at ways to reduce unnecessary expenses and improve operational efficiencies.\r\n\r\n* To assess your workload using the tenets found in the [Microsoft Azure Well-Architected Framework](https://learn.microsoft.com/en-us/azure/architecture/framework/), reference the [Microsoft Azure Well-Architected Review](https://learn.microsoft.com/en-us/assessments/?id=azure-architecture-review&mode=pre-assessment&session=20dc50e4-5b71-4f38-bc49-51cc1d9f205c).\r\n\r\n\r\n\r\n\r\n"
                },
                "name": "text - 0"
              },
              {
                "type": 1,
                "content": {
                  "json": "Indicates an implemented feature that can result in a environment that is following the Cost Optimization & Cost Governance principles.",
                  "style": "success"
                },
                "customWidth": "50",
                "name": "text - 1",
                "styleSettings": {
                  "margin": "10px",
                  "showBorder": true
                }
              },
              {
                "type": 1,
                "content": {
                  "json": "Indicates a feature that has not been implemented, and therefore should be reviewed",
                  "style": "warning"
                },
                "customWidth": "50",
                "name": "text - 2",
                "styleSettings": {
                  "margin": "10px",
                  "showBorder": true
                }
              },
              {
                "type": 1,
                "content": {
                  "json": "## RBAC Needed\r\n\r\nThis workbook will present various cost-related details in the form of governance, networking, storage, VMs, Webapps, SQL, and cost information to educate the business about cost related to various resources.\r\n\r\n\r\n* Consider the following least-privilege (minimum) RBAC permissions when deploying the workbook:\r\n\r\n  * **Reader** , **Billing Reader** and **Workbook Contributor** : allows you to import the workbook, view all of the workbook tabs including the *Cost Information* tab and save the workbook in a resource group.\r\n  * **Reader** and **Workbook Contributor** : allows you to import the workbook, view all of the workbook tabs except the *Cost Information* tab and save the workbook in a resource group.\r\n  * **Reader** : allows you to import the workbook and view all of the workbook tabs except the *Cost Information* tab.\r\n\r\n\r\n"
                },
                "name": "text - 3"
              },
              {
                "type": 1,
                "content": {
                  "json": "  > The **Cost Information** tab only works with one subscription at the time.",
                  "style": "info"
                },
                "name": "text - 4"
              }
            ]
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "Welcome"
          },
          "name": "Welcome"
        },
        {
          "type": 12,
          "content": {
            "version": "NotebookGroup/1.0",
            "groupType": "editable",
            "title": "Cost Information",
            "items": [
              {
                "type": 9,
                "content": {
                  "version": "KqlParameterItem/1.0",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "parameters": [
                    {
                      "id": "fffccc1f-fc7d-497c-b45b-29417117b862",
                      "version": "KqlParameterItem/1.0",
                      "name": "Subscription",
                      "type": 6,
                      "isRequired": true,
                      "value": "/subscriptions/1283e053-2e46-449f-87d6-842ef6df3272",
                      "typeSettings": {
                        "additionalResourceOptions": [],
                        "includeAll": true
                      },
                      "timeContext": {
                        "durationMs": 86400000
                      }
                    }
                  ],
                  "style": "pills",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                },
                "name": "parameters - 0"
              },
              {
                "type": 9,
                "content": {
                  "version": "KqlParameterItem/1.0",
                  "parameters": [
                    {
                      "id": "1b71c24e-3e21-4598-a1c4-10106dcdfeca",
                      "version": "KqlParameterItem/1.0",
                      "name": "RG_Filter",
                      "label": "Filter By",
                      "type": 2,
                      "typeSettings": {
                        "additionalResourceOptions": [],
                        "showDefault": false
                      },
                      "jsonData": "[[\r\n    { \"value\":\"Resource Group\",\"selected\":\"true\"},\r\n    { \"value\":\"Tags\" }\r\n]",
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "value": "Tags"
                    }
                  ],
                  "style": "pills",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                },
                "conditionalVisibility": {
                  "parameterName": "SelectedTab",
                  "comparison": "isNotEqualTo",
                  "value": "General"
                },
                "name": "parameters - 5"
              },
              {
                "type": 9,
                "content": {
                  "version": "KqlParameterItem/1.0",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "parameters": [
                    {
                      "id": "42099afa-2462-4f0e-88be-b87bb1d3c908",
                      "version": "KqlParameterItem/1.0",
                      "name": "ResourceGroup",
                      "label": "Resource Group",
                      "type": 2,
                      "isRequired": true,
                      "multiSelect": true,
                      "quote": "\"",
                      "delimiter": ",",
                      "query": "resourceContainers | where type == 'microsoft.resources/subscriptions/resourcegroups'\r\n| project resourceGroup\r\n| sort by resourceGroup asc",
                      "crossComponentResources": [
                        "{Subscription}"
                      ],
                      "typeSettings": {
                        "additionalResourceOptions": [
                          "value::all"
                        ],
                        "showDefault": false
                      },
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "defaultValue": "value::all",
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources"
                    }
                  ],
                  "style": "pills",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                },
                "conditionalVisibilities": [
                  {
                    "parameterName": "RG_Filter",
                    "comparison": "isEqualTo",
                    "value": "Resource Group"
                  },
                  {
                    "parameterName": "SelectedTab",
                    "comparison": "isNotEqualTo",
                    "value": "General"
                  }
                ],
                "name": "parameters - 6"
              },
              {
                "type": 9,
                "content": {
                  "version": "KqlParameterItem/1.0",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "parameters": [
                    {
                      "id": "90a85a21-e4f8-48e6-92cb-87aa64a11f3b",
                      "version": "KqlParameterItem/1.0",
                      "name": "TagName",
                      "label": "Tag Name",
                      "type": 2,
                      "isRequired": true,
                      "query": "Resources\r\n| where tags != '' and tags != '[]'\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| distinct tagName\r\n| sort by tagName asc",
                      "crossComponentResources": [
                        "{Subscription}"
                      ],
                      "value": "ssv2excludevm",
                      "typeSettings": {
                        "additionalResourceOptions": []
                      },
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources"
                    }
                  ],
                  "style": "pills",
                  "queryType": 0,
                  "resourceType": "microsoft.resourcegraph/resources"
                },
                "customWidth": "20",
                "conditionalVisibilities": [
                  {
                    "parameterName": "RG_Filter",
                    "comparison": "isEqualTo",
                    "value": "Tags"
                  },
                  {
                    "parameterName": "SelectedTab",
                    "comparison": "isNotEqualTo",
                    "value": "General"
                  }
                ],
                "name": "parameters - 7"
              },
              {
                "type": 9,
                "content": {
                  "version": "KqlParameterItem/1.0",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "parameters": [
                    {
                      "id": "8bd3bf68-2f67-4bf7-a72a-c87817fc172c",
                      "version": "KqlParameterItem/1.0",
                      "name": "TagValue",
                      "label": "Tag Value",
                      "type": 2,
                      "isRequired": true,
                      "query": "Resources\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tags != '' and tags != '[]' and tostring(bag_keys(tags)[0]) == '{TagName}'\r\n| distinct tagValue\r\n| sort by tagValue asc",
                      "crossComponentResources": [
                        "{Subscription}"
                      ],
                      "value": "true",
                      "typeSettings": {
                        "additionalResourceOptions": [],
                        "showDefault": false
                      },
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources"
                    }
                  ],
                  "style": "pills",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                },
                "customWidth": "20",
                "conditionalVisibilities": [
                  {
                    "parameterName": "RG_Filter",
                    "comparison": "isEqualTo",
                    "value": "Tags"
                  },
                  {
                    "parameterName": "SelectedTab",
                    "comparison": "isNotEqualTo",
                    "value": "General"
                  },
                  {
                    "parameterName": "TagName",
                    "comparison": "isNotEqualTo"
                  }
                ],
                "name": "parameters - 8"
              },
              {
                "type": 1,
                "content": {
                  "json": "# This Tab will show Information about idle resource that have impact on cost\r\n### Note: The cost information available  in this tab relates to the previous month.  If the resources was created less than 30 days ago, check the cost management and billing blade.\r\n### *Billing reader permission as a minimum is needed to populate cost information"
                },
                "name": "text - 1"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":\"{\\r\\n\\t\\\"type\\\": \\\"Usage\\\",\\r\\n\\t\\\"timeframe\\\": \\\"TheLastBillingMonth\\\",\\r\\n\\t\\\"dataset\\\": {\\r\\n\\t\\t\\\"granularity\\\": \\\"None\\\",\\r\\n\\t\\t\\\"filter\\\": {\\r\\n\\t\\t\\t\\\"and\\\": [\\r\\n\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\\"dimensions\\\": {\\r\\n\\t\\t\\t\\t\\t\\t\\\"name\\\": \\\"resourceType\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\\"operator\\\": \\\"In\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\\"values\\\": [\\r\\n\\t\\t\\t\\t\\t\\t\\t\\\"microsoft.compute/disks\\\"\\r\\n\\t\\t\\t\\t\\t\\t]\\r\\n\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t},\\r\\n\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\\"dimensions\\\": {\\r\\n\\t\\t\\t\\t\\t\\t\\\"name\\\": \\\"ResourceGroup\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\\"operator\\\": \\\"In\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\\"values\\\": [\\r\\n\\t\\t\\t\\t\\t\\t\\t{ResourceGroup}\\r\\n\\t\\t\\t\\t\\t\\t\\t]\\r\\n\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t}\\r\\n\\t\\t\\t]\\r\\n\\t\\t},\\r\\n\\t\\t\\\"aggregation\\\": {\\r\\n\\t\\t\\t\\\"totalCost\\\": {\\r\\n\\t\\t\\t\\t\\\"name\\\": \\\"PreTaxCost\\\",\\r\\n\\t\\t\\t\\t\\\"function\\\": \\\"Sum\\\"\\r\\n\\t\\t\\t}\\r\\n\\t\\t},\\r\\n\\t\\t\\\"grouping\\\": [\\r\\n\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\\"type\\\": \\\"Dimension\\\",\\r\\n\\t\\t\\t\\t\\\"name\\\": \\\"ResourceId\\\"\\r\\n\\t\\t\\t}\\r\\n\\t\\t]\\r\\n\\t}\\r\\n}\",\"headers\":[],\"method\":\"POST\",\"path\":\"/subscriptions/{Subscription:id}/providers/Microsoft.CostManagement/query?\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2019-11-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.properties\",\"columns\":[]}}]}",
                        "size": 0,
                        "title": "GetCostAllDisks",
                        "queryType": 12
                      },
                      "conditionalVisibility": {
                        "parameterName": "isVisible",
                        "comparison": "isEqualTo",
                        "value": "true"
                      },
                      "name": "query - GetAllDisksCost"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "resources \r\n| where type =~ 'microsoft.compute/disks' and resourceGroup in ({ResourceGroup})\r\n| extend diskState = tostring(properties.diskState)\r\n| where managedBy == \"\" and diskState != 'ActiveSAS'\r\nor diskState == 'Unattached' and diskState != 'ActiveSAS'\r\n| extend DiskID=id, DiskName=name, SKUName=sku.name, SKUTier=sku.tier, DiskSizeGB=tostring(properties.diskSizeGB),DiskRG=resourceGroup, Location=location, TimeCreated=tostring(properties.timeCreated)\r\n| order by id asc \r\n| project DiskID,DiskName, DiskSizeGB, SKUName, SKUTier, DiskRG, Location, TimeCreated, subscriptionId",
                        "size": 0,
                        "title": "Unattached Disks",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "isVisible",
                        "comparison": "isEqualTo",
                        "value": "true"
                      },
                      "name": "query - GetUnattachedDisks"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\",\"mergeType\":\"innerunique\",\"leftTable\":\"query - GetAllDisksCost\",\"rightTable\":\"query - GetUnattachedDisks\",\"leftColumn\":\"ResourceId\",\"rightColumn\":\"DiskID\"}],\"projectRename\":[{\"originalName\":\"[query - GetUnattachedDisks].DiskID\",\"mergedName\":\"DiskID\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetAllDisksCost].PreTaxCost\",\"mergedName\":\"Last Month Cost\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetAllDisksCost].Currency\",\"mergedName\":\"Currency\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].DiskSizeGB\",\"mergedName\":\"DiskSizeGB\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].DiskRG\",\"mergedName\":\"DiskRG\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].Location\",\"mergedName\":\"Location\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].TimeCreated\",\"mergedName\":\"TimeCreated\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetAllDisksCost].ResourceId\"},{\"originalName\":\"[query - GetUnattachedDisks].DiskName\"}]}",
                        "size": 0,
                        "title": "Unattached Managed Disks cost",
                        "noDataMessage": "There isn't any unnatached disk!",
                        "noDataMessageStyle": 3,
                        "showExportToExcel": true,
                        "exportToExcelOptions": "all",
                        "queryType": 7
                      },
                      "showPin": false,
                      "name": "query - Unattaached Disks Cost"
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "RG_Filter",
                  "comparison": "isEqualTo",
                  "value": "Resource Group"
                },
                "name": "group - CostRG"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "items": [
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":\"{\\r\\n\\t\\\"type\\\": \\\"Usage\\\",\\r\\n\\t\\\"timeframe\\\": \\\"TheLastBillingMonth\\\",\\r\\n\\t\\\"dataset\\\": {\\r\\n\\t\\t\\\"granularity\\\": \\\"None\\\",\\r\\n\\t\\t\\\"filter\\\": {\\r\\n\\t\\t\\t\\t\\t\\\"dimensions\\\": {\\r\\n\\t\\t\\t\\t\\t\\t\\\"name\\\": \\\"resourceType\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\\"operator\\\": \\\"In\\\",\\r\\n\\t\\t\\t\\t\\t\\t\\\"values\\\": [\\r\\n\\t\\t\\t\\t\\t\\t\\t\\\"microsoft.compute/disks\\\"\\r\\n\\t\\t\\t\\t\\t\\t]\\r\\n\\t\\t\\t\\t\\t}\\r\\n\\t\\t},\\r\\n\\t\\t\\\"aggregation\\\": {\\r\\n\\t\\t\\t\\\"totalCost\\\": {\\r\\n\\t\\t\\t\\t\\\"name\\\": \\\"PreTaxCost\\\",\\r\\n\\t\\t\\t\\t\\\"function\\\": \\\"Sum\\\"\\r\\n\\t\\t\\t}\\r\\n\\t\\t},\\r\\n\\t\\t\\\"grouping\\\": [\\r\\n\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\\"type\\\": \\\"Dimension\\\",\\r\\n\\t\\t\\t\\t\\\"name\\\": \\\"ResourceId\\\"\\r\\n\\t\\t\\t}\\r\\n\\t\\t]\\r\\n\\t}\\r\\n}\",\"headers\":[],\"method\":\"POST\",\"path\":\"/subscriptions/{Subscription:id}/providers/Microsoft.CostManagement/query?\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2019-11-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.properties\",\"columns\":[]}}]}",
                        "size": 0,
                        "title": "GetCostAllDisks",
                        "queryType": 12
                      },
                      "conditionalVisibility": {
                        "parameterName": "isVisible",
                        "comparison": "isEqualTo",
                        "value": "true"
                      },
                      "name": "query - GetAllDisksCost"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "resources\r\n| where type =~ 'microsoft.compute/disks'\r\n| extend diskState = tostring(properties.diskState)\r\n| where managedBy == \"\" and diskState != 'ActiveSAS'\r\nor diskState == 'Unattached' and diskState != 'ActiveSAS'\r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| extend DiskID=id, DiskName=name, SKUName=sku.name, SKUTier=sku.tier, DiskSizeGB=tostring(properties.diskSizeGB),DiskRG=resourceGroup, Location=location, TimeCreated=tostring(properties.timeCreated), SubscriptionName=subscriptionId \r\n| project DiskID,DiskName, DiskSizeGB, SKUName, SKUTier, DiskRG,tagName,tagValue, Location, TimeCreated, SubscriptionName\r\n| order by DiskID asc ",
                        "size": 0,
                        "title": "Unattached Disks",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "isVisible",
                        "comparison": "isEqualTo",
                        "value": "true"
                      },
                      "name": "query - GetUnattachedDisks"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\",\"mergeType\":\"innerunique\",\"leftTable\":\"query - GetAllDisksCost\",\"rightTable\":\"query - GetUnattachedDisks\",\"leftColumn\":\"ResourceId\",\"rightColumn\":\"DiskID\"}],\"projectRename\":[{\"originalName\":\"[query - GetUnattachedDisks].DiskID\",\"mergedName\":\"DiskID\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetAllDisksCost].PreTaxCost\",\"mergedName\":\"Last Month Cost\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetAllDisksCost].Currency\",\"mergedName\":\"Currency\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].DiskSizeGB\",\"mergedName\":\"DiskSizeGB\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].DiskRG\",\"mergedName\":\"DiskRG\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - GetUnattachedDisks].Location\",\"mergedName\":\"Location\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].TimeCreated\",\"mergedName\":\"TimeCreated\",\"fromId\":\"890db43d-bfd3-4a7c-94df-e030a0c03093\"},{\"originalName\":\"[query - GetUnattachedDisks].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - GetUnattachedDisks].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - GetAllDisksCost].ResourceId\"},{\"originalName\":\"[query - GetUnattachedDisks].DiskName\"}]}",
                        "size": 0,
                        "title": "Unattached Managed Disks cost",
                        "noDataMessage": "There isn't any unnatached disks!",
                        "noDataMessageStyle": 3,
                        "showExportToExcel": true,
                        "exportToExcelOptions": "all",
                        "queryType": 7
                      },
                      "showPin": false,
                      "name": "query - Unattaached Disks Cost"
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "RG_Filter",
                  "comparison": "isEqualTo",
                  "value": "Tags"
                },
                "name": "group - CostTag"
              }
            ]
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "CostInformation"
          },
          "name": "group - CostInformation"
        },
        {
          "type": 12,
          "content": {
            "version": "NotebookGroup/1.0",
            "groupType": "editable",
            "title": "Azure Hybrid Benefit Overview",
            "items": [
              {
                "type": 1,
                "content": {
                  "json": "# Azure Hybrid Benefit\r\nFor customers with Software Assurance, Azure Hybrid Benefit for Windows Server allows you to use your on-premises Windows Server licenses to run Windows virtual machines on Azure at a reduced cost. This article discusses how to deploy new VMs with Azure Hybrid Benefit for Windows Server enabled, and how you can update any existing running VMs. For more information about Azure Hybrid Benefit for Windows Server licensing and cost savings, see the [Azure Hybrid Benefit for Windows Server licensing page](https://azure.microsoft.com/pricing/hybrid-use-benefit/)\r\n\r\n",
                  "style": "upsell"
                },
                "name": "text - 5"
              },
              {
                "type": 9,
                "content": {
                  "version": "KqlParameterItem/1.0",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "parameters": [
                    {
                      "id": "0c58188b-5c09-45aa-b738-f7122d0e0a19",
                      "version": "KqlParameterItem/1.0",
                      "name": "Location",
                      "type": 2,
                      "description": "Select the region where the VMs are located. Different Regions might have different SKUs",
                      "isRequired": true,
                      "query": "Resources\r\n| where type =~ 'Microsoft.Compute/virtualMachines'\r\n| project name, location\r\n| take 1\r\n| project location\r\n\r\n",
                      "crossComponentResources": [
                        "{Subscription}"
                      ],
                      "typeSettings": {
                        "additionalResourceOptions": [],
                        "showDefault": false
                      },
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources",
                      "value": "uksouth"
                    },
                    {
                      "id": "3ee18b0f-2f7b-4a6a-9d1c-526505c7eea2",
                      "version": "KqlParameterItem/1.0",
                      "name": "SingleSubHidden",
                      "type": 1,
                      "isRequired": true,
                      "query": "resourcecontainers\r\n| where type==\"microsoft.resources/subscriptions\"\r\n| take 1\r\n| project subscriptionId",
                      "crossComponentResources": [
                        "{Subscription}"
                      ],
                      "isHiddenWhenLocked": true,
                      "timeContext": {
                        "durationMs": 86400000
                      },
                      "queryType": 1,
                      "resourceType": "microsoft.resourcegraph/resources"
                    }
                  ],
                  "style": "pills",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                },
                "name": "parameters - 12"
              },
              {
                "type": 3,
                "content": {
                  "version": "KqlItem/1.0",
                  "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{SingleSubHidden}/providers/Microsoft.Compute/skus?$filter=location eq '{Location}'\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2021-07-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*[?(@.resourceType=='virtualMachines')]\",\"columns\":[{\"path\":\"name\",\"columnid\":\"Name\"},{\"path\":\"capabilities[?(@.name=='vCPUs')].value\",\"columnid\":\"vCPUs\"},{\"path\":\"capabilities[?(@.name=='MemoryGB')].value\",\"columnid\":\"MemoryGB\"},{\"path\":\"capabilities[?(@.name=='MaxNetworkInterfaces')].value\",\"columnid\":\"MaxNetworkInterfaces\"},{\"path\":\"capabilities[?(@.name=='HyperVGenerations')].value\",\"columnid\":\"HyperVGenerations\"},{\"path\":\"capabilities[?(@.name=='vCPUsPerCore')].value\",\"columnid\":\"vCPUsPerCore\"}]}}]}",
                  "size": 0,
                  "title": "Get VM vCPU",
                  "exportParameterName": "ResourceSKU",
                  "showExportToExcel": true,
                  "queryType": 12,
                  "gridSettings": {
                    "rowLimit": 5000
                  }
                },
                "conditionalVisibility": {
                  "parameterName": "AlwaysHidden",
                  "comparison": "isEqualTo",
                  "value": "true"
                },
                "name": "API-Get_VM_SKU"
              },
              {
                "type": 11,
                "content": {
                  "version": "LinkItem/1.0",
                  "style": "tabs",
                  "links": [
                    {
                      "id": "3f12a4b6-b18d-4191-8c1c-6045a7edcb6b",
                      "cellValue": "SelectedTab",
                      "linkTarget": "parameter",
                      "linkLabel": "VM/VMSS",
                      "subTarget": "VM",
                      "style": "link"
                    },
                    {
                      "id": "78ac1878-4b69-4f32-af1f-a8f095afbed5",
                      "cellValue": "SelectedTab",
                      "linkTarget": "parameter",
                      "linkLabel": "SQL",
                      "subTarget": "SQL",
                      "style": "link"
                    }
                  ]
                },
                "name": "links - 1"
              },
              {
                "type": 11,
                "content": {
                  "version": "LinkItem/1.0",
                  "style": "tabs",
                  "links": [
                    {
                      "id": "0211f413-9f36-4750-9ef2-d382ba30ba6c",
                      "cellValue": "SelectedSubTab",
                      "linkTarget": "parameter",
                      "linkLabel": "Windows Virtual Machines",
                      "subTarget": "VM",
                      "preText": "VM",
                      "style": "link"
                    },
                    {
                      "id": "dbe9a7fb-6ab1-4de1-a98b-4ec8a9af906c",
                      "cellValue": "SelectedSubTab",
                      "linkTarget": "parameter",
                      "linkLabel": "Linux Virtual Machines",
                      "subTarget": "LinuxVM",
                      "style": "link"
                    },
                    {
                      "id": "79e7a97a-1413-41e8-b4c6-ebd1d0a45e2e",
                      "cellValue": "SelectedSubTab",
                      "linkTarget": "parameter",
                      "linkLabel": "VM Scale Set",
                      "subTarget": "VMSS",
                      "style": "link"
                    }
                  ]
                },
                "conditionalVisibility": {
                  "parameterName": "SelectedTab",
                  "comparison": "isEqualTo",
                  "value": "VM"
                },
                "name": "links - 4"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "title": "Virtual Machines",
                  "items": [
                    {
                      "type": 12,
                      "content": {
                        "version": "NotebookGroup/1.0",
                        "groupType": "editable",
                        "items": [
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\"  | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows' or tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType) == 'Windows'\r\n| where tostring(properties.['licenseType']) !has 'Windows' and tostring(properties.virtualMachineProfile.['licenseType']) !has 'Windows'\r\n| extend WindowsId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.offer), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']), VMSSize=tostring(sku.name)\r\n    ) on subscriptionId \r\n| order by type asc \r\n| project WindowsId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType, subscriptionId",
                              "size": 0,
                              "title": "AHUB Disabled",
                              "noDataMessage": "All of your VMs have AHUB enabled.",
                              "noDataMessageStyle": 3,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "subscriptionId",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  }
                                ]
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "query - 0"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\"  | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows'\r\n| where tostring(properties.['licenseType']) has \"Windows\"\r\n| extend WindowsId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.offer), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']), VMSSize=tostring(sku.name)\r\n) on subscriptionId \r\n| order by type asc \r\n| project WindowsId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType, subscriptionId",
                              "size": 0,
                              "title": "AHUB Enabled",
                              "noDataMessage": "None of your VMs have AHUB enabled.",
                              "noDataMessageStyle": 4,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "subscriptionId",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  }
                                ]
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "WindowsAHUBEnabled"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "resourcechanges\r\n| where properties.changeType == \"Update\" and properties.targetResourceType == \"microsoft.compute/virtualmachines\"\r\n| mv-expand changes = properties.changes\r\n| mv-expand LicenseChanges=changes.['properties.licenseType']\r\n| where isnotnull(LicenseChanges)\r\n| where  tostring(LicenseChanges.newValue) has \"Windows\"\r\n| project VMID=properties.targetResourceId, NewLicense=tostring(LicenseChanges.newValue), DateofChange=todatetime(properties.changeAttributes.timestamp)\r\n",
                              "size": 0,
                              "title": "VM Latest Change Last 7 days",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ]
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "VM Latest Change Last 7 days"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{SingleSubHidden}/providers/Microsoft.Compute/skus?$filter=location eq '{Location}'\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2021-07-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*[?(@.resourceType=='virtualMachines')]\",\"columns\":[{\"path\":\"name\",\"columnid\":\"Name\"},{\"path\":\"capabilities[?(@.name=='vCPUs')].value\",\"columnid\":\"vCPUs\"},{\"path\":\"capabilities[?(@.name=='MemoryGB')].value\",\"columnid\":\"MemoryGB\"},{\"path\":\"capabilities[?(@.name=='MaxNetworkInterfaces')].value\",\"columnid\":\"MaxNetworkInterfaces\"},{\"path\":\"capabilities[?(@.name=='HyperVGenerations')].value\",\"columnid\":\"HyperVGenerations\"},{\"path\":\"capabilities[?(@.name=='vCPUsPerCore')].value\",\"columnid\":\"vCPUsPerCore\"}]}}]}",
                              "size": 0,
                              "title": "Get VM vCPU",
                              "exportParameterName": "ResourceSKU",
                              "showExportToExcel": true,
                              "queryType": 12,
                              "gridSettings": {
                                "rowLimit": 5000
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "query - Get VM vCPU"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "## Windows Azure Hybrid Benefit (AHUB) Overview"
                            },
                            "name": "text - 15 - Copy"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "Each two-processor license or each set of 16-core licenses, either Datacenter or Standard editions, are entitled to two instances of up to 8 cores, or one instance of up to 16 cores.\r\n\r\nThe virtual machines (VMs) with less than 8 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                              "style": "info"
                            },
                            "name": "text - 1",
                            "styleSettings": {
                              "margin": "10px",
                              "showBorder": true
                            }
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\" | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows'\r\n| extend LicenseType = tostring(properties.['licenseType'])\r\n| extend CheckAHUBWindows = case(\r\n     type == 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets', iif((properties.['licenseType'])\r\n     !has 'Windows' and (properties.virtualMachineProfile.['licenseType']) !has 'Windows' , \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not Windows\"\r\n     )\r\n) on subscriptionId \r\n| summarize count() by SubscriptionName, CheckAHUBWindows",
                              "size": 0,
                              "title": "Summary of Windows VMs with or without AHUB per Subscription",
                              "showRefreshButton": true,
                              "showExportToExcel": true,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "visualization": "table",
                              "gridSettings": {
                                "sortBy": [
                                  {
                                    "itemKey": "SubscriptionName",
                                    "sortOrder": 1
                                  }
                                ]
                              },
                              "sortBy": [
                                {
                                  "itemKey": "SubscriptionName",
                                  "sortOrder": 1
                                }
                              ],
                              "tileSettings": {
                                "titleContent": {
                                  "columnMatch": "CheckAHUBWindows",
                                  "formatter": 1
                                },
                                "subtitleContent": {
                                  "columnMatch": "SubscriptionName",
                                  "formatter": 1
                                },
                                "leftContent": {
                                  "columnMatch": "count_",
                                  "formatter": 12,
                                  "formatOptions": {
                                    "palette": "auto"
                                  }
                                },
                                "showBorder": false,
                                "size": "auto"
                              },
                              "chartSettings": {
                                "xAxis": "SubscriptionName"
                              }
                            },
                            "customWidth": "50",
                            "name": "Summary of Windows VMs with or without AHUB"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "resources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows'\r\n| extend LicenseType = tostring(properties.['licenseType'])\r\n| extend CheckAHUBWindows = case(\r\n     type == 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets', iif((properties.['licenseType'])\r\n     !has 'Windows' and (properties.virtualMachineProfile.['licenseType']) !has 'Windows' , \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not Windows\"\r\n     )\r\n| summarize count() by CheckAHUBWindows",
                              "size": 0,
                              "title": "Summary of Windows VMs with or without AHUB",
                              "showRefreshButton": true,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "visualization": "piechart"
                            },
                            "customWidth": "50",
                            "name": "Summary of Windows VMs with or without AHUB"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "### Consumed Licenses\r\nTotal number of Windows licenses cores consumed by all Windows virtual machines.\r\n",
                              "style": "info"
                            },
                            "customWidth": "50",
                            "name": "text - 15"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "### Number of required Cores to enable Windows Azure Hybrid Benefit\r\nNumber of cores required to enable AHUB across the entire environment.",
                              "style": "info"
                            },
                            "customWidth": "50",
                            "name": "text - 15 - Copy"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"WindowsAHUBEnabled\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[WindowsAHUBEnabled].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"vCPUs\\\"]\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"}]}",
                              "size": 0,
                              "title": "Consumed Cores per AHUB Priority",
                              "noDataMessage": "None of your VMs have AHUB enabled",
                              "noDataMessageStyle": 4,
                              "showRefreshButton": true,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "Sev4",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal"
                                      }
                                    }
                                  }
                                ]
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "Consumed Cores per VM"
                                ],
                                "group": "Prioritize AHUB?",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "name": "Consumed Cores per AHUB Priority"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26130\",\"mergeType\":\"inner\",\"leftTable\":\"WindowsAHUBEnabled\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"ConsumedCores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"vCPUs\\\"]\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"}]}",
                              "size": 0,
                              "title": "Consumed Cores per VM",
                              "showRefreshButton": true,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "ConsumedCores",
                                    "formatter": 0,
                                    "formatOptions": {
                                      "aggregation": "Sum"
                                    }
                                  }
                                ]
                              },
                              "tileSettings": {
                                "titleContent": {},
                                "leftContent": {
                                  "columnMatch": "ConsumedCores",
                                  "formatter": 12,
                                  "formatOptions": {
                                    "palette": "blue"
                                  }
                                },
                                "showBorder": false
                              },
                              "graphSettings": {
                                "type": 0
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "ConsumedCores"
                                ],
                                "group": "VMName",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "name": "Consumed Cores per VM"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"query - 0\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"[\\\"vCPUs\\\"]\"}}]},{\"originalName\":\"[query - 0].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"}]}",
                              "size": 0,
                              "title": "Cores not enabled per AHUB Priority",
                              "noDataMessage": "All of your VMs have AHUB enabled",
                              "noDataMessageStyle": 4,
                              "showRefreshButton": true,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "Sev4",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal"
                                      }
                                    }
                                  }
                                ]
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "Consumed Cores per VM"
                                ],
                                "group": "Prioritize AHUB?",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "name": "Cores NOT enabled per AHUB Priority"
                          },
                          {
                            "type": 9,
                            "content": {
                              "version": "KqlParameterItem/1.0",
                              "parameters": [
                                {
                                  "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "AHUBEnabled",
                                  "label": "See VMs with AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                                  "timeContext": {
                                    "durationMs": 86400000
                                  }
                                },
                                {
                                  "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "AHUBDisabled",
                                  "label": "See VMs without AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n"
                                },
                                {
                                  "id": "20a00706-a89b-42aa-8dea-9c44c93e8014",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "LastAHUB",
                                  "label": "See VMs AHUB enabled in the last 7 days",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n"
                                }
                              ],
                              "style": "pills",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            "name": "parameters - 13"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "List of Windows VMs without Hybrid Benefit groupped by Subscription.",
                              "style": "info"
                            },
                            "conditionalVisibility": {
                              "parameterName": "AHUBDisabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "name": "text - 18"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"query - 0\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[query - 0].WindowsId\",\"mergedName\":\"VM Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMRG\",\"mergedName\":\"Resource Group\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMSize\",\"mergedName\":\"SKU\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"static\",\"resultVal\":\"High Priority\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"Low Priority\"}}]},{\"originalName\":\"[query - 0].LicenseType\",\"mergedName\":\"License Type\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMLocation\",\"mergedName\":\"Location\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].OSType\",\"mergedName\":\"OS Type\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].OsVersion\",\"mergedName\":\"OS Version\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 0].VMName\"},{\"originalName\":\"[query - 0].VMSSize\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"}]}",
                              "size": 0,
                              "title": "VMs without AHUB",
                              "noDataMessage": "All of your VMs have AHUB enabled",
                              "noDataMessageStyle": 3,
                              "showExportToExcel": true,
                              "queryType": 7,
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "$gen_group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "Sev4",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal"
                                      }
                                    }
                                  }
                                ],
                                "hierarchySettings": {
                                  "treeType": 1,
                                  "groupBy": [
                                    "subscriptionId"
                                  ],
                                  "expandTopLevel": true
                                }
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "AHUBDisabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "name": "VM+SKU+vCores"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "List of Windows VMs with Hybrid Benefit groupped by Subscription.",
                              "style": "info"
                            },
                            "conditionalVisibility": {
                              "parameterName": "AHUBEnabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "name": "text - 19"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"WindowsAHUBEnabled\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\",\"mergedName\":\"VM Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\",\"mergedName\":\"Resource Group\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSize\",\"mergedName\":\"VM SKU\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"static\",\"resultVal\":\"High Priority\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"Low Priority\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\",\"mergedName\":\"License Type\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\",\"mergedName\":\"Location\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\",\"mergedName\":\"OS Type\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\",\"mergedName\":\"OS Version\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 0].VMName\"},{\"originalName\":\"[query - 0].VMSSize\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"},{\"originalName\":\"[WindowsAHUBEnabled].VMName\"}]}",
                              "size": 0,
                              "title": "VMs with AHUB",
                              "noDataMessage": "None of your VMs have AHUB enabled",
                              "noDataMessageStyle": 4,
                              "showExportToExcel": true,
                              "queryType": 7,
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "$gen_group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "2",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal"
                                      }
                                    }
                                  },
                                  {
                                    "columnMatch": "subscriptionId",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Subscription Name",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  }
                                ],
                                "hierarchySettings": {
                                  "treeType": 1,
                                  "groupBy": [
                                    "subscriptionId"
                                  ],
                                  "expandTopLevel": true
                                }
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "AHUBEnabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "name": "VM+SKU+vCores-AHUB"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26168\",\"mergeType\":\"inner\",\"leftTable\":\"VM Latest Change Last 7 days\",\"rightTable\":\"VM+SKU+vCores-AHUB\",\"leftColumn\":\"VMID\",\"rightColumn\":\"VM Name\"}],\"projectRename\":[{\"originalName\":\"[VM Latest Change Last 7 days].VMID\",\"mergedName\":\"VMID\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days].NewLicense\",\"mergedName\":\"NewLicense\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days].DateofChange\",\"mergedName\":\"DateofChange\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].VM Name\",\"mergedName\":\"VM Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].Resource Group\",\"mergedName\":\"Resource Group\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].VM SKU\",\"mergedName\":\"VM SKU\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].Prioritize AHUB?\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].License Type\",\"mergedName\":\"License Type\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].Consumed Cores per VM\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].Location\",\"mergedName\":\"Location\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].OS Type\",\"mergedName\":\"OS Type\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].OS Version\",\"mergedName\":\"OS Version\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"}]}",
                              "size": 0,
                              "title": "Total Cores Enabled last 7 Days",
                              "noDataMessage": "Windows AHUB hasn't been enabled in the last 7 days",
                              "showRefreshButton": true,
                              "queryType": 7,
                              "visualization": "barchart",
                              "tileSettings": {
                                "showBorder": false,
                                "titleContent": {
                                  "columnMatch": "NewLicense",
                                  "formatter": 1
                                },
                                "leftContent": {
                                  "columnMatch": "vCPUs",
                                  "formatter": 12,
                                  "formatOptions": {
                                    "palette": "auto"
                                  },
                                  "numberFormat": {
                                    "unit": 17,
                                    "options": {
                                      "maximumSignificantDigits": 3,
                                      "maximumFractionDigits": 2
                                    }
                                  }
                                }
                              },
                              "chartSettings": {
                                "xAxis": "VM Name",
                                "yAxis": [
                                  "Consumed Cores per VM"
                                ],
                                "group": null,
                                "createOtherGroup": 0,
                                "seriesLabelSettings": [
                                  {
                                    "seriesName": "Consumed Cores per VM",
                                    "color": "grayBlue"
                                  }
                                ]
                              }
                            },
                            "name": "Total Cores Enabled last 7 Days"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26168\",\"mergeType\":\"inner\",\"leftTable\":\"VM Latest Change Last 7 days\",\"rightTable\":\"VM+SKU+vCores-AHUB\",\"leftColumn\":\"VMID\",\"rightColumn\":\"VM Name\"}],\"projectRename\":[{\"originalName\":\"[VM+SKU+vCores-AHUB].VM Name\",\"mergedName\":\"VM Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].Resource Group\",\"mergedName\":\"Resource Group\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days].NewLicense\",\"mergedName\":\"NewLicense\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days].DateofChange\",\"mergedName\":\"DateofChange\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].VM SKU\",\"mergedName\":\"VM SKU\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].Consumed Cores per VM\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].Prioritize AHUB?\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].Location\",\"mergedName\":\"Location\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VM Latest Change Last 7 days].VMID\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].OS Type\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].OS Version\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].License Type\"}]}",
                              "size": 0,
                              "title": "Total Cores Enabled last 7 Days - Detailed view",
                              "noDataMessage": "No AHUB has been enabled in the last 7 days",
                              "showExportToExcel": true,
                              "queryType": 7,
                              "visualization": "table",
                              "tileSettings": {
                                "showBorder": false,
                                "titleContent": {
                                  "columnMatch": "NewLicense",
                                  "formatter": 1
                                },
                                "leftContent": {
                                  "columnMatch": "vCPUs",
                                  "formatter": 12,
                                  "formatOptions": {
                                    "palette": "auto"
                                  },
                                  "numberFormat": {
                                    "unit": 17,
                                    "options": {
                                      "maximumSignificantDigits": 3,
                                      "maximumFractionDigits": 2
                                    }
                                  }
                                }
                              },
                              "chartSettings": {
                                "xAxis": "VM Name",
                                "yAxis": [
                                  "Consumed Cores per VM"
                                ],
                                "group": null,
                                "createOtherGroup": 0,
                                "seriesLabelSettings": [
                                  {
                                    "seriesName": "Consumed Cores per VM",
                                    "color": "grayBlue"
                                  }
                                ]
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "LastAHUB",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "showPin": false,
                            "name": "Total Cores Enabled last 7 Days - Details"
                          }
                        ]
                      },
                      "name": "VM"
                    }
                  ]
                },
                "conditionalVisibilities": [
                  {
                    "parameterName": "SelectedTab",
                    "comparison": "isEqualTo",
                    "value": "VM"
                  },
                  {
                    "parameterName": "SelectedSubTab",
                    "comparison": "isEqualTo",
                    "value": "VM"
                  },
                  {
                    "parameterName": "RG_Filter",
                    "comparison": "isEqualTo",
                    "value": "Resource Group"
                  }
                ],
                "name": "VM/VMSS-RGFilter"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "title": "Virtual Machines",
                  "items": [
                    {
                      "type": 12,
                      "content": {
                        "version": "NotebookGroup/1.0",
                        "groupType": "editable",
                        "items": [
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows' or tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType) == 'Windows'\r\n| where tostring(properties.['licenseType']) !has 'Windows' and tostring(properties.virtualMachineProfile.['licenseType']) !has 'Windows'\r\n| extend WindowsId=id, VMName=name,tagName,tagValue, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.offer), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']), VMSSize=tostring(sku.name)\r\n    ) on subscriptionId \r\n| order by type asc \r\n| project WindowsId,VMName,VMRG,tagName,tagValue,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType, subscriptionId",
                              "size": 0,
                              "title": "AHUB Disabled",
                              "noDataMessage": "All of your VMs have AHUB enabled.",
                              "noDataMessageStyle": 3,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "subscriptionId",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  }
                                ]
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "AHUBDisabled-TagFilter"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows'\r\n| where tostring(properties.['licenseType']) has \"Windows\"\r\n| extend WindowsId=id, VMName=name,tagName,tagValue, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.offer), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']), VMSSize=tostring(sku.name)\r\n) on subscriptionId \r\n| order by type asc \r\n| project WindowsId,VMName,VMRG, tagName,tagValue,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType, subscriptionId",
                              "size": 0,
                              "title": "AHUB Enabled",
                              "noDataMessage": "None of your VMs have AHUB enabled.",
                              "noDataMessageStyle": 4,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "subscriptionId",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  }
                                ]
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "WindowsAHUBEnabledTagFilter"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "resourcechanges\r\n| where properties.changeType == \"Update\" and properties.targetResourceType == \"microsoft.compute/virtualmachines\"\r\n| mv-expand changes = properties.changes\r\n| mv-expand LicenseChanges=changes.['properties.licenseType']\r\n| where isnotnull(LicenseChanges)\r\n| where  tostring(LicenseChanges.newValue) has \"Windows\"\r\n| project VMID=properties.targetResourceId, NewLicense=tostring(LicenseChanges.newValue), DateofChange=todatetime(properties.changeAttributes.timestamp)\r\n",
                              "size": 0,
                              "title": "VM Latest Change Last 7 days",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ]
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "VM Latest Change Last 7 days-TagFilter"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{SingleSubHidden}/providers/Microsoft.Compute/skus?$filter=location eq '{Location}'\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2021-07-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*[?(@.resourceType=='virtualMachines')]\",\"columns\":[{\"path\":\"name\",\"columnid\":\"Name\"},{\"path\":\"capabilities[?(@.name=='vCPUs')].value\",\"columnid\":\"vCPUs\"},{\"path\":\"capabilities[?(@.name=='MemoryGB')].value\",\"columnid\":\"MemoryGB\"},{\"path\":\"capabilities[?(@.name=='MaxNetworkInterfaces')].value\",\"columnid\":\"MaxNetworkInterfaces\"},{\"path\":\"capabilities[?(@.name=='HyperVGenerations')].value\",\"columnid\":\"HyperVGenerations\"},{\"path\":\"capabilities[?(@.name=='vCPUsPerCore')].value\",\"columnid\":\"vCPUsPerCore\"}]}}]}",
                              "size": 0,
                              "title": "Get VM vCPU",
                              "exportParameterName": "ResourceSKU",
                              "showExportToExcel": true,
                              "queryType": 12,
                              "gridSettings": {
                                "rowLimit": 5000
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "query - Get VM vCPU"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "## Windows Azure Hybrid Benefit (AHUB) Overview"
                            },
                            "name": "text - 15 - Copy"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "Each two-processor license or each set of 16-core licenses, either Datacenter or Standard editions, are entitled to two instances of up to 8 cores, or one instance of up to 16 cores.\r\n\r\nThe virtual machines (VMs) with less than 8 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                              "style": "info"
                            },
                            "name": "text - 1",
                            "styleSettings": {
                              "margin": "10px",
                              "showBorder": true
                            }
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows'\r\n| extend LicenseType = tostring(properties.['licenseType'])\r\n| extend CheckAHUBWindows = case(\r\n     type == 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets', iif((properties.['licenseType'])\r\n     !has 'Windows' and (properties.virtualMachineProfile.['licenseType']) !has 'Windows' , \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not Windows\"\r\n     )\r\n) on subscriptionId \r\n| summarize count() by SubscriptionName, CheckAHUBWindows",
                              "size": 0,
                              "title": "Summary of Windows VMs with or without AHUB per Subscription",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "visualization": "tiles",
                              "tileSettings": {
                                "titleContent": {
                                  "columnMatch": "CheckAHUBWindows",
                                  "formatter": 1
                                },
                                "subtitleContent": {
                                  "columnMatch": "SubscriptionName",
                                  "formatter": 1
                                },
                                "leftContent": {
                                  "columnMatch": "count_",
                                  "formatter": 12,
                                  "formatOptions": {
                                    "palette": "auto"
                                  }
                                },
                                "showBorder": false,
                                "size": "auto"
                              },
                              "chartSettings": {
                                "xAxis": "SubscriptionName"
                              }
                            },
                            "customWidth": "50",
                            "name": "Summary of Windows VMs with or without AHUB"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualmachines'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows'\r\n| extend LicenseType = tostring(properties.['licenseType'])\r\n| extend CheckAHUBWindows = case(\r\n     type == 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets', iif((properties.['licenseType'])\r\n     !has 'Windows' and (properties.virtualMachineProfile.['licenseType']) !has 'Windows' , \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not Windows\"\r\n     )\r\n| summarize count() by CheckAHUBWindows",
                              "size": 0,
                              "title": "Summary of Windows VMs with or without AHUB",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "visualization": "piechart"
                            },
                            "customWidth": "50",
                            "name": "Summary of Windows VMs with or without AHUB"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "### Consumed Licenses\r\nTotal number of Windows licenses cores consumed by all Windows virtual machines.\r\n",
                              "style": "info"
                            },
                            "customWidth": "50",
                            "name": "Consumed Licenses-TagFilter"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "### Number of required Cores to enable Windows Azure Hybrid Benefit\r\nNumber of cores required to enable AHUB across the entire environment.",
                              "style": "info"
                            },
                            "customWidth": "50",
                            "name": "Number of required Cores to enable Windows Azure Hybrid Benefit-TagFilter"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"WindowsAHUBEnabledTagFilter\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\" ([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"}]}",
                              "size": 0,
                              "title": "Consumed Cores per AHUB Priority",
                              "noDataMessage": "None of your VMs have AHUB enabled",
                              "noDataMessageStyle": 4,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "Sev4",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal"
                                      }
                                    }
                                  }
                                ]
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "Consumed Cores per VM"
                                ],
                                "group": "Prioritize AHUB?",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "name": "Consumed Cores per AHUB Priority-TagFilter"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26130\",\"mergeType\":\"inner\",\"leftTable\":\"WindowsAHUBEnabledTagFilter\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"ConsumedCores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"}]}",
                              "size": 0,
                              "title": "Consumed Cores per VM",
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "ConsumedCores",
                                    "formatter": 0,
                                    "formatOptions": {
                                      "aggregation": "Sum"
                                    }
                                  }
                                ]
                              },
                              "tileSettings": {
                                "titleContent": {},
                                "leftContent": {
                                  "columnMatch": "ConsumedCores",
                                  "formatter": 12,
                                  "formatOptions": {
                                    "palette": "blue"
                                  }
                                },
                                "showBorder": false
                              },
                              "graphSettings": {
                                "type": 0
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "ConsumedCores"
                                ],
                                "group": "VMName",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "name": "Consumed Cores per VM-TagFilter"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"AHUBDisabled-TagFilter\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\" ([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 0].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 0].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"unknown\"},{\"originalName\":\"[AHUBDisabled-TagFilter].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"}]}",
                              "size": 0,
                              "title": "Cores not enabled per AHUB Priority",
                              "noDataMessage": "All of your VMs have AHUB enabled",
                              "noDataMessageStyle": 4,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "Sev4",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal"
                                      }
                                    }
                                  }
                                ]
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "Consumed Cores per VM"
                                ],
                                "group": "Prioritize AHUB?",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "name": "Cores NOT enabled per AHUB Priority-TagFilter"
                          },
                          {
                            "type": 9,
                            "content": {
                              "version": "KqlParameterItem/1.0",
                              "parameters": [
                                {
                                  "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "AHUBEnabled",
                                  "label": "See VMs with AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                                  "timeContext": {
                                    "durationMs": 86400000
                                  },
                                  "value": "Yes"
                                },
                                {
                                  "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "AHUBDisabled",
                                  "label": "See VMs without AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                                  "value": "Yes"
                                },
                                {
                                  "id": "20a00706-a89b-42aa-8dea-9c44c93e8014",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "LastAHUB",
                                  "label": "See VMs AHUB enabled in the last 7 days",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                                  "value": "Yes"
                                }
                              ],
                              "style": "pills",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            "name": "parameters - 13"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "List of Windows VMs without Hybrid Benefit groupped by Subscription.",
                              "style": "info"
                            },
                            "conditionalVisibility": {
                              "parameterName": "AHUBDisabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "name": "List of Windows VMs without Hybrid Benefit-TagFilter"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"AHUBDisabled-TagFilter\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"static\",\"resultVal\":\"High Priority\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"Low Priority\"}}]},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[AHUBDisabled-TagFilter].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[AHUBDisabled-TagFilter].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMName\"},{\"originalName\":\"[query - 0].VMSSize\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"}]}",
                              "size": 0,
                              "title": "VMs without AHUB",
                              "noDataMessage": "All of your VMs have AHUB enabled",
                              "noDataMessageStyle": 3,
                              "showExportToExcel": true,
                              "queryType": 7,
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "$gen_group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "Sev4",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal"
                                      }
                                    }
                                  }
                                ],
                                "hierarchySettings": {
                                  "treeType": 1,
                                  "groupBy": [
                                    "subscriptionId"
                                  ],
                                  "expandTopLevel": true
                                }
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "AHUBDisabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "name": "VM+SKU+vCores-AHUBDisabled-TagFilter"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "List of Windows VMs with Hybrid Benefit groupped by Subscription.",
                              "style": "info"
                            },
                            "conditionalVisibility": {
                              "parameterName": "AHUBEnabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "name": "text - 19"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"WindowsAHUBEnabledTagFilter\",\"rightTable\":\"query - Get VM vCPU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[WindowsAHUBEnabledTagFilter].WindowsId\",\"mergedName\":\"VM Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"static\",\"resultVal\":\"High Priority\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"Low Priority\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMName\"},{\"originalName\":\"[query - 0].VMSSize\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"},{\"originalName\":\"[WindowsAHUBEnabled].VMName\"}]}",
                              "size": 0,
                              "title": "VMs with AHUB",
                              "noDataMessage": "None of your VMs have AHUB enabled",
                              "noDataMessageStyle": 4,
                              "showExportToExcel": true,
                              "queryType": 7,
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "$gen_group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "2",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal"
                                      }
                                    }
                                  },
                                  {
                                    "columnMatch": "subscriptionId",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Subscription Name",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  }
                                ],
                                "hierarchySettings": {
                                  "treeType": 1,
                                  "groupBy": [
                                    "subscriptionId"
                                  ],
                                  "expandTopLevel": true
                                }
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "AHUBEnabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "name": "VM+SKU+vCores-AHUB-TagFilter"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26168\",\"mergeType\":\"inner\",\"leftTable\":\"VM Latest Change Last 7 days-TagFilter\",\"rightTable\":\"WindowsAHUBEnabledTagFilter\",\"leftColumn\":\"VMID\",\"rightColumn\":\"VMName\"}],\"projectRename\":[{\"originalName\":\"[VM+SKU+vCores-AHUB].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VM Latest Change Last 7 days-TagFilter].VMID\",\"mergedName\":\"VMID\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days-TagFilter].NewLicense\",\"mergedName\":\"NewLicense\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days-TagFilter].DateofChange\",\"mergedName\":\"DateofChange\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[WindowsAHUBEnabledTagFilter].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"}]}",
                              "size": 0,
                              "title": "Total Cores Enabled last 7 Days",
                              "noDataMessage": "Windows AHUB hasn't been enabled in the last 7 days",
                              "queryType": 7,
                              "visualization": "barchart",
                              "tileSettings": {
                                "showBorder": false,
                                "titleContent": {
                                  "columnMatch": "NewLicense",
                                  "formatter": 1
                                },
                                "leftContent": {
                                  "columnMatch": "vCPUs",
                                  "formatter": 12,
                                  "formatOptions": {
                                    "palette": "auto"
                                  },
                                  "numberFormat": {
                                    "unit": 17,
                                    "options": {
                                      "maximumSignificantDigits": 3,
                                      "maximumFractionDigits": 2
                                    }
                                  }
                                }
                              },
                              "chartSettings": {
                                "xAxis": "VM Name",
                                "yAxis": [
                                  "Consumed Cores per VM"
                                ],
                                "group": null,
                                "createOtherGroup": 0,
                                "seriesLabelSettings": [
                                  {
                                    "seriesName": "Consumed Cores per VM",
                                    "color": "grayBlue"
                                  }
                                ]
                              }
                            },
                            "name": "Total Cores Enabled last 7 Days"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26168\",\"mergeType\":\"inner\",\"leftTable\":\"VM Latest Change Last 7 days-TagFilter\",\"rightTable\":\"VM+SKU+vCores-AHUB-TagFilter\",\"leftColumn\":\"VMID\",\"rightColumn\":\"VM Name\"}],\"projectRename\":[{\"originalName\":\"[VM+SKU+vCores-AHUB].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VM Latest Change Last 7 days-TagFilter].VMID\",\"mergedName\":\"VMID\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days-TagFilter].NewLicense\",\"mergedName\":\"NewLicense\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days-TagFilter].DateofChange\",\"mergedName\":\"DateofChange\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].VM Name\",\"mergedName\":\"VM Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].Prioritize AHUB?\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].Consumed Cores per VM\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].tagName\",\"mergedName\":\"tagName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].tagValue\",\"mergedName\":\"tagValue\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].Name\",\"mergedName\":\"Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM+SKU+vCores-AHUB-TagFilter].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[VM Latest Change Last 7 days].VMID\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].OS Type\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].OS Version\"},{\"originalName\":\"[VM+SKU+vCores-AHUB].License Type\"}]}",
                              "size": 0,
                              "title": "Total Cores Enabled last 7 Days - Detailed view",
                              "noDataMessage": "No AHUB has been enabled in the last 7 days",
                              "showExportToExcel": true,
                              "queryType": 7,
                              "visualization": "table",
                              "tileSettings": {
                                "showBorder": false,
                                "titleContent": {
                                  "columnMatch": "NewLicense",
                                  "formatter": 1
                                },
                                "leftContent": {
                                  "columnMatch": "vCPUs",
                                  "formatter": 12,
                                  "formatOptions": {
                                    "palette": "auto"
                                  },
                                  "numberFormat": {
                                    "unit": 17,
                                    "options": {
                                      "maximumSignificantDigits": 3,
                                      "maximumFractionDigits": 2
                                    }
                                  }
                                }
                              },
                              "chartSettings": {
                                "xAxis": "VM Name",
                                "yAxis": [
                                  "Consumed Cores per VM"
                                ],
                                "group": null,
                                "createOtherGroup": 0,
                                "seriesLabelSettings": [
                                  {
                                    "seriesName": "Consumed Cores per VM",
                                    "color": "grayBlue"
                                  }
                                ]
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "LastAHUB",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "showPin": false,
                            "name": "Total Cores Enabled last 7 Days - Details"
                          }
                        ]
                      },
                      "name": "VM"
                    }
                  ]
                },
                "conditionalVisibilities": [
                  {
                    "parameterName": "SelectedTab",
                    "comparison": "isEqualTo",
                    "value": "VM"
                  },
                  {
                    "parameterName": "SelectedSubTab",
                    "comparison": "isEqualTo",
                    "value": "VM"
                  },
                  {
                    "parameterName": "RG_Filter",
                    "comparison": "isEqualTo",
                    "value": "Tags"
                  }
                ],
                "name": "VM/VMSS-TagsFilter"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "title": "SQL Overview",
                  "items": [
                    {
                      "type": 11,
                      "content": {
                        "version": "LinkItem/1.0",
                        "style": "tabs",
                        "links": [
                          {
                            "id": "0211f413-9f36-4750-9ef2-d382ba30ba6c",
                            "cellValue": "SelectedSubTab",
                            "linkTarget": "parameter",
                            "linkLabel": "SQL Server VMs",
                            "subTarget": "SQLVM",
                            "preText": "VM",
                            "style": "link"
                          },
                          {
                            "id": "79e7a97a-1413-41e8-b4c6-ebd1d0a45e2e",
                            "cellValue": "SelectedSubTab",
                            "linkTarget": "parameter",
                            "linkLabel": "SQL DB",
                            "subTarget": "SQLDB",
                            "style": "link"
                          },
                          {
                            "id": "1f381e5b-7071-41ce-a354-c2df93445cae",
                            "cellValue": "SelectedSubTab",
                            "linkTarget": "parameter",
                            "linkLabel": "SQL Managed Instances",
                            "subTarget": "SQLMI",
                            "style": "link"
                          }
                        ]
                      },
                      "name": "links - 4"
                    },
                    {
                      "type": 12,
                      "content": {
                        "version": "NotebookGroup/1.0",
                        "groupType": "editable",
                        "items": [
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\" | extend SubscriptionName=name \r\n| join (\r\n     resources | where type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines' and tostring(properties.['sqlServerLicenseType']) != 'AHUB' and resourceGroup in ({ResourceGroup})\r\n    | extend SQLID=id, VMName = name, VMRG = resourceGroup, VMLocation = location, LicenseType = tostring(properties.['sqlServerLicenseType']), OSType=tostring(properties.storageProfile.imageReference.offer), SQLAgentType = tostring(properties.['sqlManagement']), SQLVersion = tostring(properties.['sqlImageOffer']), SQLSKU=tostring(properties.['sqlImageSku'])\r\n    ) on subscriptionId \r\n| join (\r\n    resources\r\n    | where type =~ 'Microsoft.Compute/virtualmachines'\r\n    | project VMName = tolower(name), VMSize = tostring(properties.hardwareProfile.vmSize)\r\n    ) on VMName\r\n| order by id asc    \r\n| project SQLID,VMName,VMRG, VMLocation, VMSize, SQLVersion, SQLSKU, SQLAgentType, LicenseType, SubscriptionName\r\n| where SQLSKU != \"Developer\" and SQLSKU != \"Express\"",
                              "size": 0,
                              "title": "SQL VM AHUB Disabled",
                              "noDataMessage": "All of your VMs have AHUB enabled.",
                              "noDataMessageStyle": 3,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ]
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "Get-SQL-AHUB-Disabled"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\" | extend SubscriptionName=name \r\n| join (\r\n     resources | where type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines' and tostring(properties.['sqlServerLicenseType']) == 'AHUB' and resourceGroup in ({ResourceGroup})\r\n    | extend SQLID=id, VMName = name, VMRG = resourceGroup, VMLocation = location, LicenseType = tostring(properties.['sqlServerLicenseType']), OSType=tostring(properties.storageProfile.imageReference.offer), SQLAgentType = tostring(properties.['sqlManagement']), SQLVersion = tostring(properties.['sqlImageOffer']), SQLSKU=tostring(properties.['sqlImageSku'])\r\n    ) on subscriptionId \r\n| join (\r\n    resources\r\n    | where type =~ 'Microsoft.Compute/virtualmachines'\r\n    | project VMName = tolower(name), VMSize = tostring(properties.hardwareProfile.vmSize)\r\n    ) on VMName\r\n| order by id asc    \r\n| project SQLID,VMName,VMRG, VMLocation, VMSize, SQLVersion, SQLSKU, SQLAgentType, LicenseType, SubscriptionName\r\n| where SQLSKU != \"Developer\" and SQLSKU != \"Express\"",
                              "size": 0,
                              "title": "SQL VM AHUB Enabled",
                              "noDataMessage": "None of your VMs have AHUB enabled.",
                              "noDataMessageStyle": 5,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ]
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "Get-SQL-AHUB-Enabled"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "## SQL Virtual Machines Azure Hybrid Benefit (AHUB) Overview"
                            },
                            "name": "SQL Text"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "Apply to SQL Server 1 to 4 vCPUs exchange: For every 1 core of SQL Server Enterprise Edition, you get 4 vCPUs of SQL Managed Instance or Azure SQL Database general purpose and Hyperscale tiers, or 4 vCPUs of SQL Server Standard edition on Azure VMs.\r\n\r\nThe SQL virtual machines (VMs) with less than 4 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                              "style": "info"
                            },
                            "name": "SQL License Info",
                            "styleSettings": {
                              "margin": "10px",
                              "showBorder": true
                            }
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "### AHUB Overview\r\nSummary of all SQL on VMs with and without SQL AHUB.",
                              "style": "info"
                            },
                            "name": "text - 15"
                          },
                          {
                            "type": 12,
                            "content": {
                              "version": "NotebookGroup/1.0",
                              "groupType": "editable",
                              "loadType": "explicit",
                              "loadButtonText": "Load SQL Info",
                              "items": [
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\" | extend SubscriptionName=name \r\n| join (\r\n    resources | where type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines' and resourceGroup in ({ResourceGroup})\r\n    | extend SQLID=id, VMName = name, VMRG = resourceGroup, VMLocation = location, LicenseType = tostring(properties.['sqlServerLicenseType']), OSType=tostring(properties.storageProfile.imageReference.offer), SQLAgentType = tostring(properties.['sqlManagement']), SQLVersion = tostring(properties.['sqlImageOffer']), SQLSKU=tostring(properties.['sqlImageSku'])\r\n    | where SQLSKU != \"Developer\" and SQLSKU != \"Express\"\r\n    | extend CheckSQLVMAHUB = case(\r\n     type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines', iif((properties.['sqlServerLicenseType'])\r\n     !has 'AHUB', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not SQL\"\r\n     )\r\n    ) on subscriptionId \r\n| summarize count() by SubscriptionName, CheckSQLVMAHUB",
                                    "size": 0,
                                    "title": "Summary of SQL on VMs with or without AHUB per Subscription",
                                    "showRefreshButton": true,
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources",
                                    "crossComponentResources": [
                                      "{Subscription}"
                                    ],
                                    "visualization": "table",
                                    "gridSettings": {
                                      "formatters": [
                                        {
                                          "columnMatch": "Prioritize AHUB?",
                                          "formatter": 18,
                                          "formatOptions": {
                                            "thresholdsOptions": "icons",
                                            "thresholdsGrid": [
                                              {
                                                "operator": "==",
                                                "thresholdValue": "High Priority",
                                                "representation": "Sev0",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "==",
                                                "thresholdValue": "Low Priority",
                                                "representation": "2",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "Default",
                                                "thresholdValue": null,
                                                "representation": "unknown",
                                                "text": "{0}{1}"
                                              }
                                            ]
                                          }
                                        }
                                      ]
                                    },
                                    "tileSettings": {
                                      "titleContent": {
                                        "columnMatch": "CheckSQLVMAHUB",
                                        "formatter": 1
                                      },
                                      "subtitleContent": {
                                        "columnMatch": "SubscriptionName",
                                        "formatter": 1
                                      },
                                      "leftContent": {
                                        "columnMatch": "count_",
                                        "formatter": 12,
                                        "formatOptions": {
                                          "palette": "auto"
                                        }
                                      },
                                      "showBorder": false,
                                      "size": "auto"
                                    },
                                    "chartSettings": {
                                      "xAxis": "SubscriptionName"
                                    }
                                  },
                                  "customWidth": "50",
                                  "name": "Summary of SQL on VMs with or without AHUB"
                                },
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\"  | extend SubscriptionName=name \r\n| join (\r\n    resources | where type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines' and resourceGroup in ({ResourceGroup})\r\n    | extend SQLID=id, VMName = name, VMRG = resourceGroup, VMLocation = location, LicenseType = tostring(properties.['sqlServerLicenseType']), OSType=tostring(properties.storageProfile.imageReference.offer), SQLAgentType = tostring(properties.['sqlManagement']), SQLVersion = tostring(properties.['sqlImageOffer']), SQLSKU=tostring(properties.['sqlImageSku'])\r\n    | extend CheckSQLVMAHUB = case(\r\n     type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines', iif((properties.['sqlServerLicenseType'])\r\n     !has 'AHUB', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not SQL\"\r\n     )\r\n    ) on subscriptionId \r\n| summarize count() by CheckSQLVMAHUB",
                                    "size": 0,
                                    "title": "Summary SQL Enabled and Disabled",
                                    "noDataMessage": "You don't have any SQL VM",
                                    "showRefreshButton": true,
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources",
                                    "crossComponentResources": [
                                      "{Subscription}"
                                    ],
                                    "visualization": "piechart"
                                  },
                                  "customWidth": "50",
                                  "name": "Summary SQL Enabled and Disabled"
                                },
                                {
                                  "type": 1,
                                  "content": {
                                    "json": "### Consumed Licenses\r\nTotal number of SQL licenses cores consumed by all SQL running on Virtual Machines.\r\n",
                                    "style": "info"
                                  },
                                  "customWidth": "50",
                                  "name": "text - 15"
                                },
                                {
                                  "type": 1,
                                  "content": {
                                    "json": "### Number of required Cores to enable SQL Azure Hybrid Benefit\r\nNumber of cores required to enable SQL AHUB across the entire environment.\r\n\r\n\r\n",
                                    "style": "info"
                                  },
                                  "customWidth": "50",
                                  "name": "text - 15 - Copy"
                                },
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640e8\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Enabled\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLID\",\"mergedName\":\"SQLID\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"}]}",
                                    "size": 0,
                                    "title": "SQL VM AHUB Consumed Cores per VM",
                                    "noDataMessage": "None of your VMs have AHUB enabled.",
                                    "noDataMessageStyle": 4,
                                    "showRefreshButton": true,
                                    "queryType": 7,
                                    "visualization": "piechart",
                                    "gridSettings": {
                                      "formatters": [
                                        {
                                          "columnMatch": "Prioritize AHUB?",
                                          "formatter": 18,
                                          "formatOptions": {
                                            "thresholdsOptions": "icons",
                                            "thresholdsGrid": [
                                              {
                                                "operator": "==",
                                                "thresholdValue": "High Priority",
                                                "representation": "Sev0",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "==",
                                                "thresholdValue": "Low Priority",
                                                "representation": "2",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "Default",
                                                "thresholdValue": null,
                                                "representation": "unknown",
                                                "text": "{0}{1}"
                                              }
                                            ]
                                          }
                                        }
                                      ]
                                    },
                                    "chartSettings": {
                                      "yAxis": [
                                        "Consumed Cores"
                                      ],
                                      "group": "VMName",
                                      "createOtherGroup": null
                                    }
                                  },
                                  "customWidth": "33",
                                  "name": "Summary SQL+SKU AHUB Enabled - per VM"
                                },
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640e8\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Enabled\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLID\",\"mergedName\":\"SQLID\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMName\"}]}",
                                    "size": 0,
                                    "title": "SQL VM AHUB Consumed Cores per Priority",
                                    "noDataMessage": "None of your VMs have AHUB enabled.",
                                    "noDataMessageStyle": 4,
                                    "showRefreshButton": true,
                                    "queryType": 7,
                                    "visualization": "piechart",
                                    "gridSettings": {
                                      "formatters": [
                                        {
                                          "columnMatch": "Prioritize AHUB?",
                                          "formatter": 18,
                                          "formatOptions": {
                                            "thresholdsOptions": "icons",
                                            "thresholdsGrid": [
                                              {
                                                "operator": "==",
                                                "thresholdValue": "High Priority",
                                                "representation": "Sev0",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "==",
                                                "thresholdValue": "Low Priority",
                                                "representation": "2",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "Default",
                                                "thresholdValue": null,
                                                "representation": "unknown",
                                                "text": "{0}{1}"
                                              }
                                            ]
                                          }
                                        }
                                      ]
                                    },
                                    "chartSettings": {
                                      "group": "Prioritize AHUB?",
                                      "createOtherGroup": null
                                    }
                                  },
                                  "customWidth": "33",
                                  "showPin": false,
                                  "name": "Summary SQL+SKU AHUB Enabled -"
                                },
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640b5\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Disabled\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLID\",\"mergedName\":\"SQLID\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"}]}",
                                    "size": 0,
                                    "title": "Cores not enabled per AHUB Priority",
                                    "noDataMessage": "All of your VMs have AHUB enabled.",
                                    "noDataMessageStyle": 3,
                                    "showRefreshButton": true,
                                    "queryType": 7,
                                    "visualization": "piechart",
                                    "gridSettings": {
                                      "formatters": [
                                        {
                                          "columnMatch": "Prioritize AHUB?",
                                          "formatter": 18,
                                          "formatOptions": {
                                            "thresholdsOptions": "icons",
                                            "thresholdsGrid": [
                                              {
                                                "operator": "==",
                                                "thresholdValue": "High Priority",
                                                "representation": "Sev0",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "==",
                                                "thresholdValue": "Low Priority",
                                                "representation": "warning",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "Default",
                                                "thresholdValue": null,
                                                "representation": "success",
                                                "text": "{0}{1}"
                                              }
                                            ]
                                          }
                                        }
                                      ]
                                    },
                                    "sortBy": [],
                                    "chartSettings": {
                                      "yAxis": [
                                        "Consumed Cores"
                                      ],
                                      "showMetrics": false,
                                      "showLegend": true
                                    }
                                  },
                                  "customWidth": "33",
                                  "showPin": false,
                                  "name": " Summary - SQL Cores AHUB Disabled "
                                }
                              ]
                            },
                            "name": "SQL Overview RG"
                          },
                          {
                            "type": 9,
                            "content": {
                              "version": "KqlParameterItem/1.0",
                              "parameters": [
                                {
                                  "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "SQLAVMHUBEnabled",
                                  "label": "See SQL  VMs with AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                                  "timeContext": {
                                    "durationMs": 86400000
                                  },
                                  "value": "Yes"
                                },
                                {
                                  "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "SQLVMAHUBDisabled",
                                  "label": "See SQL VMs without AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                                  "value": "Yes"
                                }
                              ],
                              "style": "pills",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            "name": "parameters - 13"
                          },
                          {
                            "type": 12,
                            "content": {
                              "version": "NotebookGroup/1.0",
                              "groupType": "editable",
                              "items": [
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640b5\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Disabled\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLID\",\"mergedName\":\"VM Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLID\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMName\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMRG\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMLocation\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLVersion\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLSKU\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLAgentType\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].LicenseType\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SubscriptionName\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMSize\"}]}",
                                    "size": 0,
                                    "title": "SQL VM AHUB Disabled",
                                    "noDataMessage": "All of your VMs have AHUB enabled.",
                                    "noDataMessageStyle": 3,
                                    "showExportToExcel": true,
                                    "queryType": 7,
                                    "gridSettings": {
                                      "formatters": [
                                        {
                                          "columnMatch": "$gen_group",
                                          "formatter": 15,
                                          "formatOptions": {
                                            "linkTarget": null,
                                            "showIcon": true
                                          }
                                        },
                                        {
                                          "columnMatch": "Group",
                                          "formatter": 15,
                                          "formatOptions": {
                                            "linkTarget": null,
                                            "showIcon": true
                                          }
                                        },
                                        {
                                          "columnMatch": "Prioritize AHUB?",
                                          "formatter": 18,
                                          "formatOptions": {
                                            "thresholdsOptions": "icons",
                                            "thresholdsGrid": [
                                              {
                                                "operator": "==",
                                                "thresholdValue": "High Priority",
                                                "representation": "Sev0",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "==",
                                                "thresholdValue": "Low Priority",
                                                "representation": "warning",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "Default",
                                                "thresholdValue": null,
                                                "representation": "success",
                                                "text": "{0}{1}"
                                              }
                                            ]
                                          }
                                        }
                                      ],
                                      "hierarchySettings": {
                                        "treeType": 1,
                                        "groupBy": [
                                          "SubscriptionName"
                                        ],
                                        "expandTopLevel": true
                                      }
                                    },
                                    "sortBy": []
                                  },
                                  "conditionalVisibility": {
                                    "parameterName": "SQLVMAHUBDisabled",
                                    "comparison": "isEqualTo",
                                    "value": "Yes"
                                  },
                                  "showPin": false,
                                  "name": "SQL+SKU AHUB Disabled"
                                },
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640e8\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Enabled\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLID\",\"mergedName\":\"SQLID\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMName\"}]}",
                                    "size": 0,
                                    "title": "SQL VM AHUB Enabled",
                                    "noDataMessage": "None of your VMs have AHUB enabled.",
                                    "noDataMessageStyle": 4,
                                    "showExportToExcel": true,
                                    "queryType": 7,
                                    "gridSettings": {
                                      "formatters": [
                                        {
                                          "columnMatch": "$gen_group",
                                          "formatter": 15,
                                          "formatOptions": {
                                            "linkTarget": null,
                                            "showIcon": true
                                          }
                                        },
                                        {
                                          "columnMatch": "Group",
                                          "formatter": 15,
                                          "formatOptions": {
                                            "linkTarget": null,
                                            "showIcon": true
                                          }
                                        },
                                        {
                                          "columnMatch": "Prioritize AHUB?",
                                          "formatter": 18,
                                          "formatOptions": {
                                            "thresholdsOptions": "icons",
                                            "thresholdsGrid": [
                                              {
                                                "operator": "==",
                                                "thresholdValue": "High Priority",
                                                "representation": "Sev0",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "==",
                                                "thresholdValue": "Low Priority",
                                                "representation": "2",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "Default",
                                                "thresholdValue": null,
                                                "representation": "unknown",
                                                "text": "{0}{1}"
                                              }
                                            ]
                                          }
                                        },
                                        {
                                          "columnMatch": "Subscription",
                                          "formatter": 15,
                                          "formatOptions": {
                                            "linkTarget": null,
                                            "showIcon": true
                                          }
                                        }
                                      ],
                                      "hierarchySettings": {
                                        "treeType": 1,
                                        "groupBy": [
                                          "SubscriptionName"
                                        ],
                                        "expandTopLevel": true
                                      }
                                    }
                                  },
                                  "conditionalVisibility": {
                                    "parameterName": "SQLAVMHUBEnabled",
                                    "comparison": "isEqualTo",
                                    "value": "Yes"
                                  },
                                  "showPin": false,
                                  "name": "SQL+SKU AHUB Enabled"
                                }
                              ]
                            },
                            "name": "SQL Detailed Info"
                          }
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "SelectedSubTab",
                        "comparison": "isEqualTo",
                        "value": "SQLVM"
                      },
                      "name": "SQL VM"
                    },
                    {
                      "type": 12,
                      "content": {
                        "version": "NotebookGroup/1.0",
                        "groupType": "editable",
                        "title": "SQL Database",
                        "items": [
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\"\r\n| extend SubscriptionName=name | join (resources |  where type =~ 'Microsoft.Sql/servers/databases' and name != 'master' and tostring(properties.['licenseType']) == 'LicenseIncluded' \r\n| extend   SQLDBID=id,SQLName = name, SQLRG = resourceGroup, SKUName=tostring(sku.name), SKUTier=tostring(sku.tier), vCores=tostring(sku.capacity), SQLLocation = location, LicenseType = tostring(properties.['licenseType']), StorageAccountType=tostring(properties.['storageAccountType'])\r\n| extend CheckSQLDBAHUB = case(\r\n type =~ 'Microsoft.Sql/servers/databases', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    )\r\n) on subscriptionId \r\n| project SQLDBID,SQLName,SQLRG, SKUName, SKUTier, vCores, CheckSQLDBAHUB,SQLLocation, LicenseType, StorageAccountType, SubscriptionName\r\n",
                              "size": 0,
                              "title": "AHUB Disabled",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ]
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "SQLDB AHUB Disabled"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\"\r\n| extend SubscriptionName=name | join (resources |  where type =~ 'Microsoft.Sql/servers/databases' and name != 'master' and tostring(properties.['licenseType']) != 'LicenseIncluded' and kind !has 'serverless'\r\n| extend   SQLDBID=id,SQLName = name, SQLRG = resourceGroup, SKUName=sku.name, SKUTier=sku.tier, SQLLocation = location, vCores=tostring(sku.capacity), LicenseType = tostring(properties.['licenseType']), StorageAccountType=tostring(properties.['storageAccountType'])) on subscriptionId \r\n| project SQLDBID,SQLName,SQLRG, SKUName, SKUTier, vCores, SQLLocation, LicenseType, StorageAccountType, SubscriptionName\r\n",
                              "size": 0,
                              "title": "AHUB Enabled",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ]
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "SQLDB AHUB Enabled"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "## SQL Databases Azure Hybrid Benefit (AHUB) Overview"
                            },
                            "name": "text - 2"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "Apply to SQL Server 1 to 4 vCPUs exchange: For every 1 core of SQL Server Enterprise Edition, you get 4 vCPUs of SQL Managed Instance or Azure SQL Database general purpose and Hyperscale tiers, or 4 vCPUs of SQL Server Standard edition on Azure VMs.\r\n\r\nThe SQL virtual machines (VMs) with less than 4 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                              "style": "info"
                            },
                            "name": "text - 3"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "### AHUB Overview\r\nSummary of all SQL Databases with and without SQL AHUB.",
                              "style": "info"
                            },
                            "name": "text - 15"
                          },
                          {
                            "type": 12,
                            "content": {
                              "version": "NotebookGroup/1.0",
                              "groupType": "editable",
                              "loadType": "explicit",
                              "loadButtonText": "Load SQL DB Info",
                              "items": [
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\" | extend SubscriptionName=name \r\n| join (\r\n    resources | where type =~ 'Microsoft.Sql/servers/databases' and name != 'master'\r\n     | extend   SQLDBID=id,SQLName = name, SQLRG = resourceGroup, SKUName=sku.name, SKUTier=sku.tier, SQLLocation = location, LicenseType = tostring(properties.['licenseType']), StorageAccountType=tostring(properties.['storageAccountType'])\r\n     | extend CheckSQLDBAHUB = case(\r\n     type =~ 'Microsoft.Sql/servers/databases', iif((properties.['licenseType'])\r\n     has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not SQL DB\"\r\n     )\r\n    ) on subscriptionId \r\n| summarize count() by SubscriptionName, CheckSQLDBAHUB",
                                    "size": 0,
                                    "title": "Summary of SQL Databases with or without AHUB per Subscription",
                                    "showRefreshButton": true,
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources",
                                    "crossComponentResources": [
                                      "{Subscription}"
                                    ],
                                    "visualization": "table",
                                    "gridSettings": {
                                      "formatters": [
                                        {
                                          "columnMatch": "Prioritize AHUB?",
                                          "formatter": 18,
                                          "formatOptions": {
                                            "thresholdsOptions": "icons",
                                            "thresholdsGrid": [
                                              {
                                                "operator": "==",
                                                "thresholdValue": "High Priority",
                                                "representation": "Sev0",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "==",
                                                "thresholdValue": "Low Priority",
                                                "representation": "2",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "Default",
                                                "thresholdValue": null,
                                                "representation": "unknown",
                                                "text": "{0}{1}"
                                              }
                                            ]
                                          }
                                        }
                                      ]
                                    },
                                    "tileSettings": {
                                      "titleContent": {
                                        "columnMatch": "CheckSQLDBAHUB",
                                        "formatter": 1
                                      },
                                      "subtitleContent": {
                                        "columnMatch": "SubscriptionName",
                                        "formatter": 1
                                      },
                                      "leftContent": {
                                        "columnMatch": "count_",
                                        "formatter": 12,
                                        "formatOptions": {
                                          "palette": "auto"
                                        }
                                      },
                                      "showBorder": false,
                                      "size": "auto"
                                    },
                                    "chartSettings": {
                                      "xAxis": "SubscriptionName"
                                    }
                                  },
                                  "customWidth": "50",
                                  "name": "Summary of SQL DBs with or without AHUB per subs"
                                },
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\" | extend SubscriptionName=name \r\n| join (\r\n    resources | where type =~ 'Microsoft.Sql/servers/databases' and name != 'master'\r\n     | extend   SQLDBID=id,SQLName = name, SQLRG = resourceGroup, SKUName=sku.name, SKUTier=sku.tier, SQLLocation = location, LicenseType = tostring(properties.['licenseType']), StorageAccountType=tostring(properties.['storageAccountType'])\r\n     | extend CheckSQLDBAHUB = case(\r\n     type =~ 'Microsoft.Sql/servers/databases', iif((properties.['licenseType'])\r\n     has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not SQL DB\"\r\n     )\r\n    ) on subscriptionId \r\n| summarize count() by CheckSQLDBAHUB",
                                    "size": 0,
                                    "title": "Summary of SQL Databases with or without AHUB",
                                    "showRefreshButton": true,
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources",
                                    "crossComponentResources": [
                                      "{Subscription}"
                                    ],
                                    "visualization": "piechart",
                                    "gridSettings": {
                                      "formatters": [
                                        {
                                          "columnMatch": "Prioritize AHUB?",
                                          "formatter": 18,
                                          "formatOptions": {
                                            "thresholdsOptions": "icons",
                                            "thresholdsGrid": [
                                              {
                                                "operator": "==",
                                                "thresholdValue": "High Priority",
                                                "representation": "Sev0",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "==",
                                                "thresholdValue": "Low Priority",
                                                "representation": "2",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "Default",
                                                "thresholdValue": null,
                                                "representation": "unknown",
                                                "text": "{0}{1}"
                                              }
                                            ]
                                          }
                                        }
                                      ]
                                    },
                                    "tileSettings": {
                                      "titleContent": {
                                        "columnMatch": "CheckSQLDBAHUB",
                                        "formatter": 1
                                      },
                                      "subtitleContent": {
                                        "columnMatch": "SubscriptionName",
                                        "formatter": 1
                                      },
                                      "leftContent": {
                                        "columnMatch": "count_",
                                        "formatter": 12,
                                        "formatOptions": {
                                          "palette": "auto"
                                        }
                                      },
                                      "showBorder": false,
                                      "size": "auto"
                                    },
                                    "chartSettings": {
                                      "xAxis": "SubscriptionName"
                                    }
                                  },
                                  "customWidth": "50",
                                  "name": "Summary of SQL DBs with or without AHUB "
                                },
                                {
                                  "type": 1,
                                  "content": {
                                    "json": "### Consumed Licenses\r\nTotal number of SQL licenses cores consumed by all SQL Databases\r\n",
                                    "style": "info"
                                  },
                                  "customWidth": "50",
                                  "name": "text - 15"
                                },
                                {
                                  "type": 1,
                                  "content": {
                                    "json": "### Number of required Cores to enable SQL Azure Hybrid Benefit\r\nNumber of cores required to enable SQL AHUB across the entire environment.\r\n\r\n\r\n",
                                    "style": "info"
                                  },
                                  "customWidth": "50",
                                  "name": "Text SQL DB"
                                },
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Enabled\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Enabled].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"}]}",
                                    "size": 0,
                                    "title": "SQL DB AHUB Consumed Cores per VM",
                                    "noDataMessage": "None of your SQL DB have AHUB enabled.",
                                    "noDataMessageStyle": 4,
                                    "showRefreshButton": true,
                                    "queryType": 7,
                                    "visualization": "piechart",
                                    "gridSettings": {
                                      "formatters": [
                                        {
                                          "columnMatch": "Prioritize AHUB?",
                                          "formatter": 18,
                                          "formatOptions": {
                                            "thresholdsOptions": "icons",
                                            "thresholdsGrid": [
                                              {
                                                "operator": "==",
                                                "thresholdValue": "High Priority",
                                                "representation": "Sev0",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "==",
                                                "thresholdValue": "Low Priority",
                                                "representation": "2",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "Default",
                                                "thresholdValue": null,
                                                "representation": "unknown",
                                                "text": "{0}{1}"
                                              }
                                            ]
                                          }
                                        }
                                      ]
                                    },
                                    "chartSettings": {
                                      "yAxis": [
                                        "Consumed Cores"
                                      ],
                                      "group": "SQLName",
                                      "createOtherGroup": null
                                    }
                                  },
                                  "customWidth": "33",
                                  "name": "Summary SQLDB+SKU AHUB Enabled - per VM"
                                },
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Enabled\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Enabled].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"}]}",
                                    "size": 0,
                                    "title": "SQL DB AHUB Consumed Cores per Priority",
                                    "noDataMessage": "None of your SQL DB have AHUB enabled.",
                                    "noDataMessageStyle": 4,
                                    "showRefreshButton": true,
                                    "queryType": 7,
                                    "visualization": "piechart",
                                    "gridSettings": {
                                      "formatters": [
                                        {
                                          "columnMatch": "Prioritize AHUB?",
                                          "formatter": 18,
                                          "formatOptions": {
                                            "thresholdsOptions": "icons",
                                            "thresholdsGrid": [
                                              {
                                                "operator": "==",
                                                "thresholdValue": "High Priority",
                                                "representation": "Sev0",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "==",
                                                "thresholdValue": "Low Priority",
                                                "representation": "2",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "Default",
                                                "thresholdValue": null,
                                                "representation": "unknown",
                                                "text": "{0}{1}"
                                              }
                                            ]
                                          }
                                        }
                                      ]
                                    },
                                    "chartSettings": {
                                      "yAxis": [
                                        "Consumed Cores"
                                      ],
                                      "group": "Prioritize AHUB?",
                                      "createOtherGroup": null
                                    }
                                  },
                                  "customWidth": "33",
                                  "name": "Summary SQLDB+SKU AHUB Enabled - per Priority"
                                },
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Disabled\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Disabled].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].CheckSQLDBAHUB\",\"mergedName\":\"CheckSQLDBAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                                    "size": 0,
                                    "title": "SQL DB AHUB Cores not enabled per AHUB Priority",
                                    "noDataMessage": "All of your SQL DB have AHUB enabled.",
                                    "noDataMessageStyle": 3,
                                    "showRefreshButton": true,
                                    "queryType": 7,
                                    "visualization": "piechart",
                                    "gridSettings": {
                                      "formatters": [
                                        {
                                          "columnMatch": "Prioritize AHUB?",
                                          "formatter": 18,
                                          "formatOptions": {
                                            "thresholdsOptions": "icons",
                                            "thresholdsGrid": [
                                              {
                                                "operator": "==",
                                                "thresholdValue": "High Priority",
                                                "representation": "Sev0",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "==",
                                                "thresholdValue": "Low Priority",
                                                "representation": "2",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "Default",
                                                "thresholdValue": null,
                                                "representation": "unknown",
                                                "text": "{0}{1}"
                                              }
                                            ]
                                          }
                                        }
                                      ]
                                    },
                                    "chartSettings": {
                                      "yAxis": [
                                        "Consumed Cores"
                                      ],
                                      "group": "Prioritize AHUB?",
                                      "createOtherGroup": null
                                    }
                                  },
                                  "customWidth": "33",
                                  "name": "Summary SQLDB+SKU AHUB Disabled - per Priority"
                                }
                              ]
                            },
                            "name": "SQL DB Info"
                          },
                          {
                            "type": 9,
                            "content": {
                              "version": "KqlParameterItem/1.0",
                              "parameters": [
                                {
                                  "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "SQLDBHUBEnabled",
                                  "label": "See SQL  DBs with AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                                  "timeContext": {
                                    "durationMs": 86400000
                                  }
                                },
                                {
                                  "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "SQLDBAHUBDisabled",
                                  "label": "See SQL DBs without AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n"
                                }
                              ],
                              "style": "pills",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            "name": "parameters - 13"
                          },
                          {
                            "type": 12,
                            "content": {
                              "version": "NotebookGroup/1.0",
                              "groupType": "editable",
                              "items": [
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071ed\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Disabled\"}],\"projectRename\":[{\"originalName\":\"[SQLDB AHUB Disabled].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].CheckSQLDBAHUB\",\"mergedName\":\"CheckSQLDBAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"}]}",
                                    "size": 0,
                                    "title": "SQL DB AHUB Disabled",
                                    "noDataMessage": "All of your SQL DBs have AHUB enabled.",
                                    "showExportToExcel": true,
                                    "queryType": 7,
                                    "gridSettings": {
                                      "formatters": [
                                        {
                                          "columnMatch": "$gen_group",
                                          "formatter": 15,
                                          "formatOptions": {
                                            "linkTarget": null,
                                            "showIcon": true
                                          }
                                        },
                                        {
                                          "columnMatch": "Group",
                                          "formatter": 15,
                                          "formatOptions": {
                                            "linkTarget": null,
                                            "showIcon": true
                                          }
                                        },
                                        {
                                          "columnMatch": "SubscriptionName",
                                          "formatter": 15,
                                          "formatOptions": {
                                            "linkTarget": null,
                                            "showIcon": true
                                          }
                                        }
                                      ],
                                      "hierarchySettings": {
                                        "treeType": 1,
                                        "groupBy": [
                                          "SubscriptionName"
                                        ],
                                        "expandTopLevel": true
                                      }
                                    }
                                  },
                                  "conditionalVisibility": {
                                    "parameterName": "SQLDBAHUBDisabled",
                                    "comparison": "isEqualTo",
                                    "value": "Yes"
                                  },
                                  "name": "SQL DB Disabled"
                                },
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071f9\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Enabled\"}],\"projectRename\":[{\"originalName\":\"[SQLDB AHUB Enabled].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"}]}",
                                    "size": 0,
                                    "title": "SQL DB AHUB Enabled",
                                    "noDataMessage": "None of you SQL DBs have AHUB enabled.",
                                    "showExportToExcel": true,
                                    "queryType": 7
                                  },
                                  "conditionalVisibility": {
                                    "parameterName": "SQLDBHUBEnabled",
                                    "comparison": "isEqualTo",
                                    "value": "Yes"
                                  },
                                  "name": "SQL DB AHUB Enabled"
                                }
                              ]
                            },
                            "name": "Load SQL DB Detailed Info"
                          }
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "SelectedSubTab",
                        "comparison": "isEqualTo",
                        "value": "SQLDB"
                      },
                      "name": "SQLDBGroup"
                    },
                    {
                      "type": 12,
                      "content": {
                        "version": "NotebookGroup/1.0",
                        "groupType": "editable",
                        "title": "SQL Managed Instance",
                        "items": [
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\"\r\n | extend SubscriptionName=name \r\n | join (resources |  where type =~ 'Microsoft.Sql/managedInstances' and tostring(properties.['licenseType']) == 'LicenseIncluded'\r\n | extend ManagedInstance=id, SQLRG=resourceGroup, SQLLocation=location, vCores=tostring(sku.capacity),LicenseType = tostring(properties.['licenseType'])\r\n | extend CheckSQLMIAHUB = case(\r\n type =~ 'Microsoft.Sql/managedInstances', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    ) \r\n ) on subscriptionId \r\n | project ManagedInstance,SQLRG, SQLLocation, CheckSQLMIAHUB, vCores, LicenseType, SubscriptionName\r\n | where SQLRG in ({ResourceGroup})",
                              "size": 0,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ]
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "SQLMIAHUBDisabled"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\"\r\n | extend SubscriptionName=name \r\n | join (resources |  where type =~ 'Microsoft.Sql/managedInstances' and tostring(properties.['licenseType']) != 'LicenseIncluded'\r\n | extend ManagedInstance=id, SQLRG=resourceGroup, SQLLocation=location, vCores=tostring(sku.capacity),LicenseType = tostring(properties.['licenseType'])\r\n | extend CheckSQLMIAHUB = case(\r\n type =~ 'Microsoft.Sql/managedInstances', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    ) \r\n ) on subscriptionId \r\n | project ManagedInstance,SQLRG, SQLLocation, CheckSQLMIAHUB, vCores, LicenseType, SubscriptionName\r\n | where SQLRG in ({ResourceGroup})",
                              "size": 0,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ]
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "SQLMIAHUBEnabled"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "# SQL Managed Instances Azure Hybrid Benefit (AHUB) Overview\r\n"
                            },
                            "name": "text - 2"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "Apply to SQL Server 1 to 4 vCPUs exchange: For every 1 core of SQL Server Enterprise Edition, you get 4 vCPUs of SQL Managed Instance or Azure SQL Database general purpose and Hyperscale tiers, or 4 vCPUs of SQL Server Standard edition on Azure VMs.\r\n\r\nThe SQL virtual machines (VMs) with less than 4 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                              "style": "info"
                            },
                            "name": "text - 3"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "### AHUB Overview\r\nSummary of all SQL Databases with and without SQL AHUB.",
                              "style": "info"
                            },
                            "name": "text - 4"
                          },
                          {
                            "type": 12,
                            "content": {
                              "version": "NotebookGroup/1.0",
                              "groupType": "editable",
                              "loadType": "explicit",
                              "loadButtonText": "Load SQL MI Info",
                              "items": [
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\"\r\n | extend SubscriptionName=name \r\n | join (resources |  where type =~ 'Microsoft.Sql/managedInstances' and tostring(properties.['licenseType']) == 'LicenseIncluded'\r\n | extend ManagedInstance=id, SQLRG=resourceGroup, SQLLocation=location, vCores=tostring(sku.capacity),LicenseType = tostring(properties.['licenseType'])\r\n | extend CheckSQLMIAHUB = case(\r\n type =~ 'Microsoft.Sql/managedInstances', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    ) \r\n ) on subscriptionId \r\n| project ManagedInstance,SQLRG, SQLLocation, CheckSQLMIAHUB, vCores, LicenseType, SubscriptionName\r\n| summarize count() by SubscriptionName, CheckSQLMIAHUB",
                                    "size": 0,
                                    "title": "Summary of SQL MI with or without AHUB per Subscription",
                                    "showRefreshButton": true,
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources",
                                    "crossComponentResources": [
                                      "{Subscription}"
                                    ],
                                    "visualization": "table",
                                    "tileSettings": {
                                      "titleContent": {
                                        "columnMatch": "CheckSQLMIAHUB",
                                        "formatter": 1
                                      },
                                      "subtitleContent": {
                                        "columnMatch": "SubscriptionName"
                                      },
                                      "leftContent": {
                                        "columnMatch": "count_",
                                        "formatter": 12,
                                        "formatOptions": {
                                          "palette": "auto"
                                        },
                                        "numberFormat": {
                                          "unit": 17,
                                          "options": {
                                            "maximumSignificantDigits": 3,
                                            "maximumFractionDigits": 2
                                          }
                                        }
                                      },
                                      "showBorder": false
                                    },
                                    "chartSettings": {
                                      "yAxis": [
                                        "count_"
                                      ],
                                      "group": "CheckSQLMIAHUB",
                                      "createOtherGroup": null
                                    }
                                  },
                                  "customWidth": "50",
                                  "name": "Summary of SQL MI with or without AHUB per subs"
                                },
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | where tostring (properties.subscriptionPolicies.quotaId) !has \"MSDNDevTest_2014-09-01\" \r\n | extend SubscriptionName=name \r\n | join (resources |  where type =~ 'Microsoft.Sql/managedInstances' and tostring(properties.['licenseType']) == 'LicenseIncluded'\r\n | extend ManagedInstance=id, SQLRG=resourceGroup, SQLLocation=location, vCores=tostring(sku.capacity),LicenseType = tostring(properties.['licenseType'])\r\n | extend CheckSQLMIAHUB = case(\r\n type =~ 'Microsoft.Sql/managedInstances', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    ) \r\n ) on subscriptionId \r\n| project ManagedInstance,SQLRG, SQLLocation, CheckSQLMIAHUB, vCores, LicenseType, SubscriptionName\r\n| summarize count() by SubscriptionName, CheckSQLMIAHUB",
                                    "size": 0,
                                    "title": "Summary of SQL Managed Instance with or without AHUB",
                                    "showRefreshButton": true,
                                    "queryType": 1,
                                    "resourceType": "microsoft.resourcegraph/resources",
                                    "crossComponentResources": [
                                      "{Subscription}"
                                    ],
                                    "visualization": "piechart",
                                    "chartSettings": {
                                      "yAxis": [
                                        "count_"
                                      ],
                                      "group": "CheckSQLMIAHUB",
                                      "createOtherGroup": null
                                    }
                                  },
                                  "customWidth": "50",
                                  "name": "Summary of SQL MI with or without AHUB "
                                },
                                {
                                  "type": 1,
                                  "content": {
                                    "json": "### Consumed Licenses\r\nTotal number of SQL licenses cores consumed by all SQL Managed Instances.\r\n",
                                    "style": "info"
                                  },
                                  "customWidth": "50",
                                  "name": "text - 7"
                                },
                                {
                                  "type": 1,
                                  "content": {
                                    "json": "### Number of required Cores to enable SQL Azure Hybrid Benefit\r\nNumber of cores required to enable SQL AHUB across the entire environment.\r\n\r\n\r\n",
                                    "style": "info"
                                  },
                                  "customWidth": "50",
                                  "name": "text - 8"
                                },
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBEnabled\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLMIAHUBEnabled].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                                    "size": 0,
                                    "title": "SQL Managed Instance AHUB Consumed Cores per VM",
                                    "noDataMessage": "None of your SQL MI have AHUB enabled.",
                                    "noDataMessageStyle": 4,
                                    "showRefreshButton": true,
                                    "queryType": 7,
                                    "visualization": "piechart",
                                    "gridSettings": {
                                      "formatters": [
                                        {
                                          "columnMatch": "Prioritize AHUB?",
                                          "formatter": 18,
                                          "formatOptions": {
                                            "thresholdsOptions": "icons",
                                            "thresholdsGrid": [
                                              {
                                                "operator": "==",
                                                "thresholdValue": "High Priority",
                                                "representation": "Sev0",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "==",
                                                "thresholdValue": "Low Priority",
                                                "representation": "2",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "Default",
                                                "thresholdValue": null,
                                                "representation": "unknown",
                                                "text": "{0}{1}"
                                              }
                                            ]
                                          }
                                        }
                                      ]
                                    },
                                    "chartSettings": {
                                      "yAxis": [
                                        "Consumed Cores"
                                      ],
                                      "group": "SQLName",
                                      "createOtherGroup": null
                                    }
                                  },
                                  "customWidth": "33",
                                  "name": "Summary SQLMI+SKU AHUB Enabled - per VM"
                                },
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBEnabled\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLMIAHUBEnabled].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                                    "size": 0,
                                    "title": "SQL Managed Instance AHUB Consumed Cores per Priority",
                                    "noDataMessage": "None of your SQL MI have AHUB enabled.",
                                    "noDataMessageStyle": 4,
                                    "showRefreshButton": true,
                                    "queryType": 7,
                                    "visualization": "piechart",
                                    "gridSettings": {
                                      "formatters": [
                                        {
                                          "columnMatch": "Prioritize AHUB?",
                                          "formatter": 18,
                                          "formatOptions": {
                                            "thresholdsOptions": "icons",
                                            "thresholdsGrid": [
                                              {
                                                "operator": "==",
                                                "thresholdValue": "High Priority",
                                                "representation": "Sev0",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "==",
                                                "thresholdValue": "Low Priority",
                                                "representation": "2",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "Default",
                                                "thresholdValue": null,
                                                "representation": "unknown",
                                                "text": "{0}{1}"
                                              }
                                            ]
                                          }
                                        }
                                      ]
                                    },
                                    "chartSettings": {
                                      "yAxis": [
                                        "Consumed Cores"
                                      ],
                                      "group": "Prioritize AHUB?",
                                      "createOtherGroup": null
                                    }
                                  },
                                  "customWidth": "33",
                                  "name": "Summary SQLMI+SKU AHUB Enabled - per Priority"
                                },
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBDisabled\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"round([\\\"vCPUs\\\"] / 4) * 4\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLMIAHUBDisabled].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                                    "size": 0,
                                    "title": "SQL Managed Instances AHUB Cores not enabled per AHUB Priority",
                                    "noDataMessage": "All of your SQL MI have AHUB enabled.",
                                    "noDataMessageStyle": 3,
                                    "showRefreshButton": true,
                                    "queryType": 7,
                                    "visualization": "piechart",
                                    "gridSettings": {
                                      "formatters": [
                                        {
                                          "columnMatch": "Prioritize AHUB?",
                                          "formatter": 18,
                                          "formatOptions": {
                                            "thresholdsOptions": "icons",
                                            "thresholdsGrid": [
                                              {
                                                "operator": "==",
                                                "thresholdValue": "High Priority",
                                                "representation": "Sev0",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "==",
                                                "thresholdValue": "Low Priority",
                                                "representation": "2",
                                                "text": "{0}{1}"
                                              },
                                              {
                                                "operator": "Default",
                                                "thresholdValue": null,
                                                "representation": "unknown",
                                                "text": "{0}{1}"
                                              }
                                            ]
                                          }
                                        }
                                      ]
                                    },
                                    "chartSettings": {
                                      "yAxis": [
                                        "Consumed Cores"
                                      ],
                                      "group": "Prioritize AHUB?",
                                      "createOtherGroup": null
                                    }
                                  },
                                  "customWidth": "33",
                                  "name": "Summary SQLMI+SKU AHUB Disabled - per Priority"
                                }
                              ]
                            },
                            "name": "SQL MI Info"
                          },
                          {
                            "type": 9,
                            "content": {
                              "version": "KqlParameterItem/1.0",
                              "parameters": [
                                {
                                  "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "SQLMIAHUBEnabled",
                                  "label": "See SQL  MIs with AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                                  "timeContext": {
                                    "durationMs": 86400000
                                  }
                                },
                                {
                                  "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "SQLMIAHUBDisabled",
                                  "label": "See SQL MIs without AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n"
                                }
                              ],
                              "style": "pills",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            "name": "parameters - 136"
                          },
                          {
                            "type": 12,
                            "content": {
                              "version": "NotebookGroup/1.0",
                              "groupType": "editable",
                              "items": [
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071ed\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBDisabled\"}],\"projectRename\":[{\"originalName\":\"[SQLMIAHUBDisabled].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"}]}",
                                    "size": 0,
                                    "title": "SQL Managed Instance AHUB Disabled",
                                    "noDataMessage": "All of your SQL MIs have AHUB enabled.",
                                    "showExportToExcel": true,
                                    "queryType": 7,
                                    "gridSettings": {
                                      "formatters": [
                                        {
                                          "columnMatch": "$gen_group",
                                          "formatter": 15,
                                          "formatOptions": {
                                            "linkTarget": null,
                                            "showIcon": true
                                          }
                                        },
                                        {
                                          "columnMatch": "Group",
                                          "formatter": 15,
                                          "formatOptions": {
                                            "linkTarget": null,
                                            "showIcon": true
                                          }
                                        },
                                        {
                                          "columnMatch": "SubscriptionName",
                                          "formatter": 15,
                                          "formatOptions": {
                                            "linkTarget": null,
                                            "showIcon": true
                                          }
                                        }
                                      ],
                                      "hierarchySettings": {
                                        "treeType": 1,
                                        "groupBy": [
                                          "SubscriptionName"
                                        ],
                                        "expandTopLevel": true
                                      }
                                    }
                                  },
                                  "conditionalVisibility": {
                                    "parameterName": "SQLMIAHUBDisabled",
                                    "comparison": "isEqualTo",
                                    "value": "Yes"
                                  },
                                  "name": "SQL MI Disabled"
                                },
                                {
                                  "type": 3,
                                  "content": {
                                    "version": "KqlItem/1.0",
                                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071f9\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBEnabled\"}],\"projectRename\":[{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLMIAHUBEnabled].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"}]}",
                                    "size": 0,
                                    "title": "SQL Managed Instance AHUB Enabled",
                                    "noDataMessage": "None of you SQL MIs have AHUB enabled.",
                                    "showExportToExcel": true,
                                    "queryType": 7
                                  },
                                  "conditionalVisibility": {
                                    "parameterName": "SQLMIAHUBEnabled",
                                    "comparison": "isEqualTo",
                                    "value": "Yes"
                                  },
                                  "name": "SQL MI AHUB Enabled"
                                }
                              ]
                            },
                            "name": "SQL MI Detailed"
                          }
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "SelectedSubTab",
                        "comparison": "isEqualTo",
                        "value": "SQLMI"
                      },
                      "name": "SQL MI"
                    }
                  ]
                },
                "conditionalVisibilities": [
                  {
                    "parameterName": "SelectedTab",
                    "comparison": "isEqualTo",
                    "value": "SQL"
                  },
                  {
                    "parameterName": "RG_Filter",
                    "comparison": "isEqualTo",
                    "value": "Resource Group"
                  }
                ],
                "name": "SQLAHUB"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "title": "SQL Overview",
                  "items": [
                    {
                      "type": 11,
                      "content": {
                        "version": "LinkItem/1.0",
                        "style": "tabs",
                        "links": [
                          {
                            "id": "0211f413-9f36-4750-9ef2-d382ba30ba6c",
                            "cellValue": "SelectedSubTab",
                            "linkTarget": "parameter",
                            "linkLabel": "SQL Server VMs",
                            "subTarget": "SQLVM",
                            "preText": "VM",
                            "style": "link"
                          },
                          {
                            "id": "79e7a97a-1413-41e8-b4c6-ebd1d0a45e2e",
                            "cellValue": "SelectedSubTab",
                            "linkTarget": "parameter",
                            "linkLabel": "SQL DB",
                            "subTarget": "SQLDB",
                            "style": "link"
                          },
                          {
                            "id": "1f381e5b-7071-41ce-a354-c2df93445cae",
                            "cellValue": "SelectedSubTab",
                            "linkTarget": "parameter",
                            "linkLabel": "SQL Managed Instances",
                            "subTarget": "SQLMI",
                            "style": "link"
                          }
                        ]
                      },
                      "name": "links - 4"
                    },
                    {
                      "type": 12,
                      "content": {
                        "version": "NotebookGroup/1.0",
                        "groupType": "editable",
                        "items": [
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\n     resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'| where type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines' and tostring(properties.['sqlServerLicenseType']) != 'AHUB'\r\n    | extend SQLID=id, VMName = name, VMRG = resourceGroup, VMLocation = location, LicenseType = tostring(properties.['sqlServerLicenseType']), OSType=tostring(properties.storageProfile.imageReference.offer), SQLAgentType = tostring(properties.['sqlManagement']), SQLVersion = tostring(properties.['sqlImageOffer']), SQLSKU=tostring(properties.['sqlImageSku'])\r\n    ) on subscriptionId \r\n| join (\r\n    resources\r\n    | where type =~ 'Microsoft.Compute/virtualmachines'\r\n    | project VMName = tolower(name), VMSize = tostring(properties.hardwareProfile.vmSize)\r\n    ) on VMName\r\n| order by id asc    \r\n| project SQLID,VMName,VMRG, VMLocation, VMSize, SQLVersion, SQLSKU, SQLAgentType, LicenseType, SubscriptionName\r\n| where SQLSKU != \"Developer\" and SQLSKU != \"Express\"",
                              "size": 0,
                              "title": "SQL VM AHUB Disabled",
                              "noDataMessage": "All of your VMs have AHUB enabled.",
                              "noDataMessageStyle": 3,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ]
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "Get-SQL-AHUB-Disabled-Tags"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\n     resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' | where type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines' and tostring(properties.['sqlServerLicenseType']) == 'AHUB'\r\n    | extend SQLID=id, VMName = name, VMRG = resourceGroup, VMLocation = location, LicenseType = tostring(properties.['sqlServerLicenseType']), OSType=tostring(properties.storageProfile.imageReference.offer), SQLAgentType = tostring(properties.['sqlManagement']), SQLVersion = tostring(properties.['sqlImageOffer']), SQLSKU=tostring(properties.['sqlImageSku'])\r\n    ) on subscriptionId \r\n| join (\r\n    resources\r\n    | where type =~ 'Microsoft.Compute/virtualmachines'\r\n    | project VMName = tolower(name), VMSize = tostring(properties.hardwareProfile.vmSize)\r\n    ) on VMName\r\n| order by id asc    \r\n| project SQLID,VMName,VMRG, VMLocation, VMSize, SQLVersion, SQLSKU, SQLAgentType, LicenseType, SubscriptionName\r\n| where SQLSKU != \"Developer\" and SQLSKU != \"Express\"",
                              "size": 0,
                              "title": "SQL VM AHUB Enabled",
                              "noDataMessage": "None of your VMs have AHUB enabled.",
                              "noDataMessageStyle": 5,
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ]
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "Get-SQL-AHUB-Enabled-Tags"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "## SQL Virtual Machines Azure Hybrid Benefit (AHUB) Overview"
                            },
                            "name": "SQL Text"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "Apply to SQL Server 1 to 4 vCPUs exchange: For every 1 core of SQL Server Enterprise Edition, you get 4 vCPUs of SQL Managed Instance or Azure SQL Database general purpose and Hyperscale tiers, or 4 vCPUs of SQL Server Standard edition on Azure VMs.\r\n\r\nThe SQL virtual machines (VMs) with less than 4 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                              "style": "info"
                            },
                            "name": "SQL License Info",
                            "styleSettings": {
                              "margin": "10px",
                              "showBorder": true
                            }
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "### AHUB Overview\r\nSummary of all SQL on VMs with and without SQL AHUB.",
                              "style": "info"
                            },
                            "name": "text - 15"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\n    resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' | where type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines'\r\n    | extend SQLID=id, VMName = name, VMRG = resourceGroup, VMLocation = location, LicenseType = tostring(properties.['sqlServerLicenseType']), OSType=tostring(properties.storageProfile.imageReference.offer), SQLAgentType = tostring(properties.['sqlManagement']), SQLVersion = tostring(properties.['sqlImageOffer']), SQLSKU=tostring(properties.['sqlImageSku'])\r\n    | extend CheckSQLVMAHUB = case(\r\n     type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines', iif((properties.['sqlServerLicenseType'])\r\n     !has 'AHUB', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not SQL\"\r\n     )\r\n    ) on subscriptionId \r\n| summarize count() by SubscriptionName, CheckSQLVMAHUB",
                              "size": 0,
                              "title": "Summary of SQL on VMs with or without AHUB per Subscription",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "visualization": "tiles",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Low Priority",
                                          "representation": "2",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "unknown",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              },
                              "tileSettings": {
                                "titleContent": {
                                  "columnMatch": "CheckSQLVMAHUB",
                                  "formatter": 1
                                },
                                "subtitleContent": {
                                  "columnMatch": "SubscriptionName",
                                  "formatter": 1
                                },
                                "leftContent": {
                                  "columnMatch": "count_",
                                  "formatter": 12,
                                  "formatOptions": {
                                    "palette": "auto"
                                  }
                                },
                                "showBorder": false,
                                "size": "auto"
                              },
                              "chartSettings": {
                                "xAxis": "SubscriptionName"
                              }
                            },
                            "customWidth": "50",
                            "name": "Summary of SQL on VMs with or without AHUB"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\n  resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'| where type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines'\r\n    | extend SQLID=id, VMName = name, VMRG = resourceGroup, VMLocation = location, LicenseType = tostring(properties.['sqlServerLicenseType']), OSType=tostring(properties.storageProfile.imageReference.offer), SQLAgentType = tostring(properties.['sqlManagement']), SQLVersion = tostring(properties.['sqlImageOffer']), SQLSKU=tostring(properties.['sqlImageSku'])\r\n    | extend CheckSQLVMAHUB = case(\r\n     type =~ 'Microsoft.SqlVirtualMachine/SqlVirtualMachines', iif((properties.['sqlServerLicenseType'])\r\n     !has 'AHUB', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not SQL\"\r\n     )\r\n    ) on subscriptionId \r\n| summarize count() by CheckSQLVMAHUB",
                              "size": 0,
                              "title": "Summary SQL Enabled and Disabled",
                              "noDataMessage": "You don't have any SQL VM",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "visualization": "piechart"
                            },
                            "customWidth": "50",
                            "name": "Summary SQL Enabled and Disabled"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "### Consumed Licenses\r\nTotal number of SQL licenses cores consumed by all SQL running on Virtual Machines.\r\n",
                              "style": "info"
                            },
                            "customWidth": "50",
                            "name": "text - 15"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "### Number of required Cores to enable SQL Azure Hybrid Benefit\r\nNumber of cores required to enable SQL AHUB across the entire environment.\r\n\r\n\r\n",
                              "style": "info"
                            },
                            "customWidth": "50",
                            "name": "text - 15 - Copy"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640e8\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Enabled-Tags\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLID\",\"mergedName\":\"SQLID\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"}]}",
                              "size": 0,
                              "title": "SQL VM AHUB Consumed Cores per VM",
                              "noDataMessage": "None of your VMs have AHUB enabled.",
                              "noDataMessageStyle": 4,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Low Priority",
                                          "representation": "2",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "unknown",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "Consumed Cores"
                                ],
                                "group": "VMName",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "name": "Summary SQL+SKU AHUB Enabled - per VM"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640e8\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Enabled-Tags\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLID\",\"mergedName\":\"SQLID\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMName\"}]}",
                              "size": 0,
                              "title": "SQL VM AHUB Consumed Cores per Priority",
                              "noDataMessage": "None of your VMs have AHUB enabled.",
                              "noDataMessageStyle": 4,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Low Priority",
                                          "representation": "2",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "unknown",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              },
                              "chartSettings": {
                                "group": "Prioritize AHUB?",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "showPin": false,
                            "name": "Summary SQL+SKU AHUB Enabled -"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640b5\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Disabled-Tags\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SQLID\",\"mergedName\":\"SQLID\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"}]}",
                              "size": 0,
                              "title": "Cores not enabled per AHUB Priority",
                              "noDataMessage": "All of your VMs have AHUB enabled.",
                              "noDataMessageStyle": 3,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Low Priority",
                                          "representation": "warning",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "success",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              },
                              "sortBy": [],
                              "chartSettings": {
                                "yAxis": [
                                  "Consumed Cores"
                                ],
                                "showMetrics": false,
                                "showLegend": true
                              }
                            },
                            "customWidth": "33",
                            "showPin": false,
                            "name": " Summary - SQL Cores AHUB Disabled "
                          },
                          {
                            "type": 9,
                            "content": {
                              "version": "KqlParameterItem/1.0",
                              "parameters": [
                                {
                                  "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "SQLAVMHUBEnabled",
                                  "label": "See SQL  VMs with AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                                  "timeContext": {
                                    "durationMs": 86400000
                                  },
                                  "value": "Yes"
                                },
                                {
                                  "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "SQLVMAHUBDisabled",
                                  "label": "See SQL VMs without AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                                  "value": "Yes"
                                }
                              ],
                              "style": "pills",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            "name": "parameters - 13"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640b5\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Disabled-Tags\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SQLID\",\"mergedName\":\"SQL Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640b5\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLID\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMName\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMRG\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMLocation\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLVersion\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLSKU\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SQLAgentType\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].LicenseType\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].SubscriptionName\"},{\"originalName\":\"[Get-SQL-AHUB-Disabled].VMSize\"}]}",
                              "size": 0,
                              "title": "SQL VM AHUB Disabled",
                              "noDataMessage": "All of your VMs have AHUB enabled.",
                              "noDataMessageStyle": 3,
                              "showExportToExcel": true,
                              "queryType": 7,
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "$gen_group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Low Priority",
                                          "representation": "warning",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "success",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  }
                                ],
                                "hierarchySettings": {
                                  "treeType": 1,
                                  "groupBy": [
                                    "SubscriptionName"
                                  ],
                                  "expandTopLevel": true
                                }
                              },
                              "sortBy": []
                            },
                            "conditionalVisibility": {
                              "parameterName": "SQLVMAHUBDisabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "showPin": false,
                            "name": "SQL+SKU AHUB Disabled"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"cd7477ac-acd6-4894-b929-53348c7640e8\",\"mergeType\":\"inner\",\"leftTable\":\"API-Get_VM_SKU\",\"rightTable\":\"Get-SQL-AHUB-Enabled-Tags\",\"leftColumn\":\"Name\",\"rightColumn\":\"VMSize\"}],\"projectRename\":[{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLID\",\"mergedName\":\"SQL Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLVersion\",\"mergedName\":\"SQLVersion\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLSKU\",\"mergedName\":\"SQLSKU\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SQLAgentType\",\"mergedName\":\"SQLAgentType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"cd7477ac-acd6-4894-b929-53348c7640e8\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[Get-SQL-AHUB-Enabled].VMName\"}]}",
                              "size": 0,
                              "title": "SQL VM AHUB Enabled",
                              "noDataMessage": "None of your VMs have AHUB enabled.",
                              "noDataMessageStyle": 4,
                              "showExportToExcel": true,
                              "queryType": 7,
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "$gen_group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Low Priority",
                                          "representation": "2",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "unknown",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  },
                                  {
                                    "columnMatch": "Subscription",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  }
                                ],
                                "hierarchySettings": {
                                  "treeType": 1,
                                  "groupBy": [
                                    "SubscriptionName"
                                  ],
                                  "expandTopLevel": true
                                }
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "SQLAVMHUBEnabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "showPin": false,
                            "name": "SQL+SKU AHUB Enabled"
                          }
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "SelectedSubTab",
                        "comparison": "isEqualTo",
                        "value": "SQLVM"
                      },
                      "name": "SQL VM"
                    },
                    {
                      "type": 12,
                      "content": {
                        "version": "NotebookGroup/1.0",
                        "groupType": "editable",
                        "title": "SQL Database",
                        "items": [
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers\r\n| where type =~ 'Microsoft.Resources/subscriptions' \r\n| extend SubscriptionName=name | join (resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'|  where type =~ 'Microsoft.Sql/servers/databases' and name != 'master' and tostring(properties.['licenseType']) == 'LicenseIncluded' \r\n| extend   SQLDBID=id,SQLName = name, SQLRG = resourceGroup, SKUName=tostring(sku.name), SKUTier=tostring(sku.tier), vCores=tostring(sku.capacity), SQLLocation = location, LicenseType = tostring(properties.['licenseType']), StorageAccountType=tostring(properties.['storageAccountType'])\r\n| extend CheckSQLDBAHUB = case(\r\n type =~ 'Microsoft.Sql/servers/databases', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    )\r\n) on subscriptionId \r\n| project SQLDBID,SQLName,SQLRG, SKUName, SKUTier, vCores, CheckSQLDBAHUB,SQLLocation, LicenseType, StorageAccountType, SubscriptionName\r\n",
                              "size": 0,
                              "title": "AHUB Disabled",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ]
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "SQLDB AHUB Disabled-Tag"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers\r\n| where type =~ 'Microsoft.Resources/subscriptions' \r\n| extend SubscriptionName=name | join (resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' |  where type =~ 'Microsoft.Sql/servers/databases' and name != 'master' and tostring(properties.['licenseType']) != 'LicenseIncluded' \r\n| extend   SQLDBID=id,SQLName = name, SQLRG = resourceGroup, SKUName=sku.name, SKUTier=sku.tier, SQLLocation = location, vCores=tostring(sku.capacity), LicenseType = tostring(properties.['licenseType']), StorageAccountType=tostring(properties.['storageAccountType'])) on subscriptionId \r\n| project SQLDBID,SQLName,SQLRG, SKUName, SKUTier, vCores, SQLLocation, LicenseType, StorageAccountType, SubscriptionName\r\n",
                              "size": 0,
                              "title": "AHUB Enabled",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ]
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "SQLDB AHUB Enabled-Tag"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "## SQL Databases Azure Hybrid Benefit (AHUB) Overview"
                            },
                            "name": "text - 2"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "Apply to SQL Server 1 to 4 vCPUs exchange: For every 1 core of SQL Server Enterprise Edition, you get 4 vCPUs of SQL Managed Instance or Azure SQL Database general purpose and Hyperscale tiers, or 4 vCPUs of SQL Server Standard edition on Azure VMs.\r\n\r\nThe SQL virtual machines (VMs) with less than 4 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                              "style": "info"
                            },
                            "name": "text - 3"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "### AHUB Overview\r\nSummary of all SQL Databases with and without SQL AHUB.",
                              "style": "info"
                            },
                            "name": "text - 15"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\n    resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' | where type =~ 'Microsoft.Sql/servers/databases' and name != 'master'\r\n     | extend   SQLDBID=id,SQLName = name, SQLRG = resourceGroup, SKUName=sku.name, SKUTier=sku.tier, SQLLocation = location, LicenseType = tostring(properties.['licenseType']), StorageAccountType=tostring(properties.['storageAccountType'])\r\n     | extend CheckSQLDBAHUB = case(\r\n     type =~ 'Microsoft.Sql/servers/databases', iif((properties.['licenseType'])\r\n     has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not SQL DB\"\r\n     )\r\n    ) on subscriptionId \r\n| summarize count() by SubscriptionName, CheckSQLDBAHUB",
                              "size": 0,
                              "title": "Summary of SQL Databases with or without AHUB per Subscription",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "visualization": "tiles",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Low Priority",
                                          "representation": "2",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "unknown",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              },
                              "tileSettings": {
                                "titleContent": {
                                  "columnMatch": "CheckSQLDBAHUB",
                                  "formatter": 1
                                },
                                "subtitleContent": {
                                  "columnMatch": "SubscriptionName",
                                  "formatter": 1
                                },
                                "leftContent": {
                                  "columnMatch": "count_",
                                  "formatter": 12,
                                  "formatOptions": {
                                    "palette": "auto"
                                  }
                                },
                                "showBorder": false,
                                "size": "auto"
                              },
                              "chartSettings": {
                                "xAxis": "SubscriptionName"
                              }
                            },
                            "customWidth": "50",
                            "name": "Summary of SQL DBs with or without AHUB per subs"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\n    resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' | where type =~ 'Microsoft.Sql/servers/databases' and name != 'master'\r\n     | extend   SQLDBID=id,SQLName = name, SQLRG = resourceGroup, SKUName=sku.name, SKUTier=sku.tier, SQLLocation = location, LicenseType = tostring(properties.['licenseType']), StorageAccountType=tostring(properties.['storageAccountType'])\r\n     | extend CheckSQLDBAHUB = case(\r\n     type =~ 'Microsoft.Sql/servers/databases', iif((properties.['licenseType'])\r\n     has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not SQL DB\"\r\n     )\r\n    ) on subscriptionId \r\n| summarize count() by CheckSQLDBAHUB",
                              "size": 0,
                              "title": "Summary of SQL Databases with or without AHUB",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Low Priority",
                                          "representation": "2",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "unknown",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              },
                              "tileSettings": {
                                "titleContent": {
                                  "columnMatch": "CheckSQLDBAHUB",
                                  "formatter": 1
                                },
                                "subtitleContent": {
                                  "columnMatch": "SubscriptionName",
                                  "formatter": 1
                                },
                                "leftContent": {
                                  "columnMatch": "count_",
                                  "formatter": 12,
                                  "formatOptions": {
                                    "palette": "auto"
                                  }
                                },
                                "showBorder": false,
                                "size": "auto"
                              },
                              "chartSettings": {
                                "xAxis": "SubscriptionName"
                              }
                            },
                            "customWidth": "50",
                            "name": "Summary of SQL DBs with or without AHUB "
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "### Consumed Licenses\r\nTotal number of SQL licenses cores consumed by all SQL Databases\r\n",
                              "style": "info"
                            },
                            "customWidth": "50",
                            "name": "text - 15"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "### Number of required Cores to enable SQL Azure Hybrid Benefit\r\nNumber of cores required to enable SQL AHUB across the entire environment.\r\n\r\n\r\n",
                              "style": "info"
                            },
                            "customWidth": "50",
                            "name": "Text SQL DB"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Enabled-Tag\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCores\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                              "size": 0,
                              "title": "SQL DB AHUB Consumed Cores per VM",
                              "noDataMessage": "None of your SQL DB have AHUB enabled.",
                              "noDataMessageStyle": 4,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Low Priority",
                                          "representation": "2",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "unknown",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "Consumed Cores"
                                ],
                                "group": "SQLName",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "name": "Summary SQLDB+SKU AHUB Enabled - per VM"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Enabled-Tag\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCores\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                              "size": 0,
                              "title": "SQL DB AHUB Consumed Cores per Priority",
                              "noDataMessage": "None of your SQL DB have AHUB enabled.",
                              "noDataMessageStyle": 4,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Low Priority",
                                          "representation": "2",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "unknown",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "Consumed Cores"
                                ],
                                "group": "Prioritize AHUB?",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "name": "Summary SQLDB+SKU AHUB Enabled - per Priority"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Disabled-Tag\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCores\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].CheckSQLDBAHUB\",\"mergedName\":\"CheckSQLDBAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                              "size": 0,
                              "title": "SQL DB AHUB Cores not enabled per AHUB Priority",
                              "noDataMessage": "All of your SQL DB have AHUB enabled.",
                              "noDataMessageStyle": 3,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Low Priority",
                                          "representation": "2",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "unknown",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "Consumed Cores"
                                ],
                                "group": "Prioritize AHUB?",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "name": "Summary SQLDB+SKU AHUB Disabled - per Priority"
                          },
                          {
                            "type": 9,
                            "content": {
                              "version": "KqlParameterItem/1.0",
                              "parameters": [
                                {
                                  "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "SQLDBHUBEnabled",
                                  "label": "See SQL  DBs with AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                                  "timeContext": {
                                    "durationMs": 86400000
                                  }
                                },
                                {
                                  "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "SQLDBAHUBDisabled",
                                  "label": "See SQL DBs without AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n"
                                }
                              ],
                              "style": "pills",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            "name": "parameters - 13"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071ed\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Disabled-Tag\"}],\"projectRename\":[{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].CheckSQLDBAHUB\",\"mergedName\":\"CheckSQLDBAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLDB AHUB Disabled-Tag].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"}]}",
                              "size": 0,
                              "title": "SQL DB AHUB Disabled",
                              "noDataMessage": "All of your SQL DBs have AHUB enabled.",
                              "showExportToExcel": true,
                              "queryType": 7,
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "$gen_group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "SubscriptionName",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  }
                                ],
                                "hierarchySettings": {
                                  "treeType": 1,
                                  "groupBy": [
                                    "SubscriptionName"
                                  ],
                                  "expandTopLevel": true
                                }
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "SQLDBAHUBDisabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "name": "SQL DB Disabled"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071f9\",\"mergeType\":\"table\",\"leftTable\":\"SQLDB AHUB Enabled-Tag\"}],\"projectRename\":[{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLDBID\",\"mergedName\":\"SQLDBID\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLName\",\"mergedName\":\"SQLName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SKUName\",\"mergedName\":\"SKUName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SKUTier\",\"mergedName\":\"SKUTier\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].StorageAccountType\",\"mergedName\":\"StorageAccountType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLDB AHUB Enabled-Tag].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"}]}",
                              "size": 0,
                              "title": "SQL DB AHUB Enabled",
                              "noDataMessage": "None of you SQL DBs have AHUB enabled.",
                              "showExportToExcel": true,
                              "queryType": 7
                            },
                            "conditionalVisibility": {
                              "parameterName": "SQLDBHUBEnabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "name": "SQL DB AHUB Enabled"
                          }
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "SelectedSubTab",
                        "comparison": "isEqualTo",
                        "value": "SQLDB"
                      },
                      "name": "SQLDBGroup"
                    },
                    {
                      "type": 12,
                      "content": {
                        "version": "NotebookGroup/1.0",
                        "groupType": "editable",
                        "title": "SQL Managed Instance",
                        "items": [
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers\r\n | where type =~ 'Microsoft.Resources/subscriptions' \r\n | extend SubscriptionName=name \r\n | join (resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' |  where type =~ 'Microsoft.Sql/managedInstances' and tostring(properties.['licenseType']) == 'LicenseIncluded'\r\n | extend ManagedInstance=id, SQLRG=resourceGroup, SQLLocation=location, vCores=tostring(sku.capacity),LicenseType = tostring(properties.['licenseType'])\r\n | extend CheckSQLMIAHUB = case(\r\n type =~ 'Microsoft.Sql/managedInstances', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    ) \r\n ) on subscriptionId \r\n | project ManagedInstance,SQLRG, SQLLocation, CheckSQLMIAHUB, vCores, LicenseType, SubscriptionName",
                              "size": 0,
                              "title": "SQLMIAHUBDisabled",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ]
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "SQLMIAHUBDisabled-Tags"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers\r\n | where type =~ 'Microsoft.Resources/subscriptions' \r\n | extend SubscriptionName=name \r\n | join (resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' |  where type =~ 'Microsoft.Sql/managedInstances' and tostring(properties.['licenseType']) != 'LicenseIncluded'\r\n | extend ManagedInstance=id, SQLRG=resourceGroup, SQLLocation=location, vCores=tostring(sku.capacity),LicenseType = tostring(properties.['licenseType'])\r\n | extend CheckSQLMIAHUB = case(\r\n type =~ 'Microsoft.Sql/managedInstances', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    ) \r\n ) on subscriptionId \r\n | project ManagedInstance,SQLRG, SQLLocation, CheckSQLMIAHUB, vCores, LicenseType, SubscriptionName\r\n",
                              "size": 0,
                              "title": "SQLMIAHUBEnabled",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ]
                            },
                            "conditionalVisibility": {
                              "parameterName": "AlwaysHidden",
                              "comparison": "isEqualTo",
                              "value": "true"
                            },
                            "name": "SQLMIAHUBEnabled-Tags"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "# SQL Managed Instances Azure Hybrid Benefit (AHUB) Overview\r\n"
                            },
                            "name": "text - 2"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "Apply to SQL Server 1 to 4 vCPUs exchange: For every 1 core of SQL Server Enterprise Edition, you get 4 vCPUs of SQL Managed Instance or Azure SQL Database general purpose and Hyperscale tiers, or 4 vCPUs of SQL Server Standard edition on Azure VMs.\r\n\r\nThe SQL virtual machines (VMs) with less than 4 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                              "style": "info"
                            },
                            "name": "text - 3"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "### AHUB Overview\r\nSummary of all SQL Databases with and without SQL AHUB.",
                              "style": "info"
                            },
                            "name": "text - 4"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers\r\n | where type =~ 'Microsoft.Resources/subscriptions' \r\n | extend SubscriptionName=name \r\n | join (resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' |  where type =~ 'Microsoft.Sql/managedInstances' and tostring(properties.['licenseType']) == 'LicenseIncluded'\r\n | extend ManagedInstance=id, SQLRG=resourceGroup, SQLLocation=location, vCores=tostring(sku.capacity),LicenseType = tostring(properties.['licenseType'])\r\n | extend CheckSQLMIAHUB = case(\r\n type =~ 'Microsoft.Sql/managedInstances', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    ) \r\n ) on subscriptionId \r\n| project ManagedInstance,SQLRG, SQLLocation, CheckSQLMIAHUB, vCores, LicenseType, SubscriptionName\r\n| summarize count() by SubscriptionName, CheckSQLMIAHUB",
                              "size": 0,
                              "title": "Summary of SQL MI with or without AHUB per Subscription",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "visualization": "tiles",
                              "tileSettings": {
                                "titleContent": {
                                  "columnMatch": "CheckSQLMIAHUB",
                                  "formatter": 1
                                },
                                "subtitleContent": {
                                  "columnMatch": "SubscriptionName"
                                },
                                "leftContent": {
                                  "columnMatch": "count_",
                                  "formatter": 12,
                                  "formatOptions": {
                                    "palette": "auto"
                                  },
                                  "numberFormat": {
                                    "unit": 17,
                                    "options": {
                                      "maximumSignificantDigits": 3,
                                      "maximumFractionDigits": 2
                                    }
                                  }
                                },
                                "showBorder": false
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "count_"
                                ],
                                "group": "CheckSQLMIAHUB",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "50",
                            "name": "Summary of SQL MI with or without AHUB per subs"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "ResourceContainers\r\n | where type =~ 'Microsoft.Resources/subscriptions' \r\n | extend SubscriptionName=name \r\n | join (resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}' |  where type =~ 'Microsoft.Sql/managedInstances' and tostring(properties.['licenseType']) == 'LicenseIncluded'\r\n | extend ManagedInstance=id, SQLRG=resourceGroup, SQLLocation=location, vCores=tostring(sku.capacity),LicenseType = tostring(properties.['licenseType'])\r\n | extend CheckSQLMIAHUB = case(\r\n type =~ 'Microsoft.Sql/managedInstances', iif((properties.['licenseType'])\r\n has 'LicenseIncluded', \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n\"Not SQL DB\"\r\n    ) \r\n ) on subscriptionId \r\n| project ManagedInstance,SQLRG, SQLLocation, CheckSQLMIAHUB, vCores, LicenseType, SubscriptionName\r\n| summarize count() by SubscriptionName, CheckSQLMIAHUB",
                              "size": 0,
                              "title": "Summary of SQL Managed Instance with or without AHUB",
                              "queryType": 1,
                              "resourceType": "microsoft.resourcegraph/resources",
                              "crossComponentResources": [
                                "{Subscription}"
                              ],
                              "visualization": "piechart",
                              "chartSettings": {
                                "yAxis": [
                                  "count_"
                                ],
                                "group": "CheckSQLMIAHUB",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "50",
                            "name": "Summary of SQL MI with or without AHUB "
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "### Consumed Licenses\r\nTotal number of SQL licenses cores consumed by all SQL Managed Instances.\r\n",
                              "style": "info"
                            },
                            "customWidth": "50",
                            "name": "text - 7"
                          },
                          {
                            "type": 1,
                            "content": {
                              "json": "### Number of required Cores to enable SQL Azure Hybrid Benefit\r\nNumber of cores required to enable SQL AHUB across the entire environment.\r\n\r\n\r\n",
                              "style": "info"
                            },
                            "customWidth": "50",
                            "name": "text - 8"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBEnabled-Tags\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCores\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                              "size": 0,
                              "title": "SQL Managed Instance AHUB Consumed Cores per VM",
                              "noDataMessage": "None of your SQL MI have AHUB enabled.",
                              "noDataMessageStyle": 4,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Low Priority",
                                          "representation": "2",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "unknown",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "Consumed Cores"
                                ],
                                "group": "SQLName",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "name": "Summary SQLMI+SKU AHUB Enabled - per VM"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBEnabled-Tags\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCores\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                              "size": 0,
                              "title": "SQL Managed Instance AHUB Consumed Cores per Priority",
                              "noDataMessage": "None of your SQL MI have AHUB enabled.",
                              "noDataMessageStyle": 4,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Low Priority",
                                          "representation": "2",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "unknown",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "Consumed Cores"
                                ],
                                "group": "Prioritize AHUB?",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "name": "Summary SQLMI+SKU AHUB Enabled - per Priority"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071c2\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBDisabled-Tags\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"4\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCores\\\"] +3) & ~3\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCores\",\"operator\":\"<\",\"rightValType\":\"static\",\"rightVal\":\"4\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}}]},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071c2\"}]}",
                              "size": 0,
                              "title": "SQL Managed Instances AHUB Cores not enabled per AHUB Priority",
                              "noDataMessage": "All of your SQL MI have AHUB enabled.",
                              "noDataMessageStyle": 3,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "==",
                                          "thresholdValue": "Low Priority",
                                          "representation": "2",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "unknown",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    }
                                  }
                                ]
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "Consumed Cores"
                                ],
                                "group": "Prioritize AHUB?",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "name": "Summary SQLMI+SKU AHUB Disabled - per Priority"
                          },
                          {
                            "type": 9,
                            "content": {
                              "version": "KqlParameterItem/1.0",
                              "parameters": [
                                {
                                  "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "SQLMIAHUBEnabled",
                                  "label": "See SQL  MIs with AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                                  "timeContext": {
                                    "durationMs": 86400000
                                  },
                                  "value": "Yes"
                                },
                                {
                                  "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "SQLMIAHUBDisabled",
                                  "label": "See SQL MIs without AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                                  "value": "Yes"
                                }
                              ],
                              "style": "pills",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            "name": "parameters - 136"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071ed\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBDisabled-Tags\"}],\"projectRename\":[{\"originalName\":\"[SQLMIAHUBDisabled-Tags].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"},{\"originalName\":\"[SQLMIAHUBDisabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071ed\"}]}",
                              "size": 0,
                              "title": "SQL Managed Instance AHUB Disabled",
                              "noDataMessage": "All of your SQL MIs have AHUB enabled.",
                              "showExportToExcel": true,
                              "queryType": 7,
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "$gen_group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "SubscriptionName",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  }
                                ],
                                "hierarchySettings": {
                                  "treeType": 1,
                                  "groupBy": [
                                    "SubscriptionName"
                                  ],
                                  "expandTopLevel": true
                                }
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "SQLMIAHUBDisabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "name": "SQL MI Disabled"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"f65bea23-bb49-4498-b331-c20c618071f9\",\"mergeType\":\"table\",\"leftTable\":\"SQLMIAHUBEnabled-Tags\"}],\"projectRename\":[{\"originalName\":\"[SQLDB AHUB Enabled].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"unknown\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].ManagedInstance\",\"mergedName\":\"ManagedInstance\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SQLRG\",\"mergedName\":\"SQLRG\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SQLLocation\",\"mergedName\":\"SQLLocation\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].CheckSQLMIAHUB\",\"mergedName\":\"CheckSQLMIAHUB\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].vCores\",\"mergedName\":\"vCores\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"},{\"originalName\":\"[SQLMIAHUBEnabled-Tags].SubscriptionName\",\"mergedName\":\"SubscriptionName\",\"fromId\":\"f65bea23-bb49-4498-b331-c20c618071f9\"}]}",
                              "size": 0,
                              "title": "SQL Managed Instance AHUB Enabled",
                              "noDataMessage": "None of you SQL MIs have AHUB enabled.",
                              "showExportToExcel": true,
                              "queryType": 7
                            },
                            "conditionalVisibility": {
                              "parameterName": "SQLMIAHUBEnabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "name": "SQL MI AHUB Enabled"
                          }
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "SelectedSubTab",
                        "comparison": "isEqualTo",
                        "value": "SQLMI"
                      },
                      "name": "SQL MI"
                    }
                  ]
                },
                "conditionalVisibilities": [
                  {
                    "parameterName": "SelectedTab",
                    "comparison": "isEqualTo",
                    "value": "SQL"
                  },
                  {
                    "parameterName": "RG_Filter",
                    "comparison": "isEqualTo",
                    "value": "Tags"
                  }
                ],
                "name": "SQLAHUB - Tag"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "title": "Linux Hybrid Benefit",
                  "loadType": "explicit",
                  "loadButtonText": "Load Linux Recommendations",
                  "items": [
                    {
                      "type": 1,
                      "content": {
                        "json": "## Linux Azure Hybrid Benefit (AHUB) Overview"
                      },
                      "name": "Linux Text"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{SingleSubHidden}/providers/Microsoft.Compute/skus?$filter=location eq '{Location}'\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2021-07-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*[?(@.resourceType=='virtualMachines')]\",\"columns\":[{\"path\":\"name\",\"columnid\":\"Name\"},{\"path\":\"capabilities[?(@.name=='vCPUs')].value\",\"columnid\":\"vCPUs\"},{\"path\":\"capabilities[?(@.name=='MemoryGB')].value\",\"columnid\":\"MemoryGB\"},{\"path\":\"capabilities[?(@.name=='MaxNetworkInterfaces')].value\",\"columnid\":\"MaxNetworkInterfaces\"},{\"path\":\"capabilities[?(@.name=='HyperVGenerations')].value\",\"columnid\":\"HyperVGenerations\"},{\"path\":\"capabilities[?(@.name=='vCPUsPerCore')].value\",\"columnid\":\"vCPUsPerCore\"}]}}]}",
                        "size": 0,
                        "title": "Get VM vCPU",
                        "exportParameterName": "ResourceSKU",
                        "showExportToExcel": true,
                        "queryType": 12,
                        "gridSettings": {
                          "rowLimit": 5000
                        }
                      },
                      "conditionalVisibility": {
                        "parameterName": "AlwaysHidden",
                        "comparison": "isEqualTo",
                        "value": "true"
                      },
                      "name": "API-Get_VMLinux_SKU"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "resources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualmachines' and (properties.storageProfile.imageReference.publisher == 'suse' or properties.storageProfile.imageReference.publisher=='RedHat')\r\n| where isnull ((properties.['licenseType']))\r\n| extend LinuxId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.publisher), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']), VMSSize=tostring(sku.name)\r\n| order by type asc \r\n| project LinuxId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType",
                        "size": 0,
                        "title": "AHUB Disabled",
                        "noDataMessage": "None of your Linux VMs have AHUB enabled.",
                        "noDataMessageStyle": 4,
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "AlwaysHidden",
                        "comparison": "isEqualTo",
                        "value": "true"
                      },
                      "name": "LinuxAHUBDisabled"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "resources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualmachines' and (properties.storageProfile.imageReference.publisher == 'suse' or properties.storageProfile.imageReference.publisher=='RedHat')\r\n| where isnotnull ((properties.['licenseType']))\r\n| extend LinuxId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.publisher), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']), VMSSize=tostring(sku.name)\r\n| order by type asc \r\n| project LinuxId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType",
                        "size": 0,
                        "title": "AHUB Enabled",
                        "noDataMessage": "All of your Linux VMs have AHUB enabled.",
                        "noDataMessageStyle": 3,
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "AlwaysHidden",
                        "comparison": "isEqualTo",
                        "value": "true"
                      },
                      "name": "LinuxAHUBRGEnabled"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "resources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualmachines' and (properties.storageProfile.imageReference.publisher == 'suse' or properties.storageProfile.imageReference.publisher=='RedHat')\r\n| extend LicenseType = tostring(properties.['licenseType'])\r\n| extend CheckAHUBLinux = case(\r\n     type == 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets',\r\n     iff(isnull((properties.['licenseType'])),\r\n      \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not Linux\"\r\n     )\r\n| summarize count() by CheckAHUBLinux",
                        "size": 0,
                        "title": "Summary of Linux VMs with or without AHUB",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "visualization": "piechart"
                      },
                      "customWidth": "50",
                      "name": "Summary of Linux VMs with or without AHUB"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "resourcechanges\r\n| where properties.changeType == \"Update\" and properties.targetResourceType == \"microsoft.compute/virtualmachines\"\r\n| mv-expand changes = properties.changes\r\n| mv-expand LicenseChanges=changes.['properties.licenseType']\r\n| where isnotnull(LicenseChanges)\r\n| where  tostring(LicenseChanges.newValue) has \"SLES_BYOS\" or tostring(LicenseChanges.newValue) has \"RHEL_BYOS\"\r\n| project VMID=properties.targetResourceId, NewLicense=tostring(LicenseChanges.newValue), DateofChange=tostring(properties.changeAttributes.timestamp)\r\n",
                        "size": 0,
                        "title": "Linux VM Latest Change Last 7 days",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "AlwaysHidden",
                        "comparison": "isEqualTo",
                        "value": "true"
                      },
                      "name": "Linux VM Latest Change Last 7 days"
                    },
                    {
                      "type": 9,
                      "content": {
                        "version": "KqlParameterItem/1.0",
                        "parameters": [
                          {
                            "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                            "version": "KqlParameterItem/1.0",
                            "name": "LinuxAHUBEnabled",
                            "label": "See Linux VMs with AHUB",
                            "type": 2,
                            "isRequired": true,
                            "typeSettings": {
                              "additionalResourceOptions": [],
                              "showDefault": false
                            },
                            "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                            "timeContext": {
                              "durationMs": 86400000
                            }
                          },
                          {
                            "id": "439c7c8d-4119-4328-b4ca-2b1e676ede28",
                            "version": "KqlParameterItem/1.0",
                            "name": "LinuxEnabledPast7D",
                            "label": "See Linux VMs enabled last 7 days",
                            "type": 2,
                            "isRequired": true,
                            "typeSettings": {
                              "additionalResourceOptions": [],
                              "showDefault": false
                            },
                            "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                            "timeContext": {
                              "durationMs": 86400000
                            }
                          },
                          {
                            "id": "4c3ff9fa-d9c8-4d35-94d4-48ba3a1547fd",
                            "version": "KqlParameterItem/1.0",
                            "name": "LinuxAHUBDisabled",
                            "label": "See Linux VMs without AHUB",
                            "type": 2,
                            "isRequired": true,
                            "typeSettings": {
                              "additionalResourceOptions": []
                            },
                            "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                            "timeContext": {
                              "durationMs": 86400000
                            }
                          }
                        ],
                        "style": "pills",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      },
                      "name": "parameters - 13"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "List of Linux VMs with Hybrid Benefit groupped by Subscription."
                      },
                      "conditionalVisibility": {
                        "parameterName": "LinuxAHUBEnabled",
                        "comparison": "isEqualTo",
                        "value": "Yes"
                      },
                      "name": "text - 8"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\",\"mergeType\":\"inner\",\"leftTable\":\"LinuxAHUBRGEnabled\",\"rightTable\":\"API-Get_VMLinux_SKU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[LinuxAHUBRGEnabled].LinuxId\",\"mergedName\":\"VM ID\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBRGEnabled].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBRGEnabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBRGEnabled].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBRGEnabled].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBRGEnabled].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBRGEnabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled].VMName\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[LinuxAHUBEnabled].VMSSize\"},{\"originalName\":\"[LinuxAHUBRGEnabled].VMName\"},{\"originalName\":\"[LinuxAHUBRGEnabled].VMSSize\"}]}",
                        "size": 0,
                        "title": "Linux VMs with AHUB",
                        "noDataMessage": "None of your Linux VMs have AHUB enabled",
                        "noDataMessageStyle": 4,
                        "showExportToExcel": true,
                        "queryType": 7,
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "Prioritize AHUB?",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "==",
                                    "thresholdValue": "High Priority",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  }
                                ]
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            }
                          ]
                        },
                        "tileSettings": {
                          "showBorder": false,
                          "titleContent": {
                            "columnMatch": "NewLicense",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "vCPUs",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "maximumSignificantDigits": 3,
                                "maximumFractionDigits": 2
                              }
                            }
                          }
                        },
                        "chartSettings": {
                          "xAxis": "VM Name",
                          "yAxis": [
                            "Consumed Cores per VM"
                          ],
                          "group": null,
                          "createOtherGroup": 0,
                          "seriesLabelSettings": [
                            {
                              "seriesName": "Consumed Cores per VM",
                              "color": "grayBlue"
                            }
                          ]
                        }
                      },
                      "conditionalVisibility": {
                        "parameterName": "LinuxAHUBEnabled",
                        "comparison": "isEqualTo",
                        "value": "Yes"
                      },
                      "name": "Linux-VM+SKU+vCores-AHUB"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "List of Linux VMs without Hybrid Benefit groupped by Subscription."
                      },
                      "conditionalVisibility": {
                        "parameterName": "LinuxAHUBDisabled",
                        "comparison": "isEqualTo",
                        "value": "Yes"
                      },
                      "name": "text - 8 - Copy"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\",\"mergeType\":\"inner\",\"leftTable\":\"LinuxAHUBDisabled\",\"rightTable\":\"API-Get_VMLinux_SKU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[LinuxAHUBDisabled].LinuxId\",\"mergedName\":\"LinuxId\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VMLinux_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled].VMName\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[LinuxAHUBEnabled].VMSSize\"}]}",
                        "size": 0,
                        "title": "Linux VMs without AHUB",
                        "noDataMessage": "None of your Linux VMs have AHUB enabled",
                        "noDataMessageStyle": 4,
                        "showExportToExcel": true,
                        "queryType": 7,
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "Prioritize AHUB?",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "==",
                                    "thresholdValue": "High Priority",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  }
                                ]
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            }
                          ]
                        },
                        "tileSettings": {
                          "showBorder": false,
                          "titleContent": {
                            "columnMatch": "NewLicense",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "vCPUs",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "maximumSignificantDigits": 3,
                                "maximumFractionDigits": 2
                              }
                            }
                          }
                        },
                        "chartSettings": {
                          "xAxis": "VM Name",
                          "yAxis": [
                            "Consumed Cores per VM"
                          ],
                          "group": null,
                          "createOtherGroup": 0,
                          "seriesLabelSettings": [
                            {
                              "seriesName": "Consumed Cores per VM",
                              "color": "grayBlue"
                            }
                          ]
                        }
                      },
                      "conditionalVisibility": {
                        "parameterName": "LinuxAHUBDisabled",
                        "comparison": "isEqualTo",
                        "value": "Yes"
                      },
                      "name": "Linux-VM+SKU+vCores-AHUBDisabled"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26168\",\"mergeType\":\"inner\",\"leftTable\":\"Linux VM Latest Change Last 7 days\",\"rightTable\":\"Linux-VM+SKU+vCores-AHUB\",\"leftColumn\":\"VMID\",\"rightColumn\":\"VM ID\"}],\"projectRename\":[{\"originalName\":\"[Linux VM Latest Change Last 7 days].VMID\",\"mergedName\":\"VMID\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux VM Latest Change Last 7 days].NewLicense\",\"mergedName\":\"NewLicense\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux VM Latest Change Last 7 days].DateofChange\",\"mergedName\":\"DateofChange\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].VM ID\",\"mergedName\":\"VM ID\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].Name\",\"mergedName\":\"Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux VM Latest Change Last 7 days].VMID\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].vCPUs\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].OSType\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].OsVersion\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].LicenseType\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].vCPUsPerCore\"}]}",
                        "size": 0,
                        "title": "Linux Total Cores Enabled last 7 Days",
                        "noDataMessage": "There wasn't any Linux AHUB was enabled in the last 7 days.",
                        "showExportToExcel": true,
                        "queryType": 7,
                        "visualization": "table",
                        "tileSettings": {
                          "showBorder": false,
                          "titleContent": {
                            "columnMatch": "NewLicense",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "vCPUs",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "maximumSignificantDigits": 3,
                                "maximumFractionDigits": 2
                              }
                            }
                          }
                        },
                        "chartSettings": {
                          "group": null,
                          "createOtherGroup": 0,
                          "seriesLabelSettings": [
                            {
                              "seriesName": "Consumed Cores per VM",
                              "color": "grayBlue"
                            }
                          ]
                        }
                      },
                      "conditionalVisibility": {
                        "parameterName": "LinuxEnabledPast7D",
                        "comparison": "isEqualTo",
                        "value": "Yes"
                      },
                      "name": "Linux Total Cores Enabled last 7 Days"
                    }
                  ]
                },
                "conditionalVisibilities": [
                  {
                    "parameterName": "SelectedSubTab",
                    "comparison": "isEqualTo",
                    "value": "LinuxVM"
                  },
                  {
                    "parameterName": "SelectedTab",
                    "comparison": "isEqualTo",
                    "value": "VM"
                  },
                  {
                    "parameterName": "RG_Filter",
                    "comparison": "isEqualTo",
                    "value": "Resource Group"
                  }
                ],
                "name": "Linux"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "title": "Linux Hybrid Benefit",
                  "loadType": "explicit",
                  "loadButtonText": "Load Linux Recommendations",
                  "items": [
                    {
                      "type": 1,
                      "content": {
                        "json": "## Linux Azure Hybrid Benefit (AHUB) Overview"
                      },
                      "name": "Linux Text"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualmachines' and (properties.storageProfile.imageReference.publisher == 'suse' or properties.storageProfile.imageReference.publisher=='RedHat')\r\n| where isnotnull ((properties.['licenseType']))\r\n| extend LinuxId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.publisher), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']), VMSSize=tostring(sku.name)\r\n| order by type asc \r\n| project LinuxId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType",
                        "size": 0,
                        "title": "AHUB Enabled-Tag",
                        "noDataMessage": "None of your Linux VMs have AHUB enabled.",
                        "noDataMessageStyle": 4,
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "AlwaysHidden",
                        "comparison": "isEqualTo",
                        "value": "true"
                      },
                      "name": "LinuxAHUBEnabled-Tag"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualmachines' and (properties.storageProfile.imageReference.publisher == 'suse' or properties.storageProfile.imageReference.publisher=='RedHat')\r\n| where isnull ((properties.['licenseType']))\r\n| extend LinuxId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.storageProfile.imageReference.publisher), OsVersion = tostring(properties.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.['licenseType']), VMSSize=tostring(sku.name)\r\n| order by type asc \r\n| project LinuxId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType",
                        "size": 0,
                        "title": "AHUB Disabled",
                        "noDataMessage": "None of your Linux VMs have AHUB enabled.",
                        "noDataMessageStyle": 4,
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "AlwaysHidden",
                        "comparison": "isEqualTo",
                        "value": "true"
                      },
                      "name": "LinuxAHUBDisabled-Tag"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "resources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualmachines' and (properties.storageProfile.imageReference.publisher == 'suse' or properties.storageProfile.imageReference.publisher=='RedHat')\r\n| extend LicenseType = tostring(properties.['licenseType'])\r\n| extend CheckAHUBLinux = case(\r\n     type == 'microsoft.compute/virtualmachines' or type =~ 'microsoft.compute/virtualMachineScaleSets',\r\n     iff(isnull((properties.['licenseType'])),\r\n      \"AHUB Not Enabled\", \"AHUB Enabled\"),\r\n     \"Not Linux\"\r\n     )\r\n| summarize count() by CheckAHUBLinux",
                        "size": 0,
                        "title": "Summary of Linux VMs with or without AHUB",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ],
                        "visualization": "piechart"
                      },
                      "customWidth": "50",
                      "name": "Summary of Linux VMs with or without AHUB"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "resourcechanges\r\n| where properties.changeType == \"Update\" and properties.targetResourceType == \"microsoft.compute/virtualmachines\"\r\n| mv-expand changes = properties.changes\r\n| mv-expand LicenseChanges=changes.['properties.licenseType']\r\n| where isnotnull(LicenseChanges)\r\n| where  tostring(LicenseChanges.newValue) has \"SLES_BYOS\" or tostring(LicenseChanges.newValue) has \"RHEL_BYOS\"\r\n| project VMID=properties.targetResourceId, NewLicense=tostring(LicenseChanges.newValue), DateofChange=tostring(properties.changeAttributes.timestamp)\r\n",
                        "size": 0,
                        "title": "Linux VM Latest Change Last 7 days",
                        "noDataMessage": "There wasn't any AHUB enabled in the last 7 days.",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "AlwaysHidden",
                        "comparison": "isEqualTo",
                        "value": "true"
                      },
                      "name": "Linux VM Latest Change Last 7 days"
                    },
                    {
                      "type": 9,
                      "content": {
                        "version": "KqlParameterItem/1.0",
                        "parameters": [
                          {
                            "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                            "version": "KqlParameterItem/1.0",
                            "name": "LinuxAHUBEnabled",
                            "label": "See Linux VMs with AHUB",
                            "type": 2,
                            "isRequired": true,
                            "typeSettings": {
                              "additionalResourceOptions": [],
                              "showDefault": false
                            },
                            "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                            "timeContext": {
                              "durationMs": 86400000
                            },
                            "value": "Yes"
                          },
                          {
                            "id": "439c7c8d-4119-4328-b4ca-2b1e676ede28",
                            "version": "KqlParameterItem/1.0",
                            "name": "LinuxEnabledPast7D",
                            "label": "See Linux VMs enabled last 7 days",
                            "type": 2,
                            "isRequired": true,
                            "typeSettings": {
                              "additionalResourceOptions": [],
                              "showDefault": false
                            },
                            "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                            "timeContext": {
                              "durationMs": 86400000
                            },
                            "value": "Yes"
                          },
                          {
                            "id": "4c3ff9fa-d9c8-4d35-94d4-48ba3a1547fd",
                            "version": "KqlParameterItem/1.0",
                            "name": "LinuxAHUBDisabled",
                            "label": "See Linux VMs without AHUB",
                            "type": 2,
                            "isRequired": true,
                            "typeSettings": {
                              "additionalResourceOptions": []
                            },
                            "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                            "timeContext": {
                              "durationMs": 86400000
                            },
                            "value": "Yes"
                          }
                        ],
                        "style": "pills",
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      },
                      "name": "parameters - 13"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "List of Linux VMs with Hybrid Benefit groupped by Subscription."
                      },
                      "conditionalVisibility": {
                        "parameterName": "LinuxAHUBEnabled",
                        "comparison": "isEqualTo",
                        "value": "Yes"
                      },
                      "name": "text - 8"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\",\"mergeType\":\"inner\",\"leftTable\":\"LinuxAHUBEnabled-Tag\",\"rightTable\":\"API-Get_VM_SKU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[LinuxAHUBEnabled-Tag].LinuxId\",\"mergedName\":\"LinuxId\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled-Tag].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled-Tag].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled-Tag].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled-Tag].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled-Tag].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled].VMName\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[LinuxAHUBEnabled].VMSSize\"},{\"originalName\":\"[LinuxAHUBEnabled-Tag].VMName\"},{\"originalName\":\"[LinuxAHUBEnabled-Tag].VMSSize\"}]}",
                        "size": 0,
                        "title": "Linux VMs with AHUB",
                        "noDataMessage": "None of your Linux VMs have AHUB enabled",
                        "noDataMessageStyle": 4,
                        "showExportToExcel": true,
                        "queryType": 7,
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "Prioritize AHUB?",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "==",
                                    "thresholdValue": "High Priority",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  }
                                ]
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            }
                          ]
                        },
                        "tileSettings": {
                          "showBorder": false,
                          "titleContent": {
                            "columnMatch": "NewLicense",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "vCPUs",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "maximumSignificantDigits": 3,
                                "maximumFractionDigits": 2
                              }
                            }
                          }
                        },
                        "chartSettings": {
                          "xAxis": "VM Name",
                          "yAxis": [
                            "Consumed Cores per VM"
                          ],
                          "group": null,
                          "createOtherGroup": 0,
                          "seriesLabelSettings": [
                            {
                              "seriesName": "Consumed Cores per VM",
                              "color": "grayBlue"
                            }
                          ]
                        }
                      },
                      "conditionalVisibility": {
                        "parameterName": "LinuxAHUBEnabled",
                        "comparison": "isEqualTo",
                        "value": "Yes"
                      },
                      "name": "Linux-VM+SKU+vCores-AHUB"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "List of Linux VMs without Hybrid Benefit groupped by Subscription."
                      },
                      "conditionalVisibility": {
                        "parameterName": "LinuxAHUBDisabled",
                        "comparison": "isEqualTo",
                        "value": "Yes"
                      },
                      "name": "text - 8 - Copy"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\",\"mergeType\":\"inner\",\"leftTable\":\"LinuxAHUBDisabled-Tag\",\"rightTable\":\"API-Get_VM_SKU\",\"leftColumn\":\"VMSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[LinuxAHUBDisabled-Tag].LinuxId\",\"mergedName\":\"LinuxId\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled-Tag].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled-Tag].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled-Tag].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled-Tag].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled-Tag].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBDisabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"8a27a7d8-5ea8-4408-ac20-2fc4e65ca095\"},{\"originalName\":\"[LinuxAHUBEnabled].VMName\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\"},{\"originalName\":\"[API-Get_VM_SKU].Name\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\"},{\"originalName\":\"[LinuxAHUBEnabled].VMSSize\"},{\"originalName\":\"[LinuxAHUBDisabled-Tag].VMName\"},{\"originalName\":\"[LinuxAHUBDisabled-Tag].VMSSize\"}]}",
                        "size": 0,
                        "title": "Linux VMs without AHUB",
                        "noDataMessage": "None of your Linux VMs have AHUB enabled",
                        "noDataMessageStyle": 4,
                        "showExportToExcel": true,
                        "queryType": 7,
                        "gridSettings": {
                          "formatters": [
                            {
                              "columnMatch": "Prioritize AHUB?",
                              "formatter": 18,
                              "formatOptions": {
                                "thresholdsOptions": "icons",
                                "thresholdsGrid": [
                                  {
                                    "operator": "==",
                                    "thresholdValue": "High Priority",
                                    "representation": "Sev0",
                                    "text": "{0}{1}"
                                  },
                                  {
                                    "operator": "Default",
                                    "thresholdValue": null,
                                    "representation": "Sev4",
                                    "text": "{0}{1}"
                                  }
                                ]
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal"
                                }
                              }
                            }
                          ]
                        },
                        "tileSettings": {
                          "showBorder": false,
                          "titleContent": {
                            "columnMatch": "NewLicense",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "vCPUs",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "maximumSignificantDigits": 3,
                                "maximumFractionDigits": 2
                              }
                            }
                          }
                        },
                        "chartSettings": {
                          "xAxis": "VM Name",
                          "yAxis": [
                            "Consumed Cores per VM"
                          ],
                          "group": null,
                          "createOtherGroup": 0,
                          "seriesLabelSettings": [
                            {
                              "seriesName": "Consumed Cores per VM",
                              "color": "grayBlue"
                            }
                          ]
                        }
                      },
                      "conditionalVisibility": {
                        "parameterName": "LinuxAHUBDisabled",
                        "comparison": "isEqualTo",
                        "value": "Yes"
                      },
                      "name": "Linux-VM+SKU+vCores-AHUBDisabled"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26168\",\"mergeType\":\"inner\",\"leftTable\":\"Linux VM Latest Change Last 7 days\",\"rightTable\":\"Linux-VM+SKU+vCores-AHUB\",\"leftColumn\":\"VMID\",\"rightColumn\":\"LinuxId\"}],\"projectRename\":[{\"originalName\":\"[Linux VM Latest Change Last 7 days].VMID\",\"mergedName\":\"VMID\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux VM Latest Change Last 7 days].NewLicense\",\"mergedName\":\"NewLicense\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux VM Latest Change Last 7 days].DateofChange\",\"mergedName\":\"DateofChange\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].LinuxId\",\"mergedName\":\"LinuxId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26168\"},{\"originalName\":\"[Linux VM Latest Change Last 7 days].VMID\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].vCPUs\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].OSType\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].OsVersion\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].LicenseType\"},{\"originalName\":\"[Linux-VM+SKU+vCores-AHUB].vCPUsPerCore\"}]}",
                        "size": 0,
                        "title": "Linux Total Cores Enabled last 7 Days",
                        "noDataMessage": "No AHUB has been enabled in the last 7 days.",
                        "showExportToExcel": true,
                        "queryType": 7,
                        "visualization": "table",
                        "tileSettings": {
                          "showBorder": false,
                          "titleContent": {
                            "columnMatch": "NewLicense",
                            "formatter": 1
                          },
                          "leftContent": {
                            "columnMatch": "vCPUs",
                            "formatter": 12,
                            "formatOptions": {
                              "palette": "auto"
                            },
                            "numberFormat": {
                              "unit": 17,
                              "options": {
                                "maximumSignificantDigits": 3,
                                "maximumFractionDigits": 2
                              }
                            }
                          }
                        },
                        "chartSettings": {
                          "group": null,
                          "createOtherGroup": 0,
                          "seriesLabelSettings": [
                            {
                              "seriesName": "Consumed Cores per VM",
                              "color": "grayBlue"
                            }
                          ]
                        }
                      },
                      "conditionalVisibility": {
                        "parameterName": "LinuxEnabledPast7D",
                        "comparison": "isEqualTo",
                        "value": "Yes"
                      },
                      "name": "Linux Total Cores Enabled last 7 Days"
                    }
                  ]
                },
                "conditionalVisibilities": [
                  {
                    "parameterName": "SelectedSubTab",
                    "comparison": "isEqualTo",
                    "value": "LinuxVM"
                  },
                  {
                    "parameterName": "SelectedTab",
                    "comparison": "isEqualTo",
                    "value": "VM"
                  },
                  {
                    "parameterName": "RG_Filter",
                    "comparison": "isEqualTo",
                    "value": "Tags"
                  }
                ],
                "name": "Linux - Tag "
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "title": "VMSS",
                  "loadType": "explicit",
                  "loadButtonText": "Load VMSS Recommendations",
                  "items": [
                    {
                      "type": 1,
                      "content": {
                        "json": "## Windows Azure Hybrid Benefit (AHUB) Overview - VM Scale Set"
                      },
                      "name": "text - 3"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "Each two-processor license or each set of 16-core licenses, either Datacenter or Standard editions, are entitled to two instances of up to 8 cores, or one instance of up to 16 cores.\r\n\r\nThe virtual machines (VMs) with less than 8 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                        "style": "info"
                      },
                      "name": "text - 4"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualMachineScaleSets'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows' or tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType) == 'Windows'\r\n| where tostring(properties.['licenseType']) !has 'Windows' and tostring(properties.virtualMachineProfile.['licenseType']) !has 'Windows'\r\n| extend WindowsId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType), OsVersion = tostring(properties.virtualMachineProfile.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.virtualMachineProfile.licenseType), VMSSize=tostring(sku.name)\r\n    ) on subscriptionId \r\n| order by type asc \r\n| project WindowsId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType, subscriptionId",
                        "size": 0,
                        "title": "VMSS-AHUB-Disabled",
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "AlwaysHidden",
                        "comparison": "isEqualTo",
                        "value": "true"
                      },
                      "name": "VMSS-AHUB-Disabled-Tag"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where isnotempty(tags) and isnotnull(tags)\r\n| mvexpand tags\r\n| extend tagName = tostring(bag_keys(tags)[0])\r\n| extend tagValue = tostring(tags[tagName])\r\n| where tagName has '{TagName}' and tagValue has '{TagValue}'\r\n| where type =~ 'microsoft.compute/virtualMachineScaleSets'\r\n| where tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType) == 'Windows' and tostring(properties.virtualMachineProfile.licenseType) == \"Windows_Server\"\r\n| extend WindowsId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType), OSVersion = tostring(properties.virtualMachineProfile.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.virtualMachineProfile.licenseType), VMSSize=tostring(sku.name)\r\n    ) on subscriptionId \r\n| order by type asc \r\n| project WindowsId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OSVersion,LicenseType, subscriptionId",
                        "size": 0,
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ]
                      },
                      "conditionalVisibility": {
                        "parameterName": "AlwaysHidden",
                        "comparison": "isEqualTo",
                        "value": "true"
                      },
                      "name": "VMSSAHUBEnabled-Tag"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{SingleSubHidden}/providers/Microsoft.Compute/skus?$filter=location eq '{Location}'\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2021-07-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.*[?(@.resourceType=='virtualMachines')]\",\"columns\":[{\"path\":\"name\",\"columnid\":\"Name\"},{\"path\":\"capabilities[?(@.name=='vCPUs')].value\",\"columnid\":\"vCPUs\"},{\"path\":\"capabilities[?(@.name=='MemoryGB')].value\",\"columnid\":\"MemoryGB\"},{\"path\":\"capabilities[?(@.name=='MaxNetworkInterfaces')].value\",\"columnid\":\"MaxNetworkInterfaces\"},{\"path\":\"capabilities[?(@.name=='HyperVGenerations')].value\",\"columnid\":\"HyperVGenerations\"},{\"path\":\"capabilities[?(@.name=='vCPUsPerCore')].value\",\"columnid\":\"vCPUsPerCore\"}]}}]}",
                        "size": 0,
                        "title": "Get VM vCPU",
                        "exportParameterName": "ResourceSKU",
                        "showExportToExcel": true,
                        "queryType": 12,
                        "gridSettings": {
                          "rowLimit": 5000
                        }
                      },
                      "conditionalVisibility": {
                        "parameterName": "AlwaysHidden",
                        "comparison": "isEqualTo",
                        "value": "true"
                      },
                      "name": "API-Get_VMSS_SKU"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "### Consumed Licenses\r\nTotal number of Windows licenses cores consumed by all Windows virtual machines.\r\n",
                        "style": "info"
                      },
                      "customWidth": "50",
                      "name": "text - 6"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "### Number of required Cores to enable Windows Azure Hybrid Benefit\r\nNumber of cores required to enable AHUB across the entire environment.",
                        "style": "info"
                      },
                      "customWidth": "50",
                      "name": "text - 7"
                    },
                    {
                      "type": 12,
                      "content": {
                        "version": "NotebookGroup/1.0",
                        "groupType": "editable",
                        "loadType": "explicit",
                        "loadButtonText": "Load VMSS Info",
                        "items": [
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBEnabled-Tag\",\"rightTable\":\"API-Get_VMSS_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\" ([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].OSVersion\",\"mergedName\":\"OSVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"}]}",
                              "size": 0,
                              "title": "Cores not enabled per AHUB Priority",
                              "noDataMessage": "All of your VMs have AHUB enabled",
                              "noDataMessageStyle": 4,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "Sev4",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal"
                                      }
                                    }
                                  }
                                ]
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "Consumed Cores per VM"
                                ],
                                "group": "Prioritize AHUB?",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "name": "Cores NOT enabled per AHUB Priority"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBEnabled-Tag\",\"rightTable\":\"API-Get_VMSS_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\" ([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].OSVersion\",\"mergedName\":\"OSVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"}]}",
                              "size": 0,
                              "title": "Consumed Cores per AHUB Priority",
                              "noDataMessage": "None of your VMs have AHUB enabled",
                              "noDataMessageStyle": 4,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "Sev4",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal"
                                      }
                                    }
                                  }
                                ]
                              }
                            },
                            "customWidth": "33",
                            "name": "Consumed Cores per AHUB Priority"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26130\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBEnabled-Tag\",\"rightTable\":\"API-Get_VMSS_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"ConsumedCores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].OSVersion\",\"mergedName\":\"OSVersion\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VMSS_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VMSS_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VMSS_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VMSS_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VMSS_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VMSS_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"}]}",
                              "size": 0,
                              "title": "Consumed Cores per VMSS",
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "ConsumedCores",
                                    "formatter": 0,
                                    "formatOptions": {
                                      "aggregation": "Sum"
                                    }
                                  }
                                ]
                              },
                              "tileSettings": {
                                "titleContent": {},
                                "leftContent": {
                                  "columnMatch": "ConsumedCores",
                                  "formatter": 12,
                                  "formatOptions": {
                                    "palette": "blue"
                                  }
                                },
                                "showBorder": false
                              },
                              "graphSettings": {
                                "type": 0
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "ConsumedCores"
                                ],
                                "group": "VMName",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "name": "Consumed Cores per VMSS"
                          }
                        ]
                      },
                      "name": "VMSS RG Overview"
                    },
                    {
                      "type": 12,
                      "content": {
                        "version": "NotebookGroup/1.0",
                        "groupType": "editable",
                        "loadType": "explicit",
                        "loadButtonText": "Load VMSS AHUB Details",
                        "items": [
                          {
                            "type": 9,
                            "content": {
                              "version": "KqlParameterItem/1.0",
                              "parameters": [
                                {
                                  "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "VMSSAHUBEnabled",
                                  "label": "See VMSS with AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                                  "timeContext": {
                                    "durationMs": 86400000
                                  },
                                  "value": "Yes"
                                },
                                {
                                  "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "VMSSAHUBDisabled",
                                  "label": "See VMSS without AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                                  "value": "Yes"
                                }
                              ],
                              "style": "pills",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            "name": "parameters - 13"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBEnabled-Tag\",\"rightTable\":\"API-Get_VM_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"static\",\"resultVal\":\"High Priority\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"Low Priority\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[VMSSAHUBEnabled-Tag].WindowsId\",\"mergedName\":\"VMSS Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].OSVersion\",\"mergedName\":\"OSVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMName\"},{\"originalName\":\"[query - 0].VMSSize\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"},{\"originalName\":\"[WindowsAHUBEnabled].VMName\"},{\"originalName\":\"[VMSSAHUBEnabled].VMSize\"},{\"originalName\":\"[VMSSAHUBEnabled].VMName\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMName\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSize\"}]}",
                              "size": 0,
                              "title": "VMSS with AHUB",
                              "noDataMessage": "None of your VMSS have AHUB enabled",
                              "noDataMessageStyle": 4,
                              "showExportToExcel": true,
                              "queryType": 7,
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "$gen_group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "2",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal"
                                      }
                                    }
                                  },
                                  {
                                    "columnMatch": "subscriptionId",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Subscription Name",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  }
                                ],
                                "hierarchySettings": {
                                  "treeType": 1,
                                  "groupBy": [
                                    "subscriptionId"
                                  ],
                                  "expandTopLevel": true
                                }
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "VMSSAHUBEnabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "name": "VMSS+SKU+vCores-AHUB"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"VMSS-AHUB-Disabled-Tag\",\"rightTable\":\"API-Get_VMSS_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"static\",\"resultVal\":\"High Priority\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"Low Priority\"}}]},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VMSS_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMName\"},{\"originalName\":\"[query - 0].VMSSize\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[VMSS-AHUB-Disabled].VMName\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMSize\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMName\"}]}",
                              "size": 0,
                              "title": "VMSS without AHUB",
                              "noDataMessage": "All of your VMSS have AHUB enabled",
                              "noDataMessageStyle": 3,
                              "showExportToExcel": true,
                              "queryType": 7,
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "$gen_group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "Sev4",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal"
                                      }
                                    }
                                  }
                                ],
                                "hierarchySettings": {
                                  "treeType": 1,
                                  "groupBy": [
                                    "subscriptionId"
                                  ],
                                  "expandTopLevel": true
                                }
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "VMSSAHUBDisabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "name": "VMSS+SKU+vCores"
                          }
                        ]
                      },
                      "name": "VMSS RG Details"
                    }
                  ]
                },
                "conditionalVisibilities": [
                  {
                    "parameterName": "SelectedSubTab",
                    "comparison": "isEqualTo",
                    "value": "VMSS"
                  },
                  {
                    "parameterName": "SelectedTab",
                    "comparison": "isEqualTo",
                    "value": "VM"
                  },
                  {
                    "parameterName": "RG_Filter",
                    "comparison": "isEqualTo",
                    "value": "Tags"
                  }
                ],
                "name": "VMSS-Tag"
              },
              {
                "type": 12,
                "content": {
                  "version": "NotebookGroup/1.0",
                  "groupType": "editable",
                  "title": "VMSS",
                  "items": [
                    {
                      "type": 1,
                      "content": {
                        "json": "## Windows Azure Hybrid Benefit (AHUB) Overview - VM Scale Set"
                      },
                      "name": "text - 3"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "Each two-processor license or each set of 16-core licenses, either Datacenter or Standard editions, are entitled to two instances of up to 8 cores, or one instance of up to 16 cores.\r\n\r\nThe virtual machines (VMs) with less than 8 cores are categorized as **Low Priority**, while those with 8 or more cores are classified as **High Priority**. In situations where there are insufficient Azure Hybrid benefit licenses to cover all the VMs in the environment, it is recommended to prioritize the High Priority VMs.",
                        "style": "info"
                      },
                      "name": "text - 4"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualMachineScaleSets'\r\n| where tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType) == 'Windows' and tostring(properties.virtualMachineProfile.licenseType) == \"Windows_Server\"\r\n| extend WindowsId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType), OSVersion = tostring(properties.virtualMachineProfile.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.virtualMachineProfile.licenseType), VMSSize=tostring(sku.name)\r\n    ) on subscriptionId \r\n| order by type asc \r\n| project WindowsId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OSVersion,LicenseType, subscriptionId",
                        "size": 0,
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ]
                      },
                      "conditionalVisibilities": [
                        {
                          "parameterName": "LoadVMSSTab",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "True"
                        }
                      ],
                      "name": "VMSSAHUBEnabled-RG"
                    },
                    {
                      "type": 3,
                      "content": {
                        "version": "KqlItem/1.0",
                        "query": "ResourceContainers | where type =~ 'Microsoft.Resources/subscriptions' | extend SubscriptionName=name \r\n| join (\r\nresources \r\n| where resourceGroup in ({ResourceGroup})\r\n| where type =~ 'microsoft.compute/virtualMachineScaleSets'\r\n| where tostring(properties.storageProfile.osDisk.osType) == 'Windows' or tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType) == 'Windows'\r\n| where tostring(properties.['licenseType']) !has 'Windows' and tostring(properties.virtualMachineProfile.['licenseType']) !has 'Windows'\r\n| extend WindowsId=id, VMName=name, VMLocation=location, VMRG=resourceGroup, OSType=tostring(properties.virtualMachineProfile.storageProfile.osDisk.osType), OsVersion = tostring(properties.virtualMachineProfile.storageProfile.imageReference.sku), VMSize=tostring (properties.hardwareProfile.vmSize), LicenseType = tostring(properties.virtualMachineProfile.licenseType), VMSSize=tostring(sku.name)\r\n    ) on subscriptionId \r\n| order by type asc \r\n| project WindowsId,VMName,VMRG,VMSize, VMSSize, VMLocation,OSType, OsVersion,LicenseType, subscriptionId",
                        "size": 0,
                        "queryType": 1,
                        "resourceType": "microsoft.resourcegraph/resources",
                        "crossComponentResources": [
                          "{Subscription}"
                        ]
                      },
                      "conditionalVisibilities": [
                        {
                          "parameterName": "LoadVMSSTab",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        {
                          "parameterName": "AlwaysHidden",
                          "comparison": "isEqualTo",
                          "value": "True"
                        }
                      ],
                      "name": "VMSSAHUBDisabled-RG"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "### Consumed Licenses\r\nTotal number of Windows licenses cores consumed by all Windows virtual machines.\r\n",
                        "style": "info"
                      },
                      "customWidth": "50",
                      "name": "text - 6"
                    },
                    {
                      "type": 1,
                      "content": {
                        "json": "### Number of required Cores to enable Windows Azure Hybrid Benefit\r\nNumber of cores required to enable AHUB across the entire environment.",
                        "style": "info"
                      },
                      "customWidth": "50",
                      "name": "text - 7"
                    },
                    {
                      "type": 12,
                      "content": {
                        "version": "NotebookGroup/1.0",
                        "groupType": "editable",
                        "loadType": "explicit",
                        "loadButtonText": "Load VMSS Info",
                        "items": [
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBEnabled-RG\",\"rightTable\":\"API-Get_VM_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\" ([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].OSVersion\",\"mergedName\":\"OSVersion\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"unknown\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"unknown\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"unknown\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"unknown\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"unknown\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"unknown\"},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"}]}",
                              "size": 0,
                              "title": "Cores not enabled per AHUB Priority",
                              "noDataMessage": "All of your VMs have AHUB enabled",
                              "noDataMessageStyle": 4,
                              "showRefreshButton": true,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "Sev4",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal"
                                      }
                                    }
                                  }
                                ]
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "Consumed Cores per VM"
                                ],
                                "group": "Prioritize AHUB?",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "name": "Cores NOT enabled per AHUB Priority"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBEnabled-RG\",\"rightTable\":\"API-Get_VM_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"High Priority\\\"\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"\\\"Low Priority\\\"\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\" ([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].OSVersion\",\"mergedName\":\"OSVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[WindowsAHUBEnabled].WindowsId\"},{\"originalName\":\"[WindowsAHUBEnabled].VMRG\"},{\"originalName\":\"[WindowsAHUBEnabled].VMLocation\"},{\"originalName\":\"[WindowsAHUBEnabled].OSType\"},{\"originalName\":\"[WindowsAHUBEnabled].OsVersion\"},{\"originalName\":\"[WindowsAHUBEnabled].LicenseType\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"}]}",
                              "size": 0,
                              "title": "Consumed Cores per AHUB Priority",
                              "noDataMessage": "None of your VMs have AHUB enabled",
                              "noDataMessageStyle": 4,
                              "showRefreshButton": true,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "Sev4",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal"
                                      }
                                    }
                                  }
                                ]
                              }
                            },
                            "customWidth": "33",
                            "name": "Consumed Cores per AHUB Priority"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d8deb22b-a596-43ee-acc4-180849d26130\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBEnabled-RG\",\"rightTable\":\"API-Get_VM_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[Added column]\",\"mergedName\":\"ConsumedCores\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].OSVersion\",\"mergedName\":\"OSVersion\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"d8deb22b-a596-43ee-acc4-180849d26130\"}]}",
                              "size": 0,
                              "title": "Consumed Cores per VMSS",
                              "showRefreshButton": true,
                              "queryType": 7,
                              "visualization": "piechart",
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "ConsumedCores",
                                    "formatter": 0,
                                    "formatOptions": {
                                      "aggregation": "Sum"
                                    }
                                  }
                                ]
                              },
                              "tileSettings": {
                                "titleContent": {},
                                "leftContent": {
                                  "columnMatch": "ConsumedCores",
                                  "formatter": 12,
                                  "formatOptions": {
                                    "palette": "blue"
                                  }
                                },
                                "showBorder": false
                              },
                              "graphSettings": {
                                "type": 0
                              },
                              "chartSettings": {
                                "yAxis": [
                                  "ConsumedCores"
                                ],
                                "group": "VMName",
                                "createOtherGroup": null
                              }
                            },
                            "customWidth": "33",
                            "name": "Consumed Cores per VMSS"
                          }
                        ]
                      },
                      "name": "VMSS RG Overview"
                    },
                    {
                      "type": 12,
                      "content": {
                        "version": "NotebookGroup/1.0",
                        "groupType": "editable",
                        "items": [
                          {
                            "type": 9,
                            "content": {
                              "version": "KqlParameterItem/1.0",
                              "parameters": [
                                {
                                  "id": "ae5e8765-47ef-46a6-803b-6b7124c098d2",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "VMSSAHUBEnabled",
                                  "label": "See VMSS with AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n",
                                  "timeContext": {
                                    "durationMs": 86400000
                                  }
                                },
                                {
                                  "id": "f1ac5e53-253c-4afb-8bc5-b1ba2efea3eb",
                                  "version": "KqlParameterItem/1.0",
                                  "name": "VMSSAHUBDisabled",
                                  "label": "See VMSS without AHUB",
                                  "type": 2,
                                  "isRequired": true,
                                  "typeSettings": {
                                    "additionalResourceOptions": [],
                                    "showDefault": false
                                  },
                                  "jsonData": "[\r\n    {\"value\":\"Yes\"},\r\n    {\"value\":\"No\", \"selected\":true}\r\n]\r\n\r\n"
                                }
                              ],
                              "style": "pills",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            "name": "parameters - 13"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBEnabled-RG\",\"rightTable\":\"API-Get_VM_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[WindowsAHUBEnabled].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"static\",\"resultVal\":\"High Priority\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"Low Priority\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Consumed Cores per VM\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\"<=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"expression\",\"resultVal\":\"8\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"expression\",\"resultVal\":\"([\\\"vCPUs\\\"] + 7) & ~7\"}}]},{\"originalName\":\"[VMSSAHUBEnabled-RG].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].OSVersion\",\"mergedName\":\"OSVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBEnabled-RG].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMName\"},{\"originalName\":\"[query - 0].VMSSize\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[WindowsAHUBEnabled].VMSSize\"},{\"originalName\":\"[WindowsAHUBEnabled].VMName\"},{\"originalName\":\"[VMSSAHUBEnabled].VMSize\"},{\"originalName\":\"[VMSSAHUBEnabled].VMName\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMName\"},{\"originalName\":\"[VMSSAHUBEnabled-Tag].VMSize\"}]}",
                              "size": 0,
                              "title": "VMSS with AHUB",
                              "noDataMessage": "None of your VMSS have AHUB enabled",
                              "noDataMessageStyle": 4,
                              "showExportToExcel": true,
                              "queryType": 7,
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "$gen_group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "2",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal"
                                      }
                                    }
                                  },
                                  {
                                    "columnMatch": "subscriptionId",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Subscription Name",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  }
                                ],
                                "hierarchySettings": {
                                  "treeType": 1,
                                  "groupBy": [
                                    "subscriptionId"
                                  ],
                                  "expandTopLevel": true
                                }
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "VMSSAHUBEnabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "name": "VMSS+SKU+vCores-AHUB"
                          },
                          {
                            "type": 3,
                            "content": {
                              "version": "KqlItem/1.0",
                              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"50d79765-aad4-437e-a90b-8cc7865e7081\",\"mergeType\":\"inner\",\"leftTable\":\"VMSSAHUBDisabled-RG\",\"rightTable\":\"API-Get_VM_SKU\",\"leftColumn\":\"VMSSize\",\"rightColumn\":\"Name\"}],\"projectRename\":[{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[query - 0].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"unknown\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Prioritize AHUB?\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"vCPUs\",\"operator\":\">=\",\"rightValType\":\"static\",\"rightVal\":\"8\",\"resultValType\":\"static\",\"resultVal\":\"High Priority\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"Low Priority\"}}]},{\"originalName\":\"[VMSSAHUBDisabled-RG].WindowsId\",\"mergedName\":\"WindowsId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].VMName\",\"mergedName\":\"VMName\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].VMRG\",\"mergedName\":\"VMRG\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].VMSize\",\"mergedName\":\"VMSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].VMSSize\",\"mergedName\":\"VMSSize\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].VMLocation\",\"mergedName\":\"VMLocation\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].OSType\",\"mergedName\":\"OSType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].OsVersion\",\"mergedName\":\"OsVersion\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].LicenseType\",\"mergedName\":\"LicenseType\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[VMSSAHUBDisabled-RG].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].Name\",\"mergedName\":\"Name\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUs\",\"mergedName\":\"vCPUs\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].MemoryGB\",\"mergedName\":\"MemoryGB\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].MaxNetworkInterfaces\",\"mergedName\":\"MaxNetworkInterfaces\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].HyperVGenerations\",\"mergedName\":\"HyperVGenerations\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[API-Get_VM_SKU].vCPUsPerCore\",\"mergedName\":\"vCPUsPerCore\",\"fromId\":\"50d79765-aad4-437e-a90b-8cc7865e7081\"},{\"originalName\":\"[query - 0].VMName\"},{\"originalName\":\"[query - 0].VMSSize\"},{\"originalName\":\"[query - Get VM vCPU].Name\"},{\"originalName\":\"[query - Get VM vCPU].MemoryGB\"},{\"originalName\":\"[query - Get VM vCPU].MaxNetworkInterfaces\"},{\"originalName\":\"[query - Get VM vCPU].HyperVGenerations\"},{\"originalName\":\"[query - Get VM vCPU].vCPUsPerCore\"},{\"originalName\":\"[VMSS-AHUB-Disabled].VMName\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMSize\"},{\"originalName\":\"[VMSS-AHUB-Disabled-Tag].VMName\"}]}",
                              "size": 0,
                              "title": "VMSS without AHUB",
                              "noDataMessage": "All of your VMSS have AHUB enabled",
                              "noDataMessageStyle": 3,
                              "showExportToExcel": true,
                              "queryType": 7,
                              "gridSettings": {
                                "formatters": [
                                  {
                                    "columnMatch": "$gen_group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Group",
                                    "formatter": 15,
                                    "formatOptions": {
                                      "linkTarget": null,
                                      "showIcon": true
                                    }
                                  },
                                  {
                                    "columnMatch": "Prioritize AHUB?",
                                    "formatter": 18,
                                    "formatOptions": {
                                      "thresholdsOptions": "icons",
                                      "thresholdsGrid": [
                                        {
                                          "operator": "==",
                                          "thresholdValue": "High Priority",
                                          "representation": "Sev0",
                                          "text": "{0}{1}"
                                        },
                                        {
                                          "operator": "Default",
                                          "thresholdValue": null,
                                          "representation": "Sev4",
                                          "text": "{0}{1}"
                                        }
                                      ]
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "style": "decimal"
                                      }
                                    }
                                  }
                                ],
                                "hierarchySettings": {
                                  "treeType": 1,
                                  "groupBy": [
                                    "subscriptionId"
                                  ],
                                  "expandTopLevel": true
                                }
                              }
                            },
                            "conditionalVisibility": {
                              "parameterName": "VMSSAHUBDisabled",
                              "comparison": "isEqualTo",
                              "value": "Yes"
                            },
                            "name": "VMSS+SKU+vCores"
                          }
                        ]
                      },
                      "name": "VMSS RG Details"
                    }
                  ]
                },
                "conditionalVisibilities": [
                  {
                    "parameterName": "SelectedSubTab",
                    "comparison": "isEqualTo",
                    "value": "VMSS"
                  },
                  {
                    "parameterName": "SelectedTab",
                    "comparison": "isEqualTo",
                    "value": "VM"
                  },
                  {
                    "parameterName": "RG_Filter",
                    "comparison": "isEqualTo",
                    "value": "Resource Group"
                  }
                ],
                "name": "VMSS-RG"
              }
            ]
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "AHUB"
          },
          "name": "AHUB Overview"
        }
      ],
      "fallbackResourceIds": [
        "Azure Monitor"
      ],
      "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
    },
    "version": "",
    "workbookJson": "[string(variables('$fxv#0'))]"
  },
  "resources": [
    {
      "type": "Microsoft.Insights/workbooks",
      "apiVersion": "2022-04-01",
      "name": "[guid(resourceGroup().id, 'Microsoft.Insights/workbooks', parameters('displayName'))]",
      "location": "[parameters('location')]",
      "tags": "[parameters('tags')]",
      "kind": "shared",
      "properties": {
        "category": "workbook",
        "description": "[parameters('description')]",
        "displayName": "[parameters('displayName')]",
        "serializedData": "[variables('workbookJson')]",
        "sourceId": "Azure Monitor",
        "version": "[variables('version')]"
      }
    }
  ],
  "outputs": {
    "workbookId": {
      "type": "string",
      "metadata": {
        "description": "The resource ID of the workbook."
      },
      "value": "[resourceId('Microsoft.Insights/workbooks', guid(resourceGroup().id, 'Microsoft.Insights/workbooks', parameters('displayName')))]"
    },
    "workbookUrl": {
      "type": "string",
      "metadata": {
        "description": "Link to the workbook in the Azure portal."
      },
      "value": "[format('{0}/#view/AppInsightsExtension/UsageNotebookBlade/ComponentId/Azure%20Monitor/ConfigurationId/{1}/Type/{2}/WorkbookTemplateName/{3}', environment().portal, uriComponent(resourceId('Microsoft.Insights/workbooks', guid(resourceGroup().id, 'Microsoft.Insights/workbooks', parameters('displayName')))), reference(resourceId('Microsoft.Insights/workbooks', guid(resourceGroup().id, 'Microsoft.Insights/workbooks', parameters('displayName'))), '2022-04-01').category, uriComponent(reference(resourceId('Microsoft.Insights/workbooks', guid(resourceGroup().id, 'Microsoft.Insights/workbooks', parameters('displayName'))), '2022-04-01').displayName))]"
    }
  }
}