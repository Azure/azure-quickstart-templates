{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "networkFabricControllerName": {
      "value": "controllerName"
    },
    "nfcResourceGroupName": {
      "value": "<NFCResourceGroupName>"
    },
    "nfcInfraExRCircuitId": {
      "value": "/subscriptions/xxxxxx-xxxxxx-xxxx-xxxx-xxxxxx/resourceGroups/ER-Dedicated-WUS2-AFO-Circuits/providers/Microsoft.Network/expressRouteCircuits/MSFT-ER-Dedicated-PvtPeering-WestUS2-AFO-Ckt-01"
    },
    "nfcInfraExRAuthKey": {
      "value": "<auth-key>"
    },
    "nfcWorkloadExRCircuitId": {
      "value": "/subscriptions/xxxxxx-xxxxxx-xxxx-xxxx-xxxxxx/resourceGroups/ER-Dedicated-WUS2-AFO-Circuits/providers/Microsoft.Network/expressRouteCircuits/MSFT-ER-Dedicated-PvtPeering-WestUS2-AFO-Ckt-01"
    },
    "nfcWorkloadExRAuthKey": {
      "value": "<auth-key>"
    },
    "nfcIpv4AddressSpace": {
      "value": ""
    },
    "networkFabricName": {
      "value": "fabricName"
    },
    "networkFabricSku": {
      "value": "fab1"
    },
    "rackCount": {
      "value": 3
    },
    "serverCountPerRack": {
      "value": 5
    },
    "ipv4Prefix": {
      "value": "20.1.0.0/19"
    },
    "ipv6Prefix": {
      "value": "3FFE:FFFF:0:CD40::/59"
    },
    "fabricASN": {
      "value": 61234
    },
    "nfTSconfUsername": {
      "value": "root"
    },
    "nfTSconfPassword": {
      "value": "ABcdef12!!@"
    },
    "nfTSconfSerialNumber": {
      "value": "123456"
    },
    "nfTSconfPrimaryIpv4Prefix": {
      "value": "20.0.0.1/29"
    },
    "nfTSconfPrimaryIpv6Prefix": {
      "value": ""
    },
    "nfTSconfSecondaryIpv4Prefix": {
      "value": "20.0.1.1/29"
    },
    "nfTSconfSecondaryIpv6Prefix": {
      "value": ""
    },
    "nfMNconfInfraVpn": {
      "value": {
        "peeringOption": "OptionB",
        "optionBProperties": {
          "importRouteTargets": [
            "65023:11139"
          ],
          "exportRouteTargets": [
            "65023:11139"
          ]
        }
      }
    },
    "nfMNconfWorkloadVpn": {
      "value": {
        "peeringOption": "OptionB",
        "optionBProperties": {
          "importRouteTargets": [
            "65023:11139"
          ],
          "exportRouteTargets": [
            "65023:11139"
          ]
        }
      }
    },
    "nniMap": {
      "value": {
        "nniName1": {
          "properties": {
            "isManagementType": "True",
            "useOptionB": "True",
            "layer2Configuration": {
              "portCount": 3,
              "mtu": 1500
            },
            "layer3Configuration": {
              "importRoutePolicyId": "<importRoutePolicyId>",
              "exportRoutePolicyId": "<exportRoutePolicyId>",
              "peerASN": 65535,
              "vlanId": 600,
              "primaryIpv4Prefix": "172.31.0.0/31",
              "secondaryIpv4Prefix": "172.31.0.20/31"
            }
          }
        }
      }
    },
    "deviceMap": {
      "value": {
        "fabricName-AggrRack-CE1": "XXXX;XXX-XXXXXX-XX;XXXX;XXXXX",
        "fabricName-AggrRack-CE2": "XXXX;XXX-XXXXXX-XX;XXXX;XXXXX",
        "fabricName-AggrRack-MgmtSwitch1": "XXXX;XXX-XXXXXX-XX;XXXX;XXXXX",
        "fabricName-CompRack1-TOR1": "XXXX;XXX-XXXXXX-XX;XXXX;XXXXX",
        "fabricName-CompRack1-TOR2": "XXXX;XXX-XXXXXX-XX;XXXX;XXXXX",
        "fabricName-CompRack1-MgmtSwitch": "XXXX;XXX-XXXXXX-XX;XXXX;XXXXX",
        "fabricName-CompRack2-TOR3": "XXXX;XXX-XXXXXX-XX;XXXX;XXXXX",
        "fabricName-CompRack2-TOR4": "XXXX;XXX-XXXXXX-XX;XXXX;XXXXX",
        "fabricName-CompRack2-MgmtSwitch": "XXXX;XXX-XXXXXX-XX;XXXX;XXXXX",
        "fabricName-AggrRack-MgmtSwitch2": "XXXX;XXX-XXXXXX-XX;XXXX;XXXXX",
        "fabricName-AggrRack-TOR17": "XXXX;XXX-XXXXXX-XX;XXXX;XXXXX",
        "fabricName-AggrRack-TOR18": "XXXX;XXX-XXXXXX-XX;XXXX;XXXXX",
        "fabricName-AggrRack-NPB1": "XXXX;XXX-XXXXXX-XX;XXXX;XXXXX",
        "fabricName-AggrRack-NPB2": "XXXX;XXX-XXXXXX-XX;XXXX;XXXXX"
      }
    },
    "userIdentityName": {
      "value": "userIdentityName"
    },
    "roleAssignmentName": {
      "value": "<roleAssignmentName>"
    },
    "wheelFileURL": {
      "value": "https://aodscli.blob.core.windows.net/azcli/managednetworkfabric-0.1.0.post26-py3-none-any.whl"
    },
    "deploymentScriptsName": {
      "value": "updateSerialNumber"
    },
    "l2Domain": {
      "value": {
        "l2DomainName1": {
          "properties": {
            "vlanId": 1053,
            "mtu": 1500
          }
        },
        "l2DomainName2": {
          "properties": {
            "vlanId": 1054,
            "mtu": 1501
          }
        },
        "l2DomainName3": {
          "properties": {
            "vlanId": 1055,
            "mtu": 1500
          }
        }
      }
    },
    "ISD": {
      "value": {
        "l3DomainName1": {
          "properties": {
            "redistributeConnectedSubnets": "True",
            "redistributeStaticRoutes": "True",
            "aggregateRouteConfiguration": {
              "ipv4Routes": [
                {
                  "prefix": "10.0.0.1"
                }
              ],
              "ipv6Routes": [
                {
                  "prefix": "2fff::/64"
                }
              ]
            },
            "connectedSubnetRoutePolicy": {
              "exportRoutePolicyId": "<exportRoutePolicyId>"
            }
          },
          "internalNetwork": [
            {
              "name": "InternalNetworkName1",
              "properties": {
                "vlanId": 625,
                "mtu": 1500,
                "connectedIPv4Subnets": [
                  {
                    "prefix": "20.20.2.0/24"
                  }
                ],
                "connectedIPv6Subnets": [
                  {
                    "prefix": "2fff::/64"
                  }
                ],
                "staticRouteConfiguration": {
                  "ipv4Routes": [
                    {
                      "prefix": "20.20.2.0/24",
                      "nextHop": [
                        "20.20.2.0"
                      ]
                    }
                  ],
                  "ipv6Routes": [
                    {
                      "prefix": "2fff::/64",
                      "nextHop": [
                        "2fff::"
                      ]
                    }
                  ]
                },
                "bgpConfiguration": {
                  "defaultRouteOriginate": "True",
                  "allowAS": 2,
                  "allowASOverride": "Enable",
                  "peerASN": 65510,
                  "ipv4ListenRangePrefixes": [
                    "10.0.0.1"
                  ],
                  "ipv6ListenRangePrefixes": [
                    "2fff::/64"
                  ],
                  "ipv4NeighborAddress": [
                    {
                      "address": "20.20.2.0"
                    }
                  ],
                  "ipv6NeighborAddress": [
                    {
                      "address": "2fff::"
                    }
                  ]
                },
                "importRoutePolicyId": "<importRoutePolicyId>",
                "exportRoutePolicyId": "<exportRoutePolicyId>"
              }
            },
            {
              "name": "InternalNetworkName2",
              "properties": {
                "vlanId": 615,
                "mtu": 1500,
                "connectedIPv4Subnets": [],
                "connectedIPv6Subnets": [
                  {
                    "prefix": "20:101:1::11/64"
                  }
                ],
                "staticRouteConfiguration": {
                  "ipv4Routes": [],
                  "ipv6Routes": [
                    {
                      "prefix": "2fff::/64",
                      "nextHop": [
                        "2fff::"
                      ]
                    }
                  ]
                },
                "bgpConfiguration": {
                  "defaultRouteOriginate": "True",
                  "allowAS": 2,
                  "allowASOverride": "Enable",
                  "peerASN": 65510,
                  "ipv4ListenRangePrefixes": [],
                  "ipv6ListenRangePrefixes": [
                    "2fff::/64"
                  ],
                  "ipv4NeighborAddress": [],
                  "ipv6NeighborAddress": [
                    {
                      "address": "20:101:1::11"
                    }
                  ]
                },
                "importRoutePolicyId": "<importRoutePolicyId>",
                "exportRoutePolicyId": "<exportRoutePolicyId>"
              }
            }
          ],
          "externalNetwork": [
            {
              "name": "ExternalNetworkName1",
              "properties": {
                "peeringOption": "OptionB",
                "optionAProperties": {
                  "mtu": 1500,
                  "vlanId": 501,
                  "peerASN": 65234,
                  "primaryIpv4Prefix": "",
                  "primaryIpv6Prefix": "20:101:1::11",
                  "secondaryIpv4Prefix": "",
                  "secondaryIpv6Prefix": "20:101:1::11"
                },
                "optionBProperties": {
                  "importRouteTargets": [
                    "100:200"
                  ],
                  "exportRouteTargets": [
                    "102:202"
                  ]
                },
                "importRoutePolicyId": "<importRoutePolicyId>",
                "exportRoutePolicyId": "<exportRoutePolicyId>"
              }
            }
          ]
        },
        "l3DomainName2": {
          "properties": {
            "redistributeConnectedSubnets": "True",
            "redistributeStaticRoutes": "True",
            "aggregateRouteConfiguration": {
              "ipv4Routes": [
                {
                  "prefix": "10.0.0.2"
                }
              ],
              "ipv6Routes": []
            },
            "connectedSubnetRoutePolicy": {
              "exportRoutePolicyId": "<exportRoutePolicyId>"
            }
          },
          "internalNetwork": [
            {
              "name": "InternalNetworkName3",
              "properties": {
                "vlanId": 626,
                "mtu": 1500,
                "connectedIPv4Subnets": [
                  {
                    "prefix": "20.20.2.0/24",
                    "annotation": ""
                  }
                ],
                "connectedIPv6Subnets": [],
                "staticRouteConfiguration": {
                  "ipv4Routes": [
                    {
                      "prefix": "20.20.2.0/24",
                      "nextHop": [
                        "20.20.2.0"
                      ]
                    }
                  ],
                  "ipv6Routes": []
                },
                "bgpConfiguration": {
                  "defaultRouteOriginate": "True",
                  "allowAS": 2,
                  "allowASOverride": "Enable",
                  "peerASN": 65510,
                  "ipv4ListenRangePrefixes": [
                    "10.0.0.1"
                  ],
                  "ipv6ListenRangePrefixes": [],
                  "ipv4NeighborAddress": [
                    {
                      "address": "20.20.2.0"
                    }
                  ],
                  "ipv6NeighborAddress": []
                },
                "importRoutePolicyId": "<importRoutePolicyId>",
                "exportRoutePolicyId": "<exportRoutePolicyId>"
              }
            }
          ],
          "externalNetwork": [
            {
              "name": "ExternalNetworkName2",
              "properties": {
                "peeringOption": "OptionB",
                "optionAProperties": {
                  "mtu": 1500,
                  "vlanId": 501,
                  "peerASN": 65234,
                  "primaryIpv4Prefix": "20.18.0.148/30",
                  "primaryIpv6Prefix": "20:101:1::11",
                  "secondaryIpv4Prefix": "20.18.0.148/30",
                  "secondaryIpv6Prefix": "20:101:1::11"
                },
                "optionBProperties": {
                  "importRouteTargets": [
                    "100:200"
                  ],
                  "exportRouteTargets": [
                    "102:202"
                  ]
                },
                "importRoutePolicyId": "<importRoutePolicyId>",
                "exportRoutePolicyId": "<exportRoutePolicyId>"
              }
            }
          ]
        },
        "l3DomainName3": {
          "properties": {
            "redistributeConnectedSubnets": "True",
            "redistributeStaticRoutes": "True",
            "aggregateRouteConfiguration": {
              "ipv4Routes": [],
              "ipv6Routes": [
                {
                  "prefix": "10.0.0.3"
                }
              ]
            },
            "connectedSubnetRoutePolicy": {
              "exportRoutePolicyId": "<exportRoutePolicyId>"
            }
          },
          "internalNetwork": [
            {
              "name": "InternalNetworkName4",
              "properties": {
                "vlanId": 627,
                "mtu": 1500,
                "connectedIPv4Subnets": [
                  {
                    "prefix": "20.30.20.10/24",
                    "annotation": ""
                  }
                ],
                "connectedIPv6Subnets": [],
                "staticRouteConfiguration": {},
                "bgpConfiguration": {},
                "importRoutePolicyId": "<importRoutePolicyId>",
                "exportRoutePolicyId": "<exportRoutePolicyId>"
              }
            }
          ],
          "externalNetwork": [
            {
              "name": "ExternalNetworkName3",
              "properties": {
                "peeringOption": "OptionB",
                "optionAProperties": {
                  "mtu": 1500,
                  "vlanId": 501,
                  "peerASN": 65234,
                  "primaryIpv4Prefix": "20.101.1.11",
                  "primaryIpv6Prefix": "",
                  "secondaryIpv4Prefix": "20.101.1.11",
                  "secondaryIpv6Prefix": ""
                },
                "optionBProperties": {
                  "importRouteTargets": [
                    "100:200"
                  ],
                  "exportRouteTargets": [
                    "102:202"
                  ]
                },
                "importRoutePolicyId": "<importRoutePolicyId>",
                "exportRoutePolicyId": "<exportRoutePolicyId>"
              }
            }
          ]
        }
      }
    }
  }
}