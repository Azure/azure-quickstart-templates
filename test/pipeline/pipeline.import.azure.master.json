{
    "triggers": [
        {
            "branchFilters": [
                "+master"
            ],
            "forks": {
                "enabled": true,
                "allowSecrets": true,
                "allowFullAccessToken": false
            },
            "pathFilters": [
                "-/test/*",
                "-/1-CONTRIBUTION-GUIDE/*",
                "-/.github/*"
            ],
            "requireCommentsForNonTeamMembersOnly": false,
            "isCommentRequiredForPullRequest": false,
            "triggerType": 64
        },
        {
            "schedules": [
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 0,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "7d4ea744-7034-4c9a-aa6a-9d534fdb32e1",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 1,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "0ca7e9ad-93d3-4869-98cd-324ac191d3bd",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 2,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "acd8ed62-b192-4ec7-b903-e73bafb51fe7",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 3,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "a0c1a5c8-256e-4e53-b480-6f1b56c14e0e",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 4,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "bc1cd744-0fbf-4afa-90f7-68e3b523ed79",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 5,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "cc055c5b-3436-4944-806c-bfe8da686b70",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 6,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "32ac8ac1-6347-4ec4-8d43-d734ffd61fae",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 7,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "7ee92b42-d821-415f-9f23-8a665aafc7ac",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 8,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "3829102b-dc0d-45fc-89ea-45bc8a555d2f",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 9,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "e25e603e-3582-4c9d-bbce-bd0cc56bf032",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 10,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "c41431e6-30d8-4f06-acf0-6b1c26d5bba3",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 11,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "506b315e-a3f4-43b8-88fb-d0304c10cea4",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 12,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "0ff2fe49-80a6-46a4-ba3d-064315857834",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 13,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "39e6e8e4-5c14-4e67-8fe6-5ac9908d1241",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 14,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "edc74209-dc5d-44dd-a3e3-8fe6b1f41202",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 15,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "8c5d698a-c85f-4923-88ed-14b4d9bee8fa",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 16,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "2cc388e7-e2b9-43ae-a295-c07ca6177648",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 17,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "7ed5928a-f6af-42e8-9f19-b0a9e051f79f",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 18,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "5c6ff51a-7e89-4d2c-a029-d79feb1e02f5",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 19,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "08719fcc-81d7-414a-a1e4-8844e4be0ed2",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 20,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "b49b629e-4de4-4e90-aff4-b345db470650",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 21,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "519222c0-10be-4031-bea9-7b37724f5549",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 22,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "a05611c1-23a8-4679-bbc9-1864e0ca486f",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 23,
                    "startMinutes": 0,
                    "daysToBuild": 127,
                    "scheduleJobId": "bd998740-d941-4507-bc50-631596429320",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 0,
                    "startMinutes": 30,
                    "daysToBuild": 127,
                    "scheduleJobId": "1354b82a-b0eb-4d49-8e11-00c185d78ff9",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 1,
                    "startMinutes": 30,
                    "daysToBuild": 127,
                    "scheduleJobId": "c819917e-aec1-4e48-93d6-72deef0fcea6",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 2,
                    "startMinutes": 30,
                    "daysToBuild": 127,
                    "scheduleJobId": "ad6a6cbb-9378-4c71-af12-f7ee5af92f8c",
                    "scheduleOnlyWithChanges": false
                },
                {
                    "branchFilters": [
                        "+master"
                    ],
                    "timeZoneId": "Pacific Standard Time",
                    "startHours": 3,
                    "startMinutes": 30,
                    "daysToBuild": 127,
                    "scheduleJobId": "c0ceea0a-d010-4b4e-80f1-c88902538d58",
                    "scheduleOnlyWithChanges": false
                }
            ],
            "triggerType": 8
        }
    ],
    "variables": {
        "app.id": {
            "value": "244790b2-d023-403d-8814-b4ecfe847e55"
        },
        "app.id.admin": {
            "value": "05ff27fb-fcd2-4bae-97ee-4e60a67ff73b"
        },
        "app.secret": {
            "value": null,
            "isSecret": true
        },
        "app.secret.admin": {
            "value": null,
            "isSecret": true
        },
        "bicep.path": {
            "value": "<this will be set by a pipeline task>"
        },
        "bicep.supported": {
            "value": "<this will set by a pipeline task>"
        },
        "bicep.uri": {
            "value": "https://github.com/Azure/bicep/releases/latest/download/bicep-win-x64.exe"
        },
        "bicep.version": {
            "value": "<this will be set by a pipeline task>"
        },
        "config.file.uri": {
            "value": "https://azbotstorage.blob.core.windows.net/gen-artifacts-config/.config.json"
        },
        "environment": {
            "value": "AzureCloud"
        },
        "gen.artifacts.resourceGroup": {
            "value": "ttk-gen-artifacts"
        },
        "gen.parameters.filename": {
            "value": "gen.azuredeploy.parameters.json"
        },
        "gen.prereq.parameters.filename": {
            "value": "gen.prereq.parameters.json"
        },
        "github.enable.comments": {
            "value": "true"
        },
        "github.enable.labels": {
            "value": "true"
        },
        "location": {
            "value": "westus"
        },
        "mainTemplate.deployment.filename": {
            "value": "<this will be set by a pipeline task> (the actual JSON file being deployed - currently this is always the same as mainTemplate.filename.json)"
        },
        "mainTemplate.deployment.name": {
            "value": "mainTemplate-deployment"
        },
        "mainTemplate.filename": {
            "value": "main.bicep"
        },
        "mainTemplate.filename.json": {
            "value": "<this will be set by a pipeline task> (which JSON file is found, either azuredeploy.json or mainTemplate.json)"
        },
        "parameters.filename": {
            "value": "azuredeploy.parameters.json"
        },
        "prereq.deployment.name": {
            "value": "prereq-deployment"
        },
        "prereq.outputs.filename": {
            "value": "prereq.outputs.json"
        },
        "prereq.resourceGroup.name": {
            "value": "<this will set by a pipeline task>"
        },
        "prereq.template.filename.bicep": {
            "value": "prereq.main.bicep"
        },
        "prereq.template.filename.json": {
            "value": "prereq.azuredeploy.json"
        },
        "prereq.template.fullpath": {
            "value": "<this will be set by a pipeline task>"
        },
        "resourceGroup.name": {
            "value": "<this will set by a pipeline task>"
        },
        "result.best.practice": {
            "value": "FAIL"
        },
        "result.bicep.build": {
            "value": "FAIL"
        },
        "result.credscan": {
            "value": ""
        },
        "result.deployment": {
            "value": "FAIL"
        },
        "result.deployment.last.test.date.parameter": {
            "value": "PublicLastTestDate"
        },
        "result.deployment.parameter": {
            "value": "PublicDeployment"
        },
        "result.metadata": {
            "value": "FAIL"
        },
        "result.readme": {
            "value": "FAIL"
        },
        "sample.folder": {
            "value": "<this will set by a pipeline task>"
        },
        "skipComponentGovernanceDetection": {
            "value": "true"
        },
        "storage.account.key": {
            "value": null,
            "isSecret": true
        },
        "storage.account.name": {
            "value": "azurequickstartsservice"
        },
        "subscription.id": {
            "value": "0cec7090-2e08-4498-9337-eb96ade50821"
        },
        "system.debug": {
            "value": "false",
            "allowOverride": true
        },
        "tenant.id": {
            "value": "6457d1f2-4394-4fc2-b163-e46ffcbbec5c"
        },
        "ttk.asset.filename": {
            "value": "arm-template-toolkit.zip"
        },
        "ttk.folder": {
            "value": "$(Agent.BuildDirectory)\\test"
        },
        "ttk.skip.tests": {
            "value": "DeploymentParameters Should Have Value"
        },
        "ttk.uri": {
            "value": "https://azurequickstartsservice.blob.core.windows.net/ttk/staging/arm-template-toolkit.zip"
        },
        "validation.type": {
            "value": "Automated"
        },
        "wait.role.assignment.seconds": {
            "value": "120"
        },
        "az.module.uri": {
            "value": "https://azurequickstartsservice.blob.core.windows.net/ttk/AzModules/Az-AzTable.6.2.1.zip"
        }
    },
    "properties": {},
    "tags": [],
    "comment": "Port Brian's recent changes",
    "jobAuthorizationScope": 1,
    "jobTimeoutInMinutes": 360,
    "jobCancelTimeoutInMinutes": 15,
    "badgeEnabled": true,
    "process": {
        "phases": [
            {
                "steps": [
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "Download TTK and CI scripts",
                        "timeoutInMinutes": 0,
                        "condition": "succeeded()",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "$ttkUri = \"$(ttk.uri)\"\nwrite-host $ENV:BUILD_REPOSITORY_ID\nwrite-host $ENV:SYSTEM_PULLREQUEST_PULLREQUESTNUMBER\n\n# Look for use-staging-scripts label\n$labelUri = \"https://api.github.com/repos/$ENV:BUILD_REPOSITORY_ID/issues/$ENV:SYSTEM_PULLREQUEST_PULLREQUESTNUMBER/labels\"\nWrite-Host \"Looking for label at $labelUri\"\n$labelResult = curl -s $labelUri\nWrite-Host $labelResult\nif ($labelResult -like '*\"name\": \"use-staging-scripts\"*') {\n    Write-Host \"... Found\"\n    $ttkUri = \"https://azurequickstartsservice.blob.core.windows.net/ttk/staging/arm-template-toolkit.zip\"\n    Write-Host \"Using script location $ttkUri\"\n} else {\n    Write-Host \"... not found\"\n}\n\nNew-Item '$(ttk.folder)' -ItemType Directory\nWrite-Host \"ttkUri: $ttkUri\"\nInvoke-WebRequest -uri $ttkUri -OutFile \"$(ttk.folder)/$(ttk.asset.filename)\" -Verbose\nGet-ChildItem '$(ttk.folder)' -Recurse\n\nWrite-Host \"Expanding files...\"\nExpand-Archive -Path '$(ttk.folder)/*.zip' -DestinationPath '$(ttk.folder)' -Verbose\n\nWrite-Host \"Expanded files found:\"\nGet-ChildItem '$(ttk.folder)' -Recurse",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "Install Az Module from Storage",
                        "timeoutInMinutes": 0,
                        "condition": "succeeded()",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "$AzModuleUri = \"$(az.module.uri)\"\n\ngci env:\n\n $p = ($env:psmodulepath).split(';')[0]\n\nInvoke-WebRequest -uri \"$AzModuleUri\" -OutFile \"$env:TEMP/az.zip\" -Verbose\n\n#Get-ChildItem '$p' -Recurse\n\nWrite-Host \"Expanding files...\"\nExpand-Archive -Path \"$env:TEMP/az.zip\" -DestinationPath \"$p\" -Verbose\n\nWrite-Host \"Expanded files found:\"\n#Get-ChildItem \"$p\" -Recurse\n\nGet-Module Az -ListAvailable\n",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "Connect To Azure (Admin) To Create RGs",
                        "timeoutInMinutes": 0,
                        "condition": "succeeded()",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)/ci-scripts/ConnectTo-Azure.ps1",
                            "arguments": "-appId $(app.id.admin) -secret \"$(app.secret.admin)\" -tenantId $(tenant.id) -subscriptionId $(subscription.id) -Environment $(environment)",
                            "script": "",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "Get Oldest Sample Folder (If Scheduled)",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), or(eq(variables['Build.Reason'], 'Schedule'), eq(variables['Build.Reason'], 'Manual')))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)\\ci-scripts\\Get-OldestSampleFolder.ps1",
                            "arguments": "-StorageAccountKey \"$(storage.account.key)\"",
                            "script": "",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "Set Build Number (If Scheduled)",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), or(eq(variables['Build.Reason'], 'Schedule'), eq(variables['Build.Reason'], 'Manual')))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "$s = \"$(sample.name)\"\n$s = $s.Replace('\\', '#')\nWrite-Host \"Setting build #: $s\"\nWrite-Host \"##vso[build.updatebuildnumber]($s)\"\n",
                            "errorActionPreference": "continue",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "Get Sample Folder (If Pull Request)",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['Build.Reason'], 'PullRequest'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)\\ci-scripts\\Get-SampleFolder.ps1",
                            "arguments": "",
                            "script": "",
                            "errorActionPreference": "stop",
                            "failOnStderr": "true",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "Validate metadata.json",
                        "timeoutInMinutes": 0,
                        "condition": "succeeded()",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)\\ci-scripts\\Validate-Metadata.ps1",
                            "arguments": "",
                            "script": "",
                            "errorActionPreference": "continue",
                            "failOnStderr": "true",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": true,
                        "displayName": "DEBUG: Dump ENV",
                        "timeoutInMinutes": 0,
                        "condition": "succeededOrFailed()",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "gci \"env:\"\n",
                            "errorActionPreference": "continue",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "Misc Label Checks",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)\\ci-scripts\\Check-MiscLabels.ps1",
                            "arguments": "",
                            "script": "",
                            "errorActionPreference": "continue",
                            "failOnStderr": "true",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "PR label: PORTAL SAMPLE",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'), eq(variables['IsPortalSample'], 'true'))",
                        "task": {
                            "id": "79ae0514-ee91-4a19-ae69-030952b0b23e",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "action": "add",
                            "label": "PORTAL SAMPLE"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "PR label: ROOT",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'), eq(variables['IsRootSample'], 'true'))",
                        "task": {
                            "id": "79ae0514-ee91-4a19-ae69-030952b0b23e",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "action": "add",
                            "label": "ROOT"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "PR label: ROOT (remove)",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'), eq(variables['IsRootSample'], 'false'))",
                        "task": {
                            "id": "79ae0514-ee91-4a19-ae69-030952b0b23e",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "action": "remove",
                            "label": "ROOT"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "PR label: UPPERCASE",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'), eq(variables['SampleHasUpperCase'], 'true'))",
                        "task": {
                            "id": "79ae0514-ee91-4a19-ae69-030952b0b23e",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "action": "add",
                            "label": "UPPERCASE"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "PR label: UPPERCASE (remove)",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'), eq(variables['SampleHasUpperCase'], 'false'))",
                        "task": {
                            "id": "79ae0514-ee91-4a19-ae69-030952b0b23e",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "action": "remove",
                            "label": "UPPERCASE"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "PR label: manual validation required",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'), eq(variables['validation.type'], 'Manual'), ne(variables['Build.SourceBranch'], 'refs/heads/master'))",
                        "task": {
                            "id": "79ae0514-ee91-4a19-ae69-030952b0b23e",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "action": "add",
                            "label": "manual validation required"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "PR label: metadata violations",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'), eq(variables['result.metadata'], 'FAIL'), ne(variables['Build.SourceBranch'], 'refs/heads/master'))",
                        "task": {
                            "id": "79ae0514-ee91-4a19-ae69-030952b0b23e",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "action": "add",
                            "label": "metadata violations"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "PR label: metadata violations (remove)",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'), eq(variables['result.metadata'], 'PASS'), ne(variables['Build.SourceBranch'], 'refs/heads/master'))",
                        "task": {
                            "id": "79ae0514-ee91-4a19-ae69-030952b0b23e",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "action": "remove",
                            "label": "metadata violations"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": true,
                        "displayName": "DEBUG: Dump ENV",
                        "timeoutInMinutes": 0,
                        "condition": "succeededOrFailed()",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "gci \"env:\"\n",
                            "errorActionPreference": "continue",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "Check Language Support (Bicep/JSON)",
                        "timeoutInMinutes": 0,
                        "condition": "succeeded()",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)\\ci-scripts\\Check-LanguageSupport.ps1",
                            "arguments": "",
                            "script": "",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "Check Bicep Decompile",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'), eq(variables['bicep.supported'], 'true'), ne(variables['Build.SourceBranch'], 'refs/heads/master'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)\\ci-scripts\\Check-BicepDecompile.ps1",
                            "arguments": "",
                            "script": "",
                            "errorActionPreference": "continue",
                            "failOnStderr": "false",
                            "showWarnings": "true",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "PR label: bicep",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'), eq(variables['bicep.supported'], 'true'), ne(variables['Build.SourceBranch'], 'refs/heads/master'))",
                        "task": {
                            "id": "79ae0514-ee91-4a19-ae69-030952b0b23e",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "action": "add",
                            "label": "bicep"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "PR label: bicep decompile",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'), eq(variables['bicep.supported'], 'true'), eq(variables['bicep.decompile'], 'true'), ne(variables['Build.SourceBranch'], 'refs/heads/master'))",
                        "task": {
                            "id": "79ae0514-ee91-4a19-ae69-030952b0b23e",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "action": "add",
                            "label": "bicep-decompile"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "BICEP: Install bicep",
                        "timeoutInMinutes": 0,
                        "condition": "eq(variables['bicep.supported'], 'true')",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "$(ttk.folder)\\ci-scripts\\Install-Bicep.ps1\n",
                            "errorActionPreference": "continue",
                            "failOnStderr": "true",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "BICEP: Build and validate main.bicep",
                        "timeoutInMinutes": 0,
                        "condition": "succeeded()",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "# If Bicep, build and verify compiled JSON matches included JSON.\n$(ttk.folder)\\ci-scripts\\Validate-DeploymentFile.ps1",
                            "errorActionPreference": "continue",
                            "failOnStderr": "true",
                            "showWarnings": "true",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": true,
                        "displayName": "DEBUG: Dump ENV",
                        "timeoutInMinutes": 0,
                        "condition": "succeededOrFailed()",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "gci \"env:\"\n",
                            "errorActionPreference": "continue",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": true,
                        "displayName": "DEBUG: Dump deployment file",
                        "timeoutInMinutes": 0,
                        "condition": "succeededOrFailed()",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "cat \"$($ENV:SAMPLE_FOLDER)/$(mainTemplate.deployment.filename)\"",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "PR label: bicep errors",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'), eq(variables['bicep.supported'], 'true'), eq(variables['result.bicep.build'], 'FAIL'), ne(variables['Build.SourceBranch'], 'refs/heads/master'))",
                        "task": {
                            "id": "79ae0514-ee91-4a19-ae69-030952b0b23e",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "action": "add",
                            "label": "bicep errors"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "PR label: bicep errors (remove)",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'), eq(variables['bicep.supported'], 'true'), eq(variables['result.bicep.build'], 'PASS'), ne(variables['Build.SourceBranch'], 'refs/heads/master'))",
                        "task": {
                            "id": "79ae0514-ee91-4a19-ae69-030952b0b23e",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "action": "remove",
                            "label": "bicep errors"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "PR comment (doc owner)",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.comments'], 'true'), eq(variables['Build.Reason'], 'PullRequest'), ne(variables['docOwner.message'], ''))",
                        "task": {
                            "id": "deea6198-adf8-4b16-9939-7addf85708b2",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "repositoryName": "$(Build.Repository.Name)",
                            "id": "$(System.PullRequest.PullRequestNumber)",
                            "comment": "$(docOwner.message)"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "Is MOVE: PR?",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['build.reason'], 'PullRequest'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "$GitHubRepository = $ENV:BUILD_REPOSITORY_NAME\n$GitHubPRNumber = $ENV:SYSTEM_PULLREQUEST_PULLREQUESTNUMBER\n$HasDocOwner = $(($ENV:DOCOWNER_MESSAGE).Length -gt 0)\nWrite-Host \"##vso[task.setvariable variable=HasDocOwner]$HasDocOwner\"\n\n$PRUri = \"https://api.github.com/repos/$($GitHubRepository)/pulls/$($GitHubPRNumber)\"\n\n$response = Invoke-Restmethod \"$PRUri\"\n\nif($response.title -like \"*MOVE:*\" -and $HasDocOwner){\n    Write-Host \"##vso[task.setvariable variable=pingTom]YES\"\n}\n",
                            "errorActionPreference": "continue",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "Ping mumian",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.comments'], 'true'), eq(variables['pingTom'], 'YES'))",
                        "task": {
                            "id": "deea6198-adf8-4b16-9939-7addf85708b2",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "repositoryName": "$(Build.Repository.Name)",
                            "id": "$(System.PullRequest.PullRequestNumber)",
                            "comment": "@mumian - this appears to be a \"Move\" that will need a manual doc update"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "Ping TomFitz re: moving a sample used in docs copy",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.comments'], 'true'), eq(variables['pingTom'], 'YES'))",
                        "task": {
                            "id": "deea6198-adf8-4b16-9939-7addf85708b2",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "repositoryName": "$(Build.Repository.Name)",
                            "id": "$(System.PullRequest.PullRequestNumber)",
                            "comment": "@tfitzmac - this appears to be a \"Move\" that will need a manual doc update"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": true,
                        "displayName": "DEBUG: Dump ENV",
                        "timeoutInMinutes": 0,
                        "condition": "succeededOrFailed()",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "gci \"env:\"\n",
                            "errorActionPreference": "continue",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "Validate README.md",
                        "timeoutInMinutes": 0,
                        "condition": "succeeded()",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)\\ci-scripts\\Validate-ReadMe.ps1",
                            "arguments": "",
                            "script": "",
                            "errorActionPreference": "continue",
                            "failOnStderr": "true",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "PR label: readme violations",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'), eq(variables['result.readme'], 'FAIL'), ne(variables['Build.SourceBranch'], 'refs/heads/master'))",
                        "task": {
                            "id": "79ae0514-ee91-4a19-ae69-030952b0b23e",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "action": "add",
                            "label": "readme violations"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "PR label: readme violations (remove)",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'), eq(variables['result.readme'], 'PASS'), ne(variables['Build.SourceBranch'], 'refs/heads/master'))",
                        "task": {
                            "id": "79ae0514-ee91-4a19-ae69-030952b0b23e",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "action": "remove",
                            "label": "readme violations"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": true,
                        "displayName": "DEBUG: DIR sample folder",
                        "timeoutInMinutes": 0,
                        "condition": "succeededOrFailed()",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "dir $(sample.folder)",
                            "errorActionPreference": "continue",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "Run Best Practices Tests",
                        "timeoutInMinutes": 0,
                        "condition": "succeeded()",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "$(ttk.folder)\\ci-scripts\\Test-BestPractices.ps1",
                            "errorActionPreference": "continue",
                            "failOnStderr": "true",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": true,
                        "displayName": "DEBUG: Dump ENV",
                        "timeoutInMinutes": 0,
                        "condition": "succeededOrFailed()",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "gci \"env:\"\n",
                            "errorActionPreference": "continue",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "PR label: best practices violations",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'), eq(variables['result.best.practice'], 'FAIL'), ne(variables['Build.SourceBranch'], 'refs/heads/master'))",
                        "task": {
                            "id": "79ae0514-ee91-4a19-ae69-030952b0b23e",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "action": "add",
                            "label": "best practices violations"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "PR label: best practices violations (remove)",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['github.enable.labels'], 'true'), eq(variables['result.best.practice'], 'true'), ne(variables['Build.SourceBranch'], 'refs/heads/master'))",
                        "task": {
                            "id": "79ae0514-ee91-4a19-ae69-030952b0b23e",
                            "versionSpec": "0.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "gitHubConnection": "c381556b-c775-4706-9297-23e2d35b5ac6",
                            "action": "remove",
                            "label": "best practices violations"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "Check for Prereqs",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), ne(variables['result.deployment'], 'Not Supported'), ne(variables['validation.type'], 'Manual'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)\\ci-scripts\\Check-Prereqs.ps1",
                            "arguments": "",
                            "script": "",
                            "errorActionPreference": "continue",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "Generate RG Names",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), ne(variables['result.deployment'], 'Not Supported'), ne(variables['validation.type'], 'Manual'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)\\ci-scripts\\Gen-ResourceGroupNames.ps1",
                            "arguments": "-sampleFolder \"$(sample.folder)\"",
                            "script": "\n",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "Create ResourceGroup - Assign RBAC (mainTemplate RG)",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), ne(variables['result.deployment'], 'Not Supported'), ne(variables['validation.type'], 'Manual'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)/ci-scripts/Create-ResourceGroupAssignment.ps1",
                            "arguments": "-ResourceGroupName \"$(resourceGroup.name)\" -Location \"$(location)\" -appId $(app.id) ",
                            "script": "",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "Create ResourceGroup - Assign RBAC (prereqs RG) ",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['deploy.prereqs'], 'true'), ne(variables['prereq.resourceGroup.name'], variables['resourceGroup.name']),  ne(variables['result.deployment'], 'Not Supported'), ne(variables['validation.type'], 'Manual'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)/ci-scripts/Create-ResourceGroupAssignment.ps1",
                            "arguments": "-ResourceGroupName \"$(prereq.resourceGroup.name)\" -Location \"$(location)\" -appId $(app.id)",
                            "script": "",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "Sleep (wait for roleAssignment to replicate)",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), ne(variables['result.deployment'], 'Not Supported'), ne(variables['validation.type'], 'Manual'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "Write-Host \"Sleeping for $(wait.role.assignment.seconds) seconds...\"\nStart-Sleep $(wait.role.assignment.seconds)",
                            "errorActionPreference": "continue",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "false",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "Connect To Azure (non-Admin) To Deploy",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), ne(variables['result.deployment'], 'Not Supported'), ne(variables['validation.type'], 'Manual'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)/ci-scripts/ConnectTo-Azure.ps1",
                            "arguments": "-appId $(app.id) -secret \"$(app.secret)\" -tenantId $(tenant.id) -subscriptionId $(subscription.id) -Environment \"$(environment)\"",
                            "script": "",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "GEN Parameters (Prereqs)",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['deploy.prereqs'], 'true'), ne(variables['result.deployment'], 'Not Supported'), ne(variables['validation.type'], 'Manual'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)/ci-scripts/Gen-TemplateParameters.ps1",
                            "arguments": "-configUri \"$(config.file.uri)\" -TemplateParametersFile \"$(sample.folder)\\prereqs\\prereq.$(parameters.filename)\" -NewTemplateParametersFile \"$(sample.folder)\\prereqs\\$(gen.prereq.parameters.filename)\"",
                            "script": "",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "DEBUG: dump mainTemplate param file content (prereqs)",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), ne(variables['result.deployment'], 'Not Supported'), ne(variables['validation.type'], 'Manual'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "if(Test-Path -Path \"$(sample.folder)\\prereqs\\$(gen.prereq.parameters.filename)\"){\n\n  Write-Output (Get-Content \"$(sample.folder)\\prereqs\\$(gen.prereq.parameters.filename)\" -Raw)\n\n}\n",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "Deploy Prerequisites",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['deploy.prereqs'], 'true'), ne(variables['result.deployment'], 'Not Supported'), ne(variables['validation.type'], 'Manual'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)\\Deploy-AzTemplate.ps1",
                            "arguments": "-ArtifactStagingDirectory \"$(sample.folder)\\prereqs\" -Location \"$(Location)\" -ResourceGroupName \"$(prereq.resourceGroup.name)\" -TemplateParametersFile \"$(sample.folder)\\prereqs\\$(gen.prereq.parameters.filename)\" -DeploymentName \"$(prereq.deployment.name)\" -TemplateFile \"$(prereq.template.fullpath)\"",
                            "script": "",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "Dump Outputs To File (prereqs)",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['deploy.prereqs'], 'true'), ne(variables['result.deployment'], 'Not Supported'), ne(variables['validation.type'], 'Manual'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "$PreReqOutputs = (Get-AzResourceGroupDeployment -ResourceGroupName \"$(prereq.resourceGroup.name)\" -Name $(prereq.deployment.name)).Outputs | ConvertTo-Json -Depth 100\nWrite-Output \"$PreReqOutputs\"\n\n###Write-Output \"##vso[task.setvariable variable=prereq.config.json]$PreReqOutputs\"\n\n$PreReqOutputs | Out-File -FilePath \"$(sample.folder)\\prereqs\\$(prereq.outputs.filename)\"",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "DEBUG: Dump Prereqs Output File",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), eq(variables['deploy.prereqs'], 'true'),  ne(variables['result.deployment'], 'Not Supported'), ne(variables['validation.type'], 'Manual'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "Write-Output (Get-Content \"$(sample.folder)\\prereqs\\$(prereq.outputs.filename)\" -Raw)\n",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "GEN mainTemplate Params",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), ne(variables['result.deployment'], 'Not Supported'), ne(variables['validation.type'], 'Manual'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)/ci-scripts/Gen-TemplateParameters.ps1",
                            "arguments": "-configUri \"$(config.file.uri)\" -TemplateParametersFile \"$(sample.folder)\\$(parameters.filename)\" -NewTemplateParametersFile \"$(sample.folder)\\$(gen.parameters.filename)\" -prereqOutputsFileName \"$(sample.folder)\\prereqs\\$(prereq.outputs.filename)\"",
                            "script": "",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "DEBUG: dump mainTemplate param file content",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), ne(variables['result.deployment'], 'Not Supported'), ne(variables['validation.type'], 'Manual'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "Write-Output (Get-Content \"$(sample.folder)\\$(gen.parameters.filename)\" -Raw)",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "Deploy mainTemplate",
                        "timeoutInMinutes": 0,
                        "condition": "and(succeeded(), ne(variables['result.deployment'], 'Not Supported'), ne(variables['validation.type'], 'Manual'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "$(ttk.folder)\\Deploy-AzTemplate.ps1 `\n    -ArtifactStagingDirectory \"$(sample.folder)\" `\n    -TemplateFile \"$(sample.folder)\\$(mainTemplate.deployment.filename)\" `\n    -Location \"$(Location)\" `\n    -ResourceGroupName \"$(resourceGroup.name)\" `\n    -TemplateParametersFile \"$(sample.folder)\\$(gen.parameters.filename)\" `\n    -DeploymentName \"$(mainTemplate.deployment.name)\"\n\nWrite-Host \"##vso[task.setvariable variable=result.deployment]$true\"\n",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "Connect To Azure (Admin) To Clean Up",
                        "timeoutInMinutes": 0,
                        "condition": "and(ne(variables['result.deployment'], 'Not Supported'), ne(variables['validation.type'], 'Manual'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)/ci-scripts/ConnectTo-Azure.ps1",
                            "arguments": "-appId $(app.id.admin) -secret \"$(app.secret.admin)\" -tenantId $(tenant.id) -subscriptionId $(subscription.id) -Environment $(environment)",
                            "script": "",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": true,
                        "displayName": "DEBUG: Dump ENV",
                        "timeoutInMinutes": 0,
                        "condition": "succeededOrFailed()",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "gci \"env:\"\n",
                            "errorActionPreference": "continue",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": true,
                        "alwaysRun": false,
                        "displayName": "Write Test Result for README.MD",
                        "timeoutInMinutes": 0,
                        "condition": "always()",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "filePath",
                            "filePath": "$(ttk.folder)\\ci-scripts\\Write-TestResults.ps1",
                            "arguments": "-$(result.deployment.parameter) \"$(result.deployment)\" -StorageAccountKey \"$(storage.account.key)\"",
                            "script": "<#\n\nThis is a placeholder - for when we want to write the last test result to the readme file\n\n#>",
                            "errorActionPreference": "stop",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "Clean Up ResourceGroup (main)",
                        "timeoutInMinutes": 0,
                        "condition": "and(ne(variables['result.deployment'], 'Not Supported'), ne(variables['validation.type'], 'Manual'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "# remove the resource group\nWrite-Host \"First attempt...\"\n& $(ttk.folder)/ci-scripts/Kill-AzResourceGroup.ps1 -ResourceGroupName \"$(resourceGroup.name)\" -ErrorAction SilentlyContinue\n\n# if the resource group still exists after the first attempt, try again after a few minutes\nWrite-Host \"Checking for ResourceGroup\"\nif ((Get-AzResourceGroup -Name \"$(resourceGroup.name)\" -verbose -ErrorAction SilentlyContinue) -ne $null) {\n\n    Write-Host \"Found the resource group - sleeping...\" \n    Sleep 600\n    Write-Host \"Attempting Kill-AzResourceGroup\"\n    & $(ttk.folder)/ci-scripts/Kill-AzResourceGroup.ps1 -ResourceGroupName \"$(resourceGroup.name)\"\n\n}\n",
                            "errorActionPreference": "continue",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    },
                    {
                        "environment": {},
                        "enabled": true,
                        "continueOnError": false,
                        "alwaysRun": false,
                        "displayName": "Clean Up ResourceGroup (prereqs)",
                        "timeoutInMinutes": 0,
                        "condition": "and(eq(variables['deploy.prereqs'], 'true'), ne(variables['prereq.resourceGroup.name'], variables['resourceGroup.name']),  ne(variables['result.deployment'], 'Not Supported'), ne(variables['validation.type'], 'Manual'))",
                        "task": {
                            "id": "e213ff0f-5d5c-4791-802d-52ea3e7be1f1",
                            "versionSpec": "2.*",
                            "definitionType": "task"
                        },
                        "inputs": {
                            "targetType": "inline",
                            "filePath": "",
                            "arguments": "",
                            "script": "# remove the resource group\nWrite-Host \"First attempt...\"\n& $(ttk.folder)/ci-scripts/Kill-AzResourceGroup.ps1 -ResourceGroupName \"$(prereq.resourceGroup.name)\" -ErrorAction SilentlyContinue\n\n# if the resource group still exists after the first attempt, try again after a few minutes\nWrite-Host \"Checking for ResourceGroup\"\nif ((Get-AzResourceGroup -Name \"$(prereq.resourceGroup.name)\" -verbose -ErrorAction SilentlyContinue) -ne $null) {\n\n    Write-Host \"Found the resource group - sleeping...\" \n    Sleep 600\n    Write-Host \"Attempting Kill-AzResourceGroup\"\n    & $(ttk.folder)/ci-scripts/Kill-AzResourceGroup.ps1 -ResourceGroupName \"$(prereq.resourceGroup.name)\"\n}\n",
                            "errorActionPreference": "continue",
                            "failOnStderr": "false",
                            "showWarnings": "false",
                            "ignoreLASTEXITCODE": "false",
                            "pwsh": "true",
                            "workingDirectory": "",
                            "runScriptInSeparateScope": "false"
                        }
                    }
                ],
                "name": "Agent job 1",
                "refName": "Job_1",
                "condition": "succeeded()",
                "target": {
                    "executionOptions": {
                        "type": 0
                    },
                    "allowScriptsAuthAccessOption": false,
                    "type": 1
                },
                "jobAuthorizationScope": 1,
                "jobTimeoutInMinutes": 360
            }
        ],
        "type": 1
    },
    "repository": {
        "properties": {
            "apiUrl": "https://api.github.com/repos/Azure/azure-quickstart-templates",
            "branchesUrl": "https://api.github.com/repos/Azure/azure-quickstart-templates/branches",
            "cloneUrl": "https://github.com/Azure/azure-quickstart-templates.git",
            "connectedServiceId": "eae281a4-7f99-47d5-bbd4-2ec4d0d0f865",
            "defaultBranch": "master",
            "fullName": "Azure/azure-quickstart-templates",
            "hasAdminPermissions": "False",
            "isFork": "False",
            "isPrivate": "False",
            "lastUpdated": "07/21/2021 14:19:39",
            "manageUrl": "https://github.com/Azure/azure-quickstart-templates",
            "nodeId": "MDEwOlJlcG9zaXRvcnkzNDQwNzY1MQ==",
            "ownerId": "6844498",
            "orgName": "Azure",
            "refsUrl": "https://api.github.com/repos/Azure/azure-quickstart-templates/git/refs",
            "safeRepository": "Azure/azure-quickstart-templates",
            "shortName": "azure-quickstart-templates",
            "ownerAvatarUrl": "https://avatars.githubusercontent.com/u/6844498?v=4",
            "archived": "False",
            "externalId": "34407651",
            "ownerIsAUser": "False",
            "checkoutNestedSubmodules": "false",
            "cleanOptions": "0",
            "fetchDepth": "1",
            "gitLfsSupport": "false",
            "reportBuildStatus": "true",
            "skipSyncSource": "false",
            "labelSourcesFormat": "$(build.buildNumber)",
            "labelSources": "0"
        },
        "id": "Azure/azure-quickstart-templates",
        "type": "GitHub",
        "name": "Azure/azure-quickstart-templates",
        "url": "https://github.com/Azure/azure-quickstart-templates.git",
        "defaultBranch": "master",
        "clean": "false",
        "checkoutSubmodules": false
    },
    "processParameters": {},
    "quality": 1,
    "authoredBy": {
        "displayName": "Stephen Weatherford",
        "url": "https://spsprodcus1.vssps.visualstudio.com/Ac8aef736-af44-4df8-8ee0-e3f71ba093b7/_apis/Identities/5ccdb3f3-0839-677f-ba16-981fe10b5b67",
        "_links": {
            "avatar": {
                "href": "https://dev.azure.com/azurequickstarts/_apis/GraphProfile/MemberAvatars/aad.NWNjZGIzZjMtMDgzOS03NzdmLWJhMTYtOTgxZmUxMGI1YjY3"
            }
        },
        "id": "5ccdb3f3-0839-677f-ba16-981fe10b5b67",
        "uniqueName": "stephwe@microsoft.com",
        "imageUrl": "https://dev.azure.com/azurequickstarts/_apis/GraphProfile/MemberAvatars/aad.NWNjZGIzZjMtMDgzOS03NzdmLWJhMTYtOTgxZmUxMGI1YjY3",
        "descriptor": "aad.NWNjZGIzZjMtMDgzOS03NzdmLWJhMTYtOTgxZmUxMGI1YjY3"
    },
    "drafts": [],
    "id": 27,
    "name": "AzQuickStarts-New-Public-Staging",
    "url": "https://dev.azure.com/azurequickstarts/b191bd7a-37bb-47b0-870c-3f1270a79b3d/_apis/build/Definitions/27?revision=19",
    "uri": "vstfs:///Build/Definition/27",
    "path": "\\",
    "type": 2,
    "queueStatus": 0,
    "revision": 19,
    "createdDate": "2021-07-21T18:11:17.307Z",
    "project": {
        "id": "b191bd7a-37bb-47b0-870c-3f1270a79b3d",
        "name": "azure-quickstart-templates",
        "description": "Pipelines for the Azure/azure-quickstart-templates repo",
        "url": "https://dev.azure.com/azurequickstarts/_apis/projects/b191bd7a-37bb-47b0-870c-3f1270a79b3d",
        "state": 1,
        "revision": 21,
        "visibility": 2,
        "lastUpdateTime": "2019-07-08T21:54:49.103Z"
    }
}