{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "omsLogAnalyticsWorkspaceName": {
      "type": "string",
      "metadata": {
        "description": "The name of existing OMS Log Analytics workspace."
      }
    },
    "omsLogAnalyticsWorkspaceLocation": {
      "type": "string",
      "allowedValues": [
        "East US",
        "West Europe",
        "Southeast Asia",
        "Australia Southeast",
        "West Central US",
        "Japan East",
        "UK South"
      ],
      "metadata": {
        "description": "The region to of existing OMS Log Analytics workspace."
      },
      "defaultValue": "West Europe"
    }
  },
  "variables": {
    "solutionName": "S2D",
    "solutionId": "[concat(variables('solutionName'), ' [' , parameters('omsLogAnalyticsWorkspaceName'), ']')]",
    "solutionVersion": "1.0",
    "solutionPublisher": "cloudadministrator.net",
    "solutionProduct": "[replace(concat(variables('solutionPublisher'),variables('solutionName')),' ','')]",
    "solutionPromotionCode": "",
    "solutionDescription": "OMS Solution for monitoring Storage Spaces Direct (S2D).",
    "solutionAuthor": "stas@outlook.com"
  },
  "resources": [
    {
      "name": "[parameters('omsLogAnalyticsWorkspaceName')]",
      "type": "Microsoft.OperationalInsights/workspaces",
      "location": "[parameters('omsLogAnalyticsWorkspaceLocation')]",
      "apiVersion": "2017-03-15-preview",
      "resources": [
        {
          "name": "[variables('solutionId')]",
          "type": "views",
          "location": "[parameters('omsLogAnalyticsWorkspaceLocation')]",
          "id": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.OperationalInsights/workspaces/', parameters('omsLogAnalyticsWorkspaceName'),'/views/', variables('solutionId'))]",
          "apiVersion": "2015-11-01-preview",
          "dependson": [
            "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.OperationalInsights/workspaces/', parameters('omsLogAnalyticsWorkspaceName'))]"
          ],
          "properties": {
            "Id": "[variables('solutionid')]",
            "Name": "[variables('solutionid')]",
            "DisplayName": "[variables('solutionName')]",
            "Description": "[variables('solutionDescription')]",
            "Version": 2,
            "Author": "[variables('solutionAuthor')]",
            "Source": "Local",
            "Dashboard": [
              {
                "Id": "InformationBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "Title": "Management Solution",
                    "NewGroup": false,
                    "Color": "#dd5900"
                  },
                  "Header": {
                    "Image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGMAAABjCAYAAACPO76VAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4AwTBywz3mK4bwAAAAd0RVh0QXV0aG9yAKmuzEgAAAAMdEVYdERlc2NyaXB0aW9uABMJISMAAAAKdEVYdENvcHlyaWdodACsD8w6AAAADnRFWHRDcmVhdGlvbiB0aW1lADX3DwkAAAAJdEVYdFNvZnR3YXJlAF1w/zoAAAALdEVYdERpc2NsYWltZXIAt8C0jwAAAAh0RVh0V2FybmluZwDAG+aHAAAAB3RFWHRTb3VyY2UA9f+D6wAAAAh0RVh0Q29tbWVudAD2zJa/AAAABnRFWHRUaXRsZQCo7tInAAADtElEQVR4nO2dTWsTURSGn0nbJGrV1ta0Y2ttqws3/gF/g//ETfZuxZ2QH+RCXLgSRBTED3RhIaKCWj9Q/BgX56ajIFUht/M2vg9ckjLNndvzzJy5ZO6cFlVVYTRoNT0AU2MZQliGEJYhhGUIYRlCWIYQliGEZQhhGUJYhhCWIYRlCGEZQliGEJYhhGUIYRlCWIYQliGEZQgx3fQA1CnKQQtoA7NAD9iuhv2tHPuyDKAoB9NEwI8SAT8JrAIngI30fgFYBq4Agxzj+G9kFOWgTQT8GBHUeSLQm6n1UlsEDqff/R3ZYjZRMopyMAMcog74AhHoM0TgjwFleu0QAS8aGexv2HcyinLQAWaIsZ8FThEBXyUCfZIQMUcEfKaZkf47cjKKclAAXSJ/zwIrwDpwGlhK758At4GrwAFgqoGhjp1GZBTlYIpfZygrxBHeI47yDeLieZg4wrv8Og2/BjxKn58YsslIU8IuEcwlIn2sEEHeTK+LadsRxPJ3E+Q8M84RaWSNCPos+yh/N0FOGXPAeSKnm7/AX4cIYRlCWIYQliGEZQhhGUJYhhCWIYRlCGEZQliGEJYhhGUIYRlCWIYQliFEzptLX4G3wOcx9zsFfAA+pf73smBWi/H/PTvklPEQuMj4V260gOfAEHjF3soogDu5Os8pYxO4TCxKGGfApoEbwHXg0pj7/hMtYnnngxyd55TRJdY45bgHvkysq9rI0PefOJqrY1/AhbAMISxDCMsQwjKEsAwhLEMIyxDCMoSwDCEsQwjLEMIyhLAMISxDCMsQIqeMN8At4BnwHviWcV8TQc47fXeBC0T9jpJ4BLlHXTxlVKVmgaj38d8/lpxNRjXsfwe2U3sK3BxtSwVX2kRlm2Xqeh9rhKy19PMs8cB+J9c4lWikXEU17H8BvhBLbraIdAbslLI4SNxrniMKtGwQlXEW0usWsVTnEyFqIioryBVyqYb9b8C71LaAe6NtP5XA6BJjv09d5KVHnFGrwHHqmlH7psiLnIzdSKnvY2oAL0bbUjWeNpHWRkW8Suqz6hSRFpeIM66N2HVqX8nYjWrYr4jVfi9T2yGJ6hDLhkYTh0VqUevUhcHmiTS557GZGBm7kUSNrjGvgcc/b08l8zrUFdxG5ZbWiZnfceKM6pFxil74f7vuTpr5zRCpbRl4WQ37z7LsyzJ08NchQliGEJYhhGUIYRlCWIYQliGEZQhhGUJYhhCWIYRlCGEZQliGEJYhhGUIYRlCWIYQliGEZQhhGUL8AFsbdpeIEywFAAAAAElFTkSuQmCC",
                    "Label": "Storage Spaces Direct",
                    "Link": {
                      "Label": "More info",
                      "Url": "https://github.com/slavizh/s2d-oms-mgmt-solution"
                    }
                  },
                  "List": [
                    {
                      "Title": "Description",
                      "Content": "The purpose of this management solution is to provide monitoring for Storage Spaces Direct clusters. The solution relies on Failover Cluster Health Service API for data.\n\nRequirements:\n\n- [OMSIngestionAPI](https://www.powershellgallery.com/packages/OMSIngestionAPI/) PowerShell module installed on S2D nodes\n- [s2dmon service](https://github.com/slavizh/s2d-oms-mgmt-solution) installed on S2D nodes\n\nThis version will work only on Log Analytics V2 workspaces using the new search syntax.\n\n[Full documentation](https://github.com/slavizh/s2d-oms-mgmt-solution)\n\nAuthor: [Stanislav Zhelyazkov](https://cloudadministrator.wordpress.com/)"
                    }
                  ]
                }
              },
              {
                "Id": "TwoTrendsAndListBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Cluster Faults",
                    "newGroup": false,
                    "icon": "",
                    "useIcon": false
                  },
                  "Trend1": {
                    "Legend": "Major and Critical",
                    "LegendColor": "#ba141a",
                    "ChartQuery": "S2D_CL | where FaultLevel_s == 'Cluster' and SeverityNumber_d > 4 |  summarize arg_max(TimeGenerated, *) by ClusterName_s, FaultId_g, Reason_s",
                    "Calculation": {
                      "Operation": "Sum"
                    }
                  },
                  "Trend2": {
                    "Legend": "Minor and Warning",
                    "LegendColor": "#fcd116",
                    "ChartQuery": "S2D_CL | where FaultLevel_s == 'Cluster' | where SeverityNumber_d > 2 and SeverityNumber_d < 5 |  summarize arg_max(TimeGenerated, *) by ClusterName_s, FaultId_g, Reason_s",
                    "Calculation": {
                      "Operation": "Sum"
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where FaultLevel_s == 'Cluster' and SecondTimeStamp_t > ago(5m) |  summarize arg_max(TimeGenerated, *) by ClusterName_s, FaultId_g, Reason_s | summarize count() by Reason_s,Severity_s,ClusterName_s,FaultId_g | project-away FaultId_g",
                    "HideGraph": true,
                    "enableSparklines": false,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Reason",
                      "Value": "Count"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": false,
                      "values": [
                        {
                          "name": "Normal",
                          "threshold": "Default",
                          "color": "#009e49",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "60",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Error",
                          "threshold": "90",
                          "color": "#ba141a",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where FaultLevel_s == 'Cluster' and SecondTimeStamp_t > ago(10m) and {selected item} |  summarize arg_max(TimeGenerated, *) by ClusterName_s, FaultId_g, Reason_s | project ClusterName_s, FaultId_g, TimeGenerated, Severity_s, Reason_s, FaultingObjectDescription_s, FaultingObjectType_s, FaultingObjectLocation_s, FaultType_s, RecommendedActions_s"
                  }
                }
              },
              {
                "Id": "TwoTrendsAndListBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Volume Vaults",
                    "newGroup": false,
                    "icon": "",
                    "useIcon": false
                  },
                  "Trend1": {
                    "Legend": "Major and Critical",
                    "LegendColor": "#ba141a",
                    "ChartQuery": "S2D_CL | where FaultLevel_s == 'Volume' and SeverityNumber_d > 4 |  summarize arg_max(TimeGenerated, *) by ClusterName_s, FaultId_g, Reason_s",
                    "Calculation": {
                      "Operation": "Sum"
                    }
                  },
                  "Trend2": {
                    "Legend": "Minor and Warning",
                    "LegendColor": "#fcd116",
                    "ChartQuery": "S2D_CL | where FaultLevel_s == 'Volume' | where SeverityNumber_d > 2 and SeverityNumber_d < 5 |  summarize arg_max(TimeGenerated, *) by ClusterName_s, FaultId_g",
                    "Calculation": {
                      "Operation": "Sum"
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where FaultLevel_s == 'Volume' and SecondTimeStamp_t > ago(5m) |  summarize arg_max(TimeGenerated, *) by ClusterName_s, FaultId_g, Reason_s | summarize count() by Reason_s,Severity_s,ClusterName_s,FaultId_g | project-away FaultId_g",
                    "HideGraph": true,
                    "enableSparklines": false,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Reason",
                      "Value": "Count"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": false,
                      "values": [
                        {
                          "name": "Normal",
                          "threshold": "Default",
                          "color": "#009e49",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "60",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Error",
                          "threshold": "90",
                          "color": "#ba141a",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where FaultLevel_s == 'Volume' and SecondTimeStamp_t > ago(10m) and {selected item} |  summarize arg_max(TimeGenerated, *) by ClusterName_s, FaultId_g, Reason_s | project ClusterName_s, FaultId_g, TimeGenerated, Severity_s, Reason_s, FaultingObjectDescription_s, FaultingObjectType_s, FaultingObjectLocation_s, FaultType_s, RecommendedActions_s"
                  }
                }
              },
              {
                "Id": "TwoTrendsAndListBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Share Faults",
                    "newGroup": false,
                    "icon": "",
                    "useIcon": false
                  },
                  "Trend1": {
                    "Legend": "Major and Critical",
                    "LegendColor": "#ba141a",
                    "ChartQuery": "S2D_CL | where FaultLevel_s == 'Share' and SeverityNumber_d > 4 |  summarize arg_max(TimeGenerated, *) by ClusterName_s, FaultId_g, Reason_s",
                    "Calculation": {
                      "Operation": "Sum"
                    }
                  },
                  "Trend2": {
                    "Legend": "Minor and Warning",
                    "LegendColor": "#fcd116",
                    "ChartQuery": "S2D_CL | where FaultLevel_s == 'Share' | where SeverityNumber_d > 2 and SeverityNumber_d < 5 |  summarize arg_max(TimeGenerated, *) by ClusterName_s, FaultId_g",
                    "Calculation": {
                      "Operation": "Sum"
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where FaultLevel_s == 'Share' and SecondTimeStamp_t > ago(5m) |  summarize arg_max(TimeGenerated, *) by ClusterName_s, FaultId_g, Reason_s | summarize count() by Reason_s,Severity_s,ClusterName_s,FaultId_g | project-away FaultId_g",
                    "HideGraph": true,
                    "enableSparklines": false,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Reason",
                      "Value": "Count"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": false,
                      "values": [
                        {
                          "name": "Normal",
                          "threshold": "Default",
                          "color": "#009e49",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "60",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Error",
                          "threshold": "90",
                          "color": "#ba141a",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where FaultLevel_s == 'Share' and SecondTimeStamp_t > ago(10m) and {selected item} |  summarize arg_max(TimeGenerated, *) by ClusterName_s, FaultId_g, Reason_s | project ClusterName_s, FaultId_g, TimeGenerated, Severity_s, Reason_s, FaultingObjectDescription_s, FaultingObjectType_s, FaultingObjectLocation_s, FaultType_s, RecommendedActions_s"
                  }
                }
              },
              {
                "Id": "TwoNumberTileListBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Cluster Inventory",
                    "newGroup": true,
                    "icon": "",
                    "useIcon": false
                  },
                  "Tile": {
                    "Legend": "S2D Clusters",
                    "Query": "S2D_CL | where isnotempty(ServerName_s)  | summarize dcount(ServerName_s) by ClusterName_s | count"
                  },
                  "SecondTile": {
                    "Legend": "S2D Nodes",
                    "Query": "S2D_CL | where isnotempty(ServerName_s)  | summarize dcount(ServerName_s) by ServerName_s | count"
                  },
                  "List": {
                    "Query": "S2D_CL | where isnotempty(ServerName_s)  | summarize dcount(ServerName_s) by ClusterName_s",
                    "HideGraph": false,
                    "enableSparklines": false,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Cluster",
                      "Value": "S2D Nodes"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": false,
                      "values": [
                        {
                          "name": "Normal",
                          "threshold": "Default",
                          "color": "#009e49",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "60",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Error",
                          "threshold": "90",
                          "color": "#ba141a",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where isnotempty(ServerName_s) and {selected item}  | summarize dcount(ServerName_s) by ClusterName_s "
                  }
                }
              },
              {
                "Id": "LineChartBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Cluster Performance",
                    "newGroup": false,
                    "icon": "",
                    "useIcon": false
                  },
                  "Header": {
                    "Title": "CPU Usage",
                    "Subtitle": ""
                  },
                  "LineChart": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'CPUUsageAverage' | summarize avg(MetricValue_d) by ClusterName_s | render timechart",
                    "yAxis": {
                      "isLogarithmic": false,
                      "units": {
                        "baseUnitType": "Percentage",
                        "baseUnit": "ZeroToOne",
                        "displayUnit": "ZeroToOne"
                      },
                      "customLabel": "CPU"
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'CPUUsageAverage' | summarize avg(MetricValue_d) by ClusterName_s | render timechart",
                    "HideGraph": false,
                    "enableSparklines": true,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Cluster",
                      "Value": "CPU"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": true,
                      "values": [
                        {
                          "name": "Normal",
                          "threshold": "Default",
                          "color": "#009e49",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "60",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Error",
                          "threshold": "80",
                          "color": "#ba141a",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'CPUUsageAverage' and {selected item} | summarize avg(MetricValue_d) by ClusterName_s, bin_at(TimeGenerated, 1h, now() ) | render timechart"
                  }
                }
              },
              {
                "Id": "LineChartBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Cluster Performance",
                    "newGroup": false,
                    "icon": "",
                    "useIcon": false
                  },
                  "Header": {
                    "Title": "Memory Usage",
                    "Subtitle": ""
                  },
                  "LineChart": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'MemoryAvailable' | summarize round(avg(MetricValue_d/1073741824),2) by ClusterName_s | render timechart",
                    "yAxis": {
                      "isLogarithmic": false,
                      "units": {
                        "baseUnitType": "Bits",
                        "baseUnit": "Gigabytes",
                        "displayUnit": "Gigabytes"
                      },
                      "customLabel": "Available Memory"
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'MemoryAvailable' | summarize AVGMem = round(avg(MetricValue_d/1073741824),2) by ClusterName_s | sort by AVGMem asc  | render timechart",
                    "HideGraph": false,
                    "enableSparklines": false,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Cluster",
                      "Value": "Available Memory (GB)"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": true,
                      "values": [
                        {
                          "name": "Error",
                          "threshold": "Default",
                          "color": "#ba141a",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "2",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Normal",
                          "threshold": "5",
                          "color": "#009e49",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'MemoryAvailable' and {selected item} | summarize round(avg(MetricValue_d/1073741824),2) by ClusterName_s, bin_at(TimeGenerated, 1h, now() ) | render timechart"
                  }
                }
              },
              {
                "Id": "LineChartBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Cluster Performance",
                    "newGroup": false,
                    "icon": "",
                    "useIcon": false
                  },
                  "Header": {
                    "Title": "IO Latency",
                    "Subtitle": ""
                  },
                  "LineChart": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'IOLatencyAverage' | summarize avg(MetricValue_d*1000) by ClusterName_s | render timechart",
                    "yAxis": {
                      "isLogarithmic": false,
                      "units": {
                        "baseUnitType": "TimeRange",
                        "baseUnit": "Milliseconds",
                        "displayUnit": "Milliseconds"
                      },
                      "customLabel": "IO Latency"
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'IOLatencyAverage' | summarize avg(MetricValue_d*1000) by ClusterName_s | render timechart",
                    "HideGraph": false,
                    "enableSparklines": true,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Cluster",
                      "Value": "IO Latency (ms)"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": false,
                      "values": [
                        {
                          "name": "Normal",
                          "threshold": "Default",
                          "color": "#009e49",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "60",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Error",
                          "threshold": "90",
                          "color": "#ba141a",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'IOLatencyAverage' and {selected item} | summarize avg(MetricValue_d*1000) by ClusterName_s, bin_at(TimeGenerated, 1h, now() ) | render timechart"
                  }
                }
              },
              {
                "Id": "LineChartBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Cluster Performance",
                    "newGroup": false,
                    "icon": "",
                    "useIcon": false
                  },
                  "Header": {
                    "Title": "IO Read Latency",
                    "Subtitle": ""
                  },
                  "LineChart": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'IOLatencyRead' | summarize avg(MetricValue_d*1000) by ClusterName_s | render timechart",
                    "yAxis": {
                      "isLogarithmic": false,
                      "units": {
                        "baseUnitType": "TimeRange",
                        "baseUnit": "Milliseconds",
                        "displayUnit": "Milliseconds"
                      },
                      "customLabel": "IO Read Latency"
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'IOLatencyRead' | summarize avg(MetricValue_d*1000) by ClusterName_s | render timechart",
                    "HideGraph": false,
                    "enableSparklines": true,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Cluster",
                      "Value": "IO Read Latency (ms)"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": false,
                      "values": [
                        {
                          "name": "Normal",
                          "threshold": "Default",
                          "color": "#009e49",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "60",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Error",
                          "threshold": "90",
                          "color": "#ba141a",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'IOLatencyRead' and {selected item} | summarize avg(MetricValue_d*1000) by ClusterName_s, bin_at(TimeGenerated, 1h, now() ) | render timechart"
                  }
                }
              },
              {
                "Id": "LineChartBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Cluster Performance",
                    "newGroup": false,
                    "icon": "",
                    "useIcon": false
                  },
                  "Header": {
                    "Title": "IO Write Latency",
                    "Subtitle": ""
                  },
                  "LineChart": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'IOLatencyWrite' | summarize avg(MetricValue_d*1000) by ClusterName_s | render timechart",
                    "yAxis": {
                      "isLogarithmic": false,
                      "units": {
                        "baseUnitType": "TimeRange",
                        "baseUnit": "Milliseconds",
                        "displayUnit": "Milliseconds"
                      },
                      "customLabel": "IO Write Latency"
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'IOLatencyWrite' | summarize avg(MetricValue_d*1000) by ClusterName_s | render timechart",
                    "HideGraph": false,
                    "enableSparklines": true,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Cluster",
                      "Value": "IO Write Latency (ms)"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": false,
                      "values": [
                        {
                          "name": "Normal",
                          "threshold": "Default",
                          "color": "#009e49",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "60",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Error",
                          "threshold": "90",
                          "color": "#ba141a",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'IOLatencyWrite' and {selected item} | summarize avg(MetricValue_d*1000) by ClusterName_s, bin_at(TimeGenerated, 1h, now() ) | render timechart"
                  }
                }
              },
              {
                "Id": "LineChartCalloutStackedBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Cluster Performance",
                    "newGroup": false
                  },
                  "charts": [
                    {
                      "Header": {
                        "Title": "IOPS Total",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'IOPSTotal' | summarize avg(MetricValue_d) by ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": false,
                          "units": {
                            "baseUnitType": "Count",
                            "baseUnit": "Ones",
                            "displayUnit": "Ones"
                          },
                          "customLabel": "IOPS/sec"
                        }
                      }
                    },
                    {
                      "Header": {
                        "Title": "IOPS Read",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'IOPSRead' | summarize avg(MetricValue_d) by ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": false,
                          "units": {
                            "baseUnitType": "Count",
                            "baseUnit": "Ones",
                            "displayUnit": "Ones"
                          },
                          "customLabel": "IOPS/sec"
                        }
                      }
                    },
                    {
                      "Header": {
                        "Title": "IOPS Write",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'IOPSWrite' | summarize avg(MetricValue_d) by ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": false,
                          "units": {
                            "baseUnitType": "Count",
                            "baseUnit": "Ones",
                            "displayUnit": "Ones"
                          },
                          "customLabel": "IOPS/sec"
                        }
                      }
                    }
                  ]
                }
              },
              {
                "Id": "LineChartCalloutStackedBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Cluster Performance",
                    "newGroup": false
                  },
                  "charts": [
                    {
                      "Header": {
                        "Title": "IO Throughput Total",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'IOThroughputTotal' | summarize avg(MetricValue_d) by ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": true,
                          "units": {
                            "baseUnitType": "BitRate",
                            "baseUnit": "BytesPerSec",
                            "displayUnit": "AUTO"
                          },
                          "customLabel": "IO Throughput"
                        }
                      }
                    },
                    {
                      "Header": {
                        "Title": "IO Throughput Read",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'IOThroughputRead' | summarize avg(MetricValue_d) by ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": true,
                          "units": {
                            "baseUnitType": "BitRate",
                            "baseUnit": "BytesPerSec",
                            "displayUnit": "AUTO"
                          },
                          "customLabel": "IO Throughput"
                        }
                      }
                    },
                    {
                      "Header": {
                        "Title": "IO Throughput Write",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'IOThroughputWrite' | summarize avg(MetricValue_d) by ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": true,
                          "units": {
                            "baseUnitType": "BitRate",
                            "baseUnit": "BytesPerSec",
                            "displayUnit": "AUTO"
                          },
                          "customLabel": "IO Throughput"
                        }
                      }
                    }
                  ]
                }
              },
              {
                "Id": "LineChartCalloutStackedBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Cluster Performance",
                    "newGroup": false
                  },
                  "charts": [
                    {
                      "Header": {
                        "Title": "Pool Capacity Available ",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'CapacityPhysicalPooledAvailable' | summarize avg(MetricValue_d) by ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": true,
                          "units": {
                            "baseUnitType": "Bits",
                            "baseUnit": "Bytes",
                            "displayUnit": "AUTO"
                          },
                          "customLabel": "Available"
                        }
                      }
                    },
                    {
                      "Header": {
                        "Title": "Volume Capacity Total ",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'CapacityVolumesTotal' | summarize avg(MetricValue_d) by ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": true,
                          "units": {
                            "baseUnitType": "Bits",
                            "baseUnit": "Bytes",
                            "displayUnit": "AUTO"
                          },
                          "customLabel": "Available"
                        }
                      }
                    },
                    {
                      "Header": {
                        "Title": "Volume Capacity Available ",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'CapacityVolumesAvailable' | summarize avg(MetricValue_d) by ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": true,
                          "units": {
                            "baseUnitType": "Bits",
                            "baseUnit": "Bytes",
                            "displayUnit": "AUTO"
                          },
                          "customLabel": "Available"
                        }
                      }
                    }
                  ]
                }
              },
              {
                "Id": "LineChartBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Node Performance",
                    "newGroup": true,
                    "icon": "",
                    "useIcon": false
                  },
                  "Header": {
                    "Title": "CPU Usage",
                    "Subtitle": ""
                  },
                  "LineChart": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'CPUUsage' | summarize avg(MetricValue_d) by ServerName_s, ClusterName_s | render timechart",
                    "yAxis": {
                      "isLogarithmic": false,
                      "units": {
                        "baseUnitType": "Percentage",
                        "baseUnit": "ZeroToOne",
                        "displayUnit": "ZeroToOne"
                      },
                      "customLabel": "CPU"
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'CPUUsage' | summarize avg(MetricValue_d) by ServerName_s, ClusterName_s | render timechart",
                    "HideGraph": false,
                    "enableSparklines": true,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Node",
                      "Value": "CPU"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": true,
                      "values": [
                        {
                          "name": "Normal",
                          "threshold": "Default",
                          "color": "#009e49",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "60",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Error",
                          "threshold": "80",
                          "color": "#ba141a",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'CPUUsage' and {selected item} | summarize avg(MetricValue_d) by ServerName_s, ClusterName_s, bin_at(TimeGenerated, 1h, now() ) | render timechart"
                  }
                }
              },
              {
                "Id": "LineChartBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Node Performance",
                    "newGroup": false,
                    "icon": "",
                    "useIcon": false
                  },
                  "Header": {
                    "Title": "Memory Usage",
                    "Subtitle": ""
                  },
                  "LineChart": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'MemoryAvailable' | summarize round(avg(MetricValue_d/1073741824),2) by ServerName_s, ClusterName_s | render timechart",
                    "yAxis": {
                      "isLogarithmic": false,
                      "units": {
                        "baseUnitType": "Bits",
                        "baseUnit": "Gigabytes",
                        "displayUnit": "Gigabytes"
                      },
                      "customLabel": "Available Memory"
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'MemoryAvailable' | summarize AVGMem = round(avg(MetricValue_d/1073741824),2) by ServerName_s, ClusterName_s | sort  by AVGMem asc | render timechart",
                    "HideGraph": false,
                    "enableSparklines": false,
                    "ColumnsTitle": {
                      "Name": "Node",
                      "Value": "Available Memory (GB)"
                    },
                    "Color": "#0072c6",
                    "operation": "Last Sample",
                    "thresholds": {
                      "isEnabled": true,
                      "values": [
                        {
                          "name": "Error",
                          "threshold": "Default",
                          "color": "#ba141a",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "1",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Normal",
                          "threshold": "1.5",
                          "color": "#009e49",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'MemoryAvailable' and {selected item} | summarize round(avg(MetricValue_d/1073741824),2) by ServerName_s, ClusterName_s, bin_at(TimeGenerated, 1h, now() ) | render timechart"
                  }
                }
              },
              {
                "Id": "LineChartBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Node Performance",
                    "newGroup": false,
                    "icon": "",
                    "useIcon": false
                  },
                  "Header": {
                    "Title": "IO Latency",
                    "Subtitle": ""
                  },
                  "LineChart": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'IOLatencyAverage' | summarize avg(MetricValue_d*1000) by ServerName_s, ClusterName_s | render timechart",
                    "yAxis": {
                      "isLogarithmic": false,
                      "units": {
                        "baseUnitType": "TimeRange",
                        "baseUnit": "Milliseconds",
                        "displayUnit": "Milliseconds"
                      },
                      "customLabel": "IO Latency"
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'IOLatencyAverage' | summarize avg(MetricValue_d*1000) by ServerName_s, ClusterName_s | render timechart",
                    "HideGraph": false,
                    "enableSparklines": true,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Node",
                      "Value": "IO Latency (ms)"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": false,
                      "values": [
                        {
                          "name": "Normal",
                          "threshold": "Default",
                          "color": "#009e49",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "60",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Error",
                          "threshold": "90",
                          "color": "#ba141a",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'IOLatencyAverage' and {selected item} | summarize avg(MetricValue_d*1000) by ServerName_s, ClusterName_s, bin_at(TimeGenerated, 1h, now() ) | render timechart"
                  }
                }
              },
              {
                "Id": "LineChartBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Node Performance",
                    "newGroup": false,
                    "icon": "",
                    "useIcon": false
                  },
                  "Header": {
                    "Title": "IO Read Latency",
                    "Subtitle": ""
                  },
                  "LineChart": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'IOLatencyRead' | summarize avg(MetricValue_d*1000) by ServerName_s, ClusterName_s | render timechart",
                    "yAxis": {
                      "isLogarithmic": false,
                      "units": {
                        "baseUnitType": "TimeRange",
                        "baseUnit": "Milliseconds",
                        "displayUnit": "Milliseconds"
                      },
                      "customLabel": "IO Read Latency"
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'IOLatencyRead' | summarize avg(MetricValue_d*1000) by ServerName_s, ClusterName_s | render timechart",
                    "HideGraph": false,
                    "enableSparklines": true,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Node",
                      "Value": "IO Read Latency (ms)"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": false,
                      "values": [
                        {
                          "name": "Normal",
                          "threshold": "Default",
                          "color": "#009e49",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "60",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Error",
                          "threshold": "90",
                          "color": "#ba141a",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'IOLatencyRead' and {selected item} | summarize avg(MetricValue_d*1000) by ServerName_s, ClusterName_s, bin_at(TimeGenerated, 1h, now() ) | render timechart"
                  }
                }
              },
              {
                "Id": "LineChartBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Node Performance",
                    "newGroup": false,
                    "icon": "",
                    "useIcon": false
                  },
                  "Header": {
                    "Title": "IO Write Latency",
                    "Subtitle": ""
                  },
                  "LineChart": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'IOLatencyWrite' | summarize avg(MetricValue_d*1000) by ServerName_s, ClusterName_s | render timechart",
                    "yAxis": {
                      "isLogarithmic": false,
                      "units": {
                        "baseUnitType": "TimeRange",
                        "baseUnit": "Milliseconds",
                        "displayUnit": "Milliseconds"
                      },
                      "customLabel": "IO Write Latency"
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'IOLatencyWrite' | summarize avg(MetricValue_d*1000) by ServerName_s, ClusterName_s | render timechart",
                    "HideGraph": false,
                    "enableSparklines": true,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Node",
                      "Value": "IO Write Latency (ms)"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": false,
                      "values": [
                        {
                          "name": "Normal",
                          "threshold": "Default",
                          "color": "#009e49",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "60",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Error",
                          "threshold": "90",
                          "color": "#ba141a",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'IOLatencyWrite' and {selected item} | summarize avg(MetricValue_d*1000) by ServerName_s, ClusterName_s, bin_at(TimeGenerated, 1h, now() ) | render timechart"
                  }
                }
              },
              {
                "Id": "LineChartCalloutStackedBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Node Performance",
                    "newGroup": false
                  },
                  "charts": [
                    {
                      "Header": {
                        "Title": "IOPS Total",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'IOPSTotal' | summarize avg(MetricValue_d) by ServerName_s, ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": false,
                          "units": {
                            "baseUnitType": "Count",
                            "baseUnit": "Ones",
                            "displayUnit": "Ones"
                          },
                          "customLabel": "IOPS/sec"
                        }
                      }
                    },
                    {
                      "Header": {
                        "Title": "IOPS Read",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'IOPSRead' | summarize avg(MetricValue_d) by ServerName_s, ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": false,
                          "units": {
                            "baseUnitType": "Count",
                            "baseUnit": "Ones",
                            "displayUnit": "Ones"
                          },
                          "customLabel": "IOPS/sec"
                        }
                      }
                    },
                    {
                      "Header": {
                        "Title": "IOPS Write",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'IOPSWrite' | summarize avg(MetricValue_d) by ServerName_s, ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": false,
                          "units": {
                            "baseUnitType": "Count",
                            "baseUnit": "Ones",
                            "displayUnit": "Ones"
                          },
                          "customLabel": "IOPS/sec"
                        }
                      }
                    }
                  ]
                }
              },
              {
                "Id": "LineChartCalloutStackedBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Node Performance",
                    "newGroup": false
                  },
                  "charts": [
                    {
                      "Header": {
                        "Title": "IO Throughput Total",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'IOThroughputTotal' | summarize avg(MetricValue_d) by ServerName_s, ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": true,
                          "units": {
                            "baseUnitType": "BitRate",
                            "baseUnit": "BytesPerSec",
                            "displayUnit": "AUTO"
                          },
                          "customLabel": "IO Throughput"
                        }
                      }
                    },
                    {
                      "Header": {
                        "Title": "IO Throughput Read",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'IOThroughputRead' | summarize avg(MetricValue_d) by ServerName_s, ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": true,
                          "units": {
                            "baseUnitType": "BitRate",
                            "baseUnit": "BytesPerSec",
                            "displayUnit": "AUTO"
                          },
                          "customLabel": "IO Throughput"
                        }
                      }
                    },
                    {
                      "Header": {
                        "Title": "IO Throughput Write",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Node' and MetricName_s == 'IOThroughputWrite' | summarize avg(MetricValue_d) by ServerName_s, ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": true,
                          "units": {
                            "baseUnitType": "BitRate",
                            "baseUnit": "BytesPerSec",
                            "displayUnit": "AUTO"
                          },
                          "customLabel": "IO Throughput"
                        }
                      }
                    }
                  ]
                }
              },
              {
                "Id": "LineChartBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Volume Performance",
                    "newGroup": true,
                    "icon": "",
                    "useIcon": false
                  },
                  "Header": {
                    "Title": "IO Latency",
                    "Subtitle": ""
                  },
                  "LineChart": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'IOLatencyAverage' | summarize avg(MetricValue_d*1000) by VolumeLabel_s, ClusterName_s | render timechart",
                    "yAxis": {
                      "isLogarithmic": false,
                      "units": {
                        "baseUnitType": "TimeRange",
                        "baseUnit": "Milliseconds",
                        "displayUnit": "Milliseconds"
                      },
                      "customLabel": "IO Latency"
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'IOLatencyAverage' | summarize avg(MetricValue_d*1000) by VolumeLabel_s, ClusterName_s | render timechart",
                    "HideGraph": false,
                    "enableSparklines": true,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Volume",
                      "Value": "IO Latency (ms)"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": false,
                      "values": [
                        {
                          "name": "Normal",
                          "threshold": "Default",
                          "color": "#009e49",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "60",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Error",
                          "threshold": "90",
                          "color": "#ba141a",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'IOLatencyAverage' and {selected item} | summarize avg(MetricValue_d*1000) by VolumeLabel_s, ClusterName_s, bin_at(TimeGenerated, 1h, now() ) | render timechart"
                  }
                }
              },
              {
                "Id": "LineChartBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Volume Performance",
                    "newGroup": false,
                    "icon": "",
                    "useIcon": false
                  },
                  "Header": {
                    "Title": "IO Read Latency",
                    "Subtitle": ""
                  },
                  "LineChart": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'IOLatencyRead' | summarize avg(MetricValue_d*1000) by VolumeLabel_s, ClusterName_s | render timechart",
                    "yAxis": {
                      "isLogarithmic": false,
                      "units": {
                        "baseUnitType": "TimeRange",
                        "baseUnit": "Milliseconds",
                        "displayUnit": "Milliseconds"
                      },
                      "customLabel": "IO Read Latency"
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'IOLatencyRead' | summarize avg(MetricValue_d*1000) by VolumeLabel_s, ClusterName_s | render timechart",
                    "HideGraph": false,
                    "enableSparklines": true,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Volume",
                      "Value": "IO Read Latency (ms)"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": false,
                      "values": [
                        {
                          "name": "Normal",
                          "threshold": "Default",
                          "color": "#009e49",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "60",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Error",
                          "threshold": "90",
                          "color": "#ba141a",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'IOLatencyRead' and {selected item} | summarize avg(MetricValue_d*1000) by VolumeLabel_s, ClusterName_s, bin_at(TimeGenerated, 1h, now() ) | render timechart"
                  }
                }
              },
              {
                "Id": "LineChartBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Volume Performance",
                    "newGroup": false,
                    "icon": "",
                    "useIcon": false
                  },
                  "Header": {
                    "Title": "IO Write Latency",
                    "Subtitle": ""
                  },
                  "LineChart": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'IOLatencyWrite' | summarize avg(MetricValue_d*1000) by VolumeLabel_s, ClusterName_s | render timechart",
                    "yAxis": {
                      "isLogarithmic": false,
                      "units": {
                        "baseUnitType": "TimeRange",
                        "baseUnit": "Milliseconds",
                        "displayUnit": "Milliseconds"
                      },
                      "customLabel": "IO Write Latency"
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'IOLatencyWrite' | summarize avg(MetricValue_d*1000) by VolumeLabel_s, ClusterName_s | render timechart",
                    "HideGraph": false,
                    "enableSparklines": true,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Volume",
                      "Value": "IO Write Latency (ms)"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": false,
                      "values": [
                        {
                          "name": "Normal",
                          "threshold": "Default",
                          "color": "#009e49",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "60",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Error",
                          "threshold": "90",
                          "color": "#ba141a",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'IOLatencyWrite' and {selected item} | summarize avg(MetricValue_d*1000) by VolumeLabel_s, ClusterName_s, bin_at(TimeGenerated, 1h, now() ) | render timechart"
                  }
                }
              },
              {
                "Id": "LineChartCalloutStackedBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Volume Performance",
                    "newGroup": false
                  },
                  "charts": [
                    {
                      "Header": {
                        "Title": "IOPS Total",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'IOPSTotal' | summarize avg(MetricValue_d) by VolumeLabel_s, ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": false,
                          "units": {
                            "baseUnitType": "Count",
                            "baseUnit": "Ones",
                            "displayUnit": "Ones"
                          },
                          "customLabel": "IOPS/sec"
                        }
                      }
                    },
                    {
                      "Header": {
                        "Title": "IOPS Read",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'IOPSRead' | summarize avg(MetricValue_d) by VolumeLabel_s, ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": false,
                          "units": {
                            "baseUnitType": "Count",
                            "baseUnit": "Ones",
                            "displayUnit": "Ones"
                          },
                          "customLabel": "IOPS/sec"
                        }
                      }
                    },
                    {
                      "Header": {
                        "Title": "IOPS Write",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'IOPSWrite' | summarize avg(MetricValue_d) by VolumeLabel_s, ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": false,
                          "units": {
                            "baseUnitType": "Count",
                            "baseUnit": "Ones",
                            "displayUnit": "Ones"
                          },
                          "customLabel": "IOPS/sec"
                        }
                      }
                    }
                  ]
                }
              },
              {
                "Id": "LineChartCalloutStackedBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Volume Performance",
                    "newGroup": false
                  },
                  "charts": [
                    {
                      "Header": {
                        "Title": "IO Throughput Total",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'IOThroughputTotal' | summarize avg(MetricValue_d) by VolumeLabel_s, ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": true,
                          "units": {
                            "baseUnitType": "BitRate",
                            "baseUnit": "BytesPerSec",
                            "displayUnit": "AUTO"
                          },
                          "customLabel": "IO Throughput"
                        }
                      }
                    },
                    {
                      "Header": {
                        "Title": "IO Throughput Read",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'IOThroughputRead' | summarize avg(MetricValue_d) by VolumeLabel_s, ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": true,
                          "units": {
                            "baseUnitType": "BitRate",
                            "baseUnit": "BytesPerSec",
                            "displayUnit": "AUTO"
                          },
                          "customLabel": "IO Throughput"
                        }
                      }
                    },
                    {
                      "Header": {
                        "Title": "IO Throughput Write",
                        "Subtitle": ""
                      },
                      "LineChart": {
                        "Query": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'IOThroughputWrite' | summarize avg(MetricValue_d) by VolumeLabel_s, ClusterName_s | render timechart",
                        "yAxis": {
                          "isLogarithmic": true,
                          "units": {
                            "baseUnitType": "BitRate",
                            "baseUnit": "BytesPerSec",
                            "displayUnit": "AUTO"
                          },
                          "customLabel": "IO Throughput"
                        }
                      }
                    }
                  ]
                }
              },
              {
                "Id": "SingleQueryDonutBuilderBladeV1",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Volume Performance",
                    "newGroup": false,
                    "icon": "",
                    "useIcon": false
                  },
                  "Header": {
                    "Title": "Volume Size",
                    "Subtitle": ""
                  },
                  "Donut": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'CapacityTotal' | summarize arg_max(TimeGenerated, *) by VolumeLabel_s, ClusterName_s | summarize round(avg(MetricValue_d/1073741824),2) by VolumeLabel_s, ClusterName_s | project-away ClusterName_s",
                    "CenterLegend": {
                      "Text": "Total (GBs)",
                      "Operation": "Sum",
                      "ArcsToSelect": []
                    },
                    "Options": {
                      "colors": [
                        "#00188f",
                        "#0072c6",
                        "#00bcf2"
                      ],
                      "valueColorMapping": []
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'CapacityTotal' | summarize round(avg(MetricValue_d/1073741824),2) by VolumeLabel_s, ClusterName_s | project-away ClusterName_s | render timechart",
                    "HideGraph": false,
                    "enableSparklines": true,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Volume",
                      "Value": "Size (GBs)"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": false,
                      "values": [
                        {
                          "name": "Normal",
                          "threshold": "Default",
                          "color": "#009e49",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "60",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Error",
                          "threshold": "90",
                          "color": "#ba141a",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'CapacityTotal' and {selected item} | summarize round(avg(MetricValue_d/1073741824),2) by VolumeLabel_s, ClusterName_s, bin_at(TimeGenerated, 1h, now())  | project-away ClusterName_s | render timechart"
                  }
                }
              },
              {
                "Id": "LineChartBuilderBlade",
                "Type": "Blade",
                "Version": 0,
                "Configuration": {
                  "General": {
                    "title": "Volume Performance",
                    "newGroup": false,
                    "icon": "",
                    "useIcon": false
                  },
                  "Header": {
                    "Title": "Volume Available Space",
                    "Subtitle": ""
                  },
                  "LineChart": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'CapacityAvailable' | summarize round(avg(MetricValue_d/1073741824),2) by VolumeLabel_s, ClusterName_s | project-away ClusterName_s | render timechart",
                    "yAxis": {
                      "isLogarithmic": false,
                      "units": {
                        "baseUnitType": "Bits",
                        "baseUnit": "Gigabytes",
                        "displayUnit": "Gigabytes"
                      },
                      "customLabel": "Available Space"
                    }
                  },
                  "List": {
                    "Query": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'CapacityAvailable' | summarize arg_max(TimeGenerated, *) by VolumeLabel_s, ClusterName_s  | summarize CapacityAvailable = round(avg(MetricValue_d/1073741824),2) by VolumeLabel_s, ClusterName_s | project-away ClusterName_s | sort by CapacityAvailable asc",
                    "HideGraph": false,
                    "enableSparklines": false,
                    "operation": "Last Sample",
                    "ColumnsTitle": {
                      "Name": "Volume",
                      "Value": "Available (GBs)"
                    },
                    "Color": "#0072c6",
                    "thresholds": {
                      "isEnabled": false,
                      "values": [
                        {
                          "name": "Normal",
                          "threshold": "Default",
                          "color": "#009e49",
                          "isDefault": true
                        },
                        {
                          "name": "Warning",
                          "threshold": "60",
                          "color": "#fcd116",
                          "isDefault": false
                        },
                        {
                          "name": "Error",
                          "threshold": "90",
                          "color": "#ba141a",
                          "isDefault": false
                        }
                      ]
                    },
                    "NameDSVSeparator": "",
                    "NavigationQuery": "S2D_CL | where MetricLevel_s == 'Volume' and MetricName_s == 'CapacityAvailable' and  {selected item} | summarize round(avg(MetricValue_d/1073741824),2) by VolumeLabel_s, ClusterName_s, bin_at(TimeGenerated, 1h, now() )  | project-away ClusterName_s | render timechart"
                  }
                }
              }
            ],
            "OverviewTile": {
              "Id": "LineChartBuilderTile",
              "Type": "OverviewTile",
              "Version": 2,
              "Configuration": {
                "LineChart": {
                  "Query": "S2D_CL | where MetricLevel_s == 'Cluster' and MetricName_s == 'IOPSTotal' | summarize avg(MetricValue_d) by ClusterName_s",
                  "yAxis": {
                    "isLogarithmic": false,
                    "units": {
                      "baseUnitType": "Count",
                      "baseUnit": "Ones",
                      "displayUnit": "Ones"
                    },
                    "customLabel": "IOPS/sec"
                  }
                },
                "Advanced": {
                  "DataFlowVerification": {
                    "Enabled": true,
                    "Query": "S2D_CL | sort by TimeGenerated desc | limit 1",
                    "Message": "S2D Monitoring data is missing in OMS. Please make sure you have installed s2dmon service on S2D nodes and that data is flowing to OMS."
                  }
                }
              }
            }
          }
        }
      ]
    },
    {
      "name": "[variables('solutionId')]",
      "type": "Microsoft.OperationsManagement/solutions",
      "location": "[parameters('omsLogAnalyticsWorkspaceLocation')]",
      "apiVersion": "2015-11-01-preview",
      "tags": {},
      "dependsOn": [
        "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.OperationalInsights/workspaces/', parameters('omsLogAnalyticsWorkspaceName'))]",
        "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.OperationalInsights/workspaces/', parameters('omsLogAnalyticsWorkspaceName'), '/views/', variables('solutionId'))]"
      ],
      "plan": {
        "name": "[variables('solutionId')]",
        "Version": "[variables('solutionVersion')]",
        "publisher": "[variables('solutionPublisher')]",
        "promotionCode": "[variables('solutionPromotionCode')]",
        "product": "[variables('solutionProduct')]"
      },
      "properties": {
        "workspaceResourceId": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.OperationalInsights/workspaces/', parameters('omsLogAnalyticsWorkspaceName'))]",
        "referencedResources": [
        ],
        "containedResources": [
          "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.OperationalInsights/workspaces/', parameters('omsLogAnalyticsWorkspaceName'), '/views/', variables('solutionId'))]"

        ]
      }
    }
  ],
  "outputs": {
  }
}
